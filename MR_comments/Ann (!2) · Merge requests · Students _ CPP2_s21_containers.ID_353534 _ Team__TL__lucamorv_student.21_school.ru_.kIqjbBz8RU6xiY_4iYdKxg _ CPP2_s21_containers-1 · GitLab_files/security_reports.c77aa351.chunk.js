(this.webpackJsonp=this.webpackJsonp||[]).push([[12],{"+w6P":function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"vulnerabilitySeveritiesCount"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},defaultValue:{kind:"StringValue",value:"",block:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"severity"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitySeverity"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportType"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityReportType"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scanner"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"state"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityState"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scannerId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitiesScannerID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clusterAgentId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClustersAgentID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"image"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isGroup"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isProject"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isInstance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"instance"},name:{kind:"Name",value:"instanceSecurityDashboard"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isInstance"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitySeveritiesCount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"projectId"},value:{kind:"Variable",name:{kind:"Name",value:"projectId"}}},{kind:"Argument",name:{kind:"Name",value:"severity"},value:{kind:"Variable",name:{kind:"Name",value:"severity"}}},{kind:"Argument",name:{kind:"Name",value:"reportType"},value:{kind:"Variable",name:{kind:"Name",value:"reportType"}}},{kind:"Argument",name:{kind:"Name",value:"scanner"},value:{kind:"Variable",name:{kind:"Name",value:"scanner"}}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"Variable",name:{kind:"Name",value:"state"}}},{kind:"Argument",name:{kind:"Name",value:"scannerId"},value:{kind:"Variable",name:{kind:"Name",value:"scannerId"}}},{kind:"Argument",name:{kind:"Name",value:"hasIssues"},value:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}}},{kind:"Argument",name:{kind:"Name",value:"hasResolution"},value:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilitySeveritiesCount"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isGroup"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilitySeveritiesCount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"projectId"},value:{kind:"Variable",name:{kind:"Name",value:"projectId"}}},{kind:"Argument",name:{kind:"Name",value:"severity"},value:{kind:"Variable",name:{kind:"Name",value:"severity"}}},{kind:"Argument",name:{kind:"Name",value:"reportType"},value:{kind:"Variable",name:{kind:"Name",value:"reportType"}}},{kind:"Argument",name:{kind:"Name",value:"scanner"},value:{kind:"Variable",name:{kind:"Name",value:"scanner"}}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"Variable",name:{kind:"Name",value:"state"}}},{kind:"Argument",name:{kind:"Name",value:"scannerId"},value:{kind:"Variable",name:{kind:"Name",value:"scannerId"}}},{kind:"Argument",name:{kind:"Name",value:"hasIssues"},value:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}}},{kind:"Argument",name:{kind:"Name",value:"hasResolution"},value:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilitySeveritiesCount"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isProject"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilitySeveritiesCount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"severity"},value:{kind:"Variable",name:{kind:"Name",value:"severity"}}},{kind:"Argument",name:{kind:"Name",value:"reportType"},value:{kind:"Variable",name:{kind:"Name",value:"reportType"}}},{kind:"Argument",name:{kind:"Name",value:"scanner"},value:{kind:"Variable",name:{kind:"Name",value:"scanner"}}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"Variable",name:{kind:"Name",value:"state"}}},{kind:"Argument",name:{kind:"Name",value:"scannerId"},value:{kind:"Variable",name:{kind:"Name",value:"scannerId"}}},{kind:"Argument",name:{kind:"Name",value:"hasIssues"},value:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}}},{kind:"Argument",name:{kind:"Name",value:"hasResolution"},value:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}}},{kind:"Argument",name:{kind:"Name",value:"clusterAgentId"},value:{kind:"Variable",name:{kind:"Name",value:"clusterAgentId"}}},{kind:"Argument",name:{kind:"Name",value:"image"},value:{kind:"Variable",name:{kind:"Name",value:"image"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilitySeveritiesCount"},directives:[]}]}}]}}]}}],loc:{start:0,end:1705}};n.loc.source={body:'#import "ee/security_dashboard/graphql/fragments/vulnerability_severities_count.fragment.graphql"\n\nquery vulnerabilitySeveritiesCount(\n  $fullPath: ID = ""\n  $projectId: [ID!]\n  $severity: [VulnerabilitySeverity!]\n  $reportType: [VulnerabilityReportType!]\n  $scanner: [String!]\n  $state: [VulnerabilityState!]\n  $scannerId: [VulnerabilitiesScannerID!]\n  $hasIssues: Boolean\n  $hasResolution: Boolean\n  $clusterAgentId: [ClustersAgentID!]\n  $image: [String!]\n  $isGroup: Boolean = false\n  $isProject: Boolean = false\n  $isInstance: Boolean = false\n) {\n  instance: instanceSecurityDashboard @include(if: $isInstance) {\n    vulnerabilitySeveritiesCount(\n      projectId: $projectId\n      severity: $severity\n      reportType: $reportType\n      scanner: $scanner\n      state: $state\n      scannerId: $scannerId\n      hasIssues: $hasIssues\n      hasResolution: $hasResolution\n    ) {\n      ...VulnerabilitySeveritiesCount\n    }\n  }\n  group(fullPath: $fullPath) @include(if: $isGroup) {\n    id\n    vulnerabilitySeveritiesCount(\n      projectId: $projectId\n      severity: $severity\n      reportType: $reportType\n      scanner: $scanner\n      state: $state\n      scannerId: $scannerId\n      hasIssues: $hasIssues\n      hasResolution: $hasResolution\n    ) {\n      ...VulnerabilitySeveritiesCount\n    }\n  }\n  project(fullPath: $fullPath) @include(if: $isProject) {\n    id\n    vulnerabilitySeveritiesCount(\n      severity: $severity\n      reportType: $reportType\n      scanner: $scanner\n      state: $state\n      scannerId: $scannerId\n      hasIssues: $hasIssues\n      hasResolution: $hasResolution\n      clusterAgentId: $clusterAgentId\n      image: $image\n    ) {\n      ...VulnerabilitySeveritiesCount\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};n.definitions=n.definitions.concat(i("DQim").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)})));var r={};function s(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),r[e.name.value]=t}})),e.exports=n,e.exports.vulnerabilitySeveritiesCount=function(e,t){var i={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=r[t]||new Set,a=new Set,l=new Set;for(n.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(r[e]||new Set).forEach((function(e){l.add(e)})))}))}return a.forEach((function(t){var n=s(e,t);n&&i.definitions.push(n)})),i}(n,"vulnerabilitySeveritiesCount")},"/L57":function(e,t,i){"use strict";var n=i("OkMp"),a=i("0X+3"),r=i("ly/8"),s=i("t9l/"),l={name:"SecurityReportDownloadDropdown",components:{GlDropdown:n.a,GlDropdownItem:a.a},directives:{GlTooltip:r.a},props:{artifacts:{type:Array,required:!0},loading:{type:Boolean,required:!1,default:!1},text:{type:String,required:!1,default:""},title:{type:String,required:!1,default:""}},computed:{showDropdown(){return this.loading||this.artifacts.length>0}},methods:{artifactText(e){let{name:t}=e;return Object(s.h)(Object(s.g)("SecurityReports|Download %{artifactName}"),{artifactName:t})}}},o=i("bPvS"),d=Object(o.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.showDropdown?i("gl-dropdown",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],attrs:{text:e.text,title:e.title,loading:e.loading,icon:"download",size:"small",right:""}},e._l(e.artifacts,(function(t){return i("gl-dropdown-item",{key:t.path,attrs:{href:t.path,download:""}},[e._v("\n    "+e._s(e.artifactText(t))+"\n  ")])})),1):e._e()}),[],!1,null,null,null);t.a=d.exports},"0NgZ":function(e,t,i){"use strict";var n=i("q+nE"),a=i("RwX1"),r=i("oj/M"),s=i("Pf0K"),l=i("BKj5"),o=i("8VXI"),d=i("08uz"),c=i.n(d),u=i("Zxcm"),m=i("j8Yr"),v=i("M/T8"),p=i("0PCB"),f=i("Wrl+"),g=i("3saJ"),h=i("Etn4"),b=i("t9l/"),y=i("nPFI"),k=i("u1ru"),S=i("cuRJ"),_=(i("g+EE"),i("ly/8")),N=i("teVv"),E=i("mphk"),D=i("U1Ws"),C=i("acEF"),O=i("GONB"),I={components:{GlButton:S.a},directives:{GlTooltip:_.a},inject:["vulnerabilitiesExportEndpoint"],data:()=>({isPreparingCsvExport:!1}),methods:{initiateCsvExport(){var e=this;this.isPreparingCsvExport=!0,E.a.post(this.vulnerabilitiesExportEndpoint).then((function(e){let{data:t}=e;return Object(O.a)(t._links.self)})).then((function(e){let{data:t}=e;if("finished"!==t.status)throw new Error;Object(C.a)({fileName:`csv-export-${Object(D.q)(new Date,"isoDateTime")}.csv`,url:t._links.download})})).catch((function(){Object(N.createAlert)({message:Object(b.g)("SecurityReports|There was an error while generating the report.")})})).finally((function(){e.isPreparingCsvExport=!1}))}}},T=i("bPvS"),j=Object(T.a)(I,(function(){var e=this.$createElement;return(this._self._c||e)("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:this.__("Export as CSV"),loading:this.isPreparingCsvExport,icon:this.isPreparingCsvExport?"":"export"},on:{click:this.initiateCsvExport}},[this._v("\n  "+this._s(this.__("Export"))+"\n")])}),[],!1,null,null,null).exports,V={components:{GlSprintf:y.a,GlLink:k.a,GlButton:S.a,CsvExportButton:j},inject:{newVulnerabilityPath:{default:""},canAdminVulnerability:{default:!1}},computed:{shouldShowNewVulnerabilityButton(){return Boolean(this.newVulnerabilityPath)&&this.canAdminVulnerability}},i18n:{title:Object(b.g)("SecurityReports|Vulnerability Report"),submitVulnerability:Object(b.g)("SecurityReports|Submit vulnerability"),description:Object(b.g)("SecurityReports|The Vulnerability Report shows results of successful scans on your project's default branch, manually added vulnerability records, and vulnerabilities found from scanning operational environments. %{linkStart}Learn more.%{linkEnd}")},DOC_PATH_VULNERABILITY_REPORT:f.h},L=Object(T.a)(V,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("header",{staticClass:"vulnerability-header gl-my-5 gl-display-grid"},[i("h2",{staticClass:"gl-my-0 header-title",attrs:{"data-qa-selector":"vulnerability_report_header"}},[e._v("\n    "+e._s(e.$options.i18n.title)+"\n  ")]),e._v(" "),i("p",{staticClass:"header-description gl-mb-0"},[i("gl-sprintf",{attrs:{message:e.$options.i18n.description},scopedSlots:e._u([{key:"link",fn:function(t){var n=t.content;return[i("gl-link",{attrs:{href:e.$options.DOC_PATH_VULNERABILITY_REPORT,target:"_blank"}},[e._v("\n          "+e._s(n)+"\n        ")])]}}])})],1),e._v(" "),i("div",{staticClass:"header-buttons gl-display-flex gl-align-items-center"},[e.shouldShowNewVulnerabilityButton?i("gl-button",{attrs:{href:e.newVulnerabilityPath,icon:"plus"}},[e._v("\n      "+e._s(e.$options.i18n.submitVulnerability)+"\n    ")]):e._e(),e._v(" "),i("csv-export-button",{class:e.shouldShowNewVulnerabilityButton?"gl-ml-4":"gl-ml-auto",attrs:{"data-qa-selector":"export_vulnerabilities_button"}})],1)])}),[],!1,null,null,null).exports,R=i("sHmx"),w=i.n(R),x=i("uSzn"),P=i("F+K/"),A=i("MNkS"),F={components:{GlTab:x.a,GlBadge:P.a,VulnerabilityReport:A.a},props:{title:{type:String,required:!0},isActiveTab:{type:Boolean,required:!0},filterDropdowns:{type:Array,required:!0},fields:{type:Array,required:!0},filterFn:{type:Function,required:!1,default:function(e){return e}}},data:()=>({counts:void 0}),computed:{countsSum(){return w()(this.counts,(function(e){return e.count}))}},methods:{updateCounts(e){this.counts=e}}},$=Object(T.a)(F,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-tab",{scopedSlots:e._u([{key:"title",fn:function(){return[i("span",[e._v(e._s(e.title))]),e._v(" "),i("gl-badge",{staticClass:"gl-tab-counter-badge",attrs:{size:"sm"}},[e._v(e._s(e.countsSum))])]},proxy:!0}])},[e._v(" "),e._t("header"),e._v(" "),i("vulnerability-report",{staticClass:"gl-mt-7",attrs:{"is-visible":e.isActiveTab,"filter-dropdowns":e.filterDropdowns,fields:e.fields,"filter-fn":e.filterFn,"show-counts":""},on:{"counts-changed":e.updateCounts}})],2)}),[],!1,null,null,null).exports,q=i("e2Sm");const B="OPERATIONAL",M={[B]:1},G={1:B};var U={components:{GlTabs:g.a,GlCard:h.a,VulnerabilityReportHeader:L,VulnerabilityReportTab:$},mixins:[Object(u.a)()],inject:["dashboardType"],data(){var e;return{tabIndex:null!==(e=M[this.$route.query.tab])&&void 0!==e?e:0}},computed:{isProjectReport(){return this.dashboardType===a.a.PROJECT},filterDropdownsDevelopment(){return this.isProjectReport?q.d.DEVELOPMENT_PROJECT:q.d.DEVELOPMENT},filterDropdownsOperational(){return this.isProjectReport?q.d.OPERATIONAL_PROJECT:q.d.OPERATIONAL}},watch:{tabIndex(e){const t={...this.$route.query,tab:G[e],before:void 0,after:void 0};this.$router.push({query:t})}},methods:{transformFiltersDevelopment(e){var t;return this.glFeatures.refactorVulnerabilityToolFilter&&!this.isProjectReport?e:{...e,reportType:null!==(t=e.reportType)&&void 0!==t&&t.length?e.reportType:q.e.DEVELOPMENT}},transformFiltersOperational:e=>({...e,reportType:q.e.OPERATIONAL})},i18n:{developmentTab:Object(b.g)("SecurityReports|Development vulnerabilities"),operationalTab:Object(b.g)("SecurityReports|Operational vulnerabilities"),operationalTabMessage:Object(b.g)("SecurityReports|These vulnerabilities were detected in external sources. They are not necessarily tied to your GitLab project. For example, running containers, URLs, and so on.")},FIELD_PRESETS:q.b},H=Object(T.a)(U,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("vulnerability-report-header"),e._v(" "),i("gl-tabs",{attrs:{"content-class":"gl-pt-0"},model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[i("vulnerability-report-tab",{attrs:{title:e.$options.i18n.developmentTab,fields:e.$options.FIELD_PRESETS.DEVELOPMENT,"filter-dropdowns":e.filterDropdownsDevelopment,"filter-fn":e.transformFiltersDevelopment,"is-active-tab":0===e.tabIndex},scopedSlots:e._u([{key:"header",fn:function(){return[e._t("header-development")]},proxy:!0}],null,!0)}),e._v(" "),i("vulnerability-report-tab",{attrs:{title:e.$options.i18n.operationalTab,fields:e.$options.FIELD_PRESETS.OPERATIONAL,"filter-dropdowns":e.filterDropdownsOperational,"filter-fn":e.transformFiltersOperational,"is-active-tab":1===e.tabIndex},scopedSlots:e._u([{key:"header",fn:function(){return[i("gl-card",{attrs:{"body-class":"gl-p-6"}},[e._v(e._s(e.$options.i18n.operationalTabMessage))])]},proxy:!0}])})],1)],1)}),[],!1,null,null,null).exports,z={name:"AutoFixUserCallout",components:{GlBanner:i("Og7b").a},props:{helpPagePath:{type:String,required:!0}}},Q=Object(T.a)(z,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-banner",e._g({attrs:{title:e.s__("AutoRemediation|Introducing GitLab auto-fix"),"button-text":e.__("Learn more"),"button-link":e.helpPagePath,variant:"introduction"}},e.$listeners),[i("p",[e._v("\n    "+e._s(e.s__("AutoRemediation|If you're using dependency and/or container scanning, and auto-fix is enabled, auto-fix automatically creates merge requests with fixes to vulnerabilities."))+"\n  ")])])}),[],!1,null,null,null).exports,W=i("H8gz"),J=i("V9gj"),Y=i.n(J),X=i("LcVr"),K={components:{GlBadge:P.a},props:{pipeline:{type:Object,required:!0}},computed:{failedCount(){return this.pipeline.securityBuildsFailedCount||0},failedPath(){return this.pipeline.securityBuildsFailedPath||""},shouldShow(){return this.failedCount>0}}},Z=Object(T.a)(K,(function(){var e=this.$createElement,t=this._self._c||e;return this.shouldShow?t("gl-badge",{attrs:{icon:"status_failed",variant:"danger",href:this.failedPath}},[this._v("\n  "+this._s(this.n__("%d failed security job","%d failed security jobs",this.failedCount))+"\n")]):this._e()}),[],!1,null,null,null).exports,ee={components:{GlLink:k.a,GlIcon:W.a,TimeAgoTooltip:X.a,PipelineStatusBadge:Z},mixins:[Object(u.a)()],inject:["projectFullPath","autoFixMrsPath"],apollo:{autoFixMrsCount:{query:Y.a,variables(){return{fullPath:this.projectFullPath}},update(e){var t,i;return(null==e||null===(t=e.project)||void 0===t||null===(i=t.mergeRequests)||void 0===i?void 0:i.count)||0},skip(){return!this.glFeatures.securityAutoFix}}},props:{pipeline:{type:Object,required:!0}},computed:{parsingStatusMessage(){const{hasParsingErrors:e,hasParsingWarnings:t}=this.pipeline;return e&&t?this.$options.i18n.hasParsingErrorsAndWarnings:e?this.$options.i18n.hasParsingErrors:t?this.$options.i18n.hasParsingWarnings:""}},i18n:{lastUpdated:Object(b.a)("Last updated"),hasParsingErrorsAndWarnings:Object(b.g)("SecurityReports|Parsing errors and warnings in pipeline"),hasParsingErrors:Object(b.g)("SecurityReports|Parsing errors in pipeline"),hasParsingWarnings:Object(b.g)("SecurityReports|Parsing warnings in pipeline"),autoFixSolutions:Object(b.g)("AutoRemediation|Auto-fix solutions"),autoFixMrsLink:Object(b.g)("AutoRemediation|%{mrsCount} ready for review")}},te=Object(T.a)(ee,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"gl-md-display-flex gl-align-items-center gl-border-solid gl-border-1 gl-border-gray-100 gl-p-6"},[i("div",{staticClass:"gl-mr-3"},[i("span",{staticClass:"gl-font-weight-bold gl-mr-3"},[e._v(e._s(e.$options.i18n.lastUpdated))]),i("span",{staticClass:"gl-white-space-nowrap"},[i("time-ago-tooltip",{staticClass:"gl-pr-3",attrs:{time:e.pipeline.createdAt}}),i("gl-link",{attrs:{href:e.pipeline.path}},[e._v("#"+e._s(e.pipeline.id))]),e._v(" "),i("pipeline-status-badge",{staticClass:"gl-ml-3",attrs:{pipeline:e.pipeline}})],1)]),e._v(" "),e.parsingStatusMessage?i("div",{staticClass:"gl-mr-3 gl-mt-5 gl-md-mt-0 gl-text-orange-400 gl-font-weight-bold",attrs:{"data-testid":"parsing-status-notice"}},[i("gl-icon",{staticClass:"gl-mr-3",attrs:{name:"warning"}}),e._v(e._s(e.parsingStatusMessage)+"\n  ")],1):e._e(),e._v(" "),e.autoFixMrsCount?i("div",{staticClass:"gl-md-ml-3 gl-mt-5 gl-md-mt-0",attrs:{"data-testid":"auto-fix-mrs-link"}},[i("span",{staticClass:"gl-font-weight-bold gl-mr-3"},[e._v(e._s(e.$options.i18n.autoFixSolutions))]),e._v(" "),i("gl-link",{staticClass:"gl-white-space-nowrap",attrs:{href:e.autoFixMrsPath}},[e._v(e._s(e.sprintf(e.$options.i18n.autoFixMrsLink,{mrsCount:e.autoFixMrsCount})))])],1):e._e()])}),[],!1,null,null,null).exports,ie=i("VB+Q"),ne=i.n(ie),ae=i("3lde"),re=(i("ujLG"),i("3R5X"),i("HaUQ"),i("Q04j")),se=i("Atic"),le={components:{GlAlert:re.a,GlIntersperse:se.a,GlLink:k.a,GlSprintf:y.a},inject:["newProjectPipelinePath"],props:{notEnabledScanners:{type:Array,required:!0},noPipelineRunScanners:{type:Array,required:!0}},computed:{alertMessages(){return[{key:"notEnabled",link:f.c,content:this.notEnabledAlertMessage,scanners:this.notEnabledScanners},{key:"noPipelineRun",link:this.newProjectPipelinePath,content:this.noPipelineRunAlertMessage,scanners:this.noPipelineRunScanners}].filter((function(e){let{scanners:t}=e;return t.length>0}))},notEnabledAlertMessage(){return Object(b.f)("%{securityScanner} is not enabled for this project. %{linkStart}More information%{linkEnd}","%{securityScanner} are not enabled for this project. %{linkStart}More information%{linkEnd}",this.notEnabledScanners.length)},noPipelineRunAlertMessage(){return Object(b.f)("%{securityScanner} result is not available because a pipeline has not been run since it was enabled. %{linkStart}Run a pipeline%{linkEnd}","%{securityScanner} results are not available because a pipeline has not been run since it was enabled. %{linkStart}Run a pipeline%{linkEnd}",this.noPipelineRunScanners.length)}}},oe=Object(T.a)(le,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[e.alertMessages.length>0?i("gl-alert",{attrs:{variant:"warning"},on:{dismiss:function(t){return e.$emit("dismiss")}}},[i("ul",{staticClass:"gl-list-style-none gl-mb-0 gl-pl-0"},e._l(e.alertMessages,(function(t){return i("li",{key:t.key,attrs:{"data-testid":t.key}},[i("gl-sprintf",{attrs:{message:t.content},scopedSlots:e._u([{key:"securityScanner",fn:function(){return[i("gl-intersperse",e._l(t.scanners,(function(t){return i("span",{key:t},[e._v(e._s(t))])})),0)]},proxy:!0},{key:"link",fn:function(n){var a=n.content;return[i("gl-link",{attrs:{href:t.link,target:"_blank"}},[e._v(e._s(a))])]}}],null,!0)})],1)})),0)]):e._e()],1)}),[],!1,null,null,null).exports,de={components:{ReportNotConfiguredProject:ae.a,LocalStorageSync:m.a,SecurityScannerAlert:oe,AutoFixUserCallout:Q,ProjectPipelineStatus:te,VulnerabilityReportTabs:H,SecurityTrainingPromoBanner:p.a},mixins:[Object(u.a)()],inject:["fullPath","pipeline","hasVulnerabilities"],data(){return{scannerAlertDismissed:!1,securityScanners:{},shouldShowAutoFixUserCallout:this.glFeatures.securityAutoFix&&!Object(r.n)(this.$options.autoFixUserCalloutCookieName)}},apollo:{securityScanners:{query:ne.a,variables(){return{fullPath:this.fullPath}},update(e){let{project:t={}}=e;const{available:i=[],enabled:n=[],pipelineRun:a=[]}=(null==t?void 0:t.securityScanners)||{};return{available:Object(v.b)(i),enabled:Object(v.b)(n),pipelineRun:Object(v.b)(a)}}}},computed:{isReportConfigured(){return Boolean(this.pipeline.id)||this.hasVulnerabilities},notEnabledSecurityScanners(){const{available:e=[],enabled:t=[]}=this.securityScanners;return c()(e,t)},noPipelineRunSecurityScanners(){const{enabled:e=[],pipelineRun:t=[]}=this.securityScanners;return c()(e,t)},shouldShowPipelineStatus(){return this.pipeline.createdAt&&this.pipeline.id&&this.pipeline.path},shouldShowScannersAlert(){return!this.scannerAlertDismissed&&(this.notEnabledSecurityScanners.length>0||this.noPipelineRunSecurityScanners.length>0)}},methods:{closeAutoFixUserCallout(){Object(r.O)(this.$options.autoFixUserCalloutCookieName,"true"),this.shouldShowAutoFixUserCallout=!1},dismissScannerAlert(){this.scannerAlertDismissed=!0}},autoFixUserCalloutCookieName:"auto_fix_user_callout_dismissed",SCANNER_ALERT_DISMISSED_LOCAL_STORAGE_KEY:"vulnerability_list_scanner_alert_dismissed",DOC_PATH_APPLICATION_SECURITY:f.c},ce=Object(T.a)(de,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isReportConfigured?i("div",[i("local-storage-sync",{attrs:{"storage-key":e.$options.SCANNER_ALERT_DISMISSED_LOCAL_STORAGE_KEY},model:{value:e.scannerAlertDismissed,callback:function(t){e.scannerAlertDismissed=t},expression:"scannerAlertDismissed"}}),e._v(" "),e.shouldShowScannersAlert?i("security-scanner-alert",{attrs:{"not-enabled-scanners":e.notEnabledSecurityScanners,"no-pipeline-run-scanners":e.noPipelineRunSecurityScanners},on:{dismiss:e.dismissScannerAlert}}):e._e(),e._v(" "),e.shouldShowAutoFixUserCallout?i("auto-fix-user-callout",{staticClass:"gl-mt-5",attrs:{"help-page-path":e.$options.DOC_PATH_APPLICATION_SECURITY},on:{close:e.closeAutoFixUserCallout}}):e._e(),e._v(" "),i("security-training-promo-banner",{staticClass:"gl-mt-5"}),e._v(" "),i("vulnerability-report-tabs",{scopedSlots:e._u([{key:"header-development",fn:function(){return[e.shouldShowPipelineStatus?i("project-pipeline-status",{attrs:{pipeline:e.pipeline}}):e._e()]},proxy:!0}])})],1):i("report-not-configured-project")}),[],!1,null,null,null).exports,ue={components:{ReportNotConfiguredGroup:i("52Lr").a,VulnerabilityReportTabs:H},inject:["hasProjects"]},me=Object(T.a)(ue,(function(){var e=this.$createElement,t=this._self._c||e;return this.hasProjects?t("vulnerability-report-tabs"):t("report-not-configured-group")}),[],!1,null,null,null).exports,ve={components:{ReportNotConfiguredInstance:i("7SPT").a,VulnerabilityReportTabs:H},inject:["hasProjects"]},pe=Object(T.a)(ve,(function(){var e=this.$createElement,t=this._self._c||e;return this.hasProjects?t("vulnerability-report-tabs"):t("report-not-configured-instance")}),[],!1,null,null,null).exports,fe=i("COCf"),ge=i.n(fe),he=i("kM/M"),be=i.n(he),ye=i("K1pz"),ke=i.n(ye);const Se={[a.a.PROJECT]:{component:ce,query:ge.a},[a.a.GROUP]:{component:me,query:be.a},[a.a.INSTANCE]:{component:pe,query:ke.a}};t.a=function(e,t){if(!e)return null;const{isUnavailable:i,emptyStateSvgPath:d,noVulnerabilitiesSvgPath:c,securityDashboardEmptySvgPath:u,newProjectPipelinePath:m,hasVulnerabilities:v,hasProjects:p,scanners:f,vulnerabilitiesExportEndpoint:g,projectFullPath:h,autoFixMrsPath:b,groupFullPath:y,instanceDashboardSettingsPath:k,pipelineCreatedAt:S,pipelineId:_,pipelinePath:N,pipelineSecurityBuildsFailedCount:E,pipelineSecurityBuildsFailedPath:D,pipelineHasErrors:C,pipelineHasWarnings:O,hasJiraVulnerabilitiesIntegrationEnabled:I,operationalConfigurationPath:T,securityConfigurationPath:j,canAdminVulnerability:V,canViewFalsePositive:L,newVulnerabilityPath:R}=e.dataset;if(i)return new n.default({el:e,render:e=>e(s.a,{props:{svgPath:d}})});const w={dashboardType:t,noVulnerabilitiesSvgPath:c,emptyStateSvgPath:d,securityDashboardEmptySvgPath:u,newProjectPipelinePath:m,instanceDashboardSettingsPath:k,operationalConfigurationPath:T,securityConfigurationPath:j,vulnerabilitiesExportEndpoint:g,groupFullPath:y,projectFullPath:h,fullPath:h||y,autoFixMrsPath:b,canAdminVulnerability:Object(r.G)(V),hasVulnerabilities:Object(r.G)(v),hasProjects:Object(r.G)(p),scanners:f?JSON.parse(f):[],hasJiraVulnerabilitiesIntegrationEnabled:Object(r.G)(I),canViewFalsePositive:Object(r.G)(L),newVulnerabilityPath:R,vulnerabilitiesQuery:Se[t].query};t===a.a.PROJECT&&(w.pipeline={createdAt:S,id:_,path:N,securityBuildsFailedCount:Number(E),securityBuildsFailedPath:D,hasParsingErrors:Object(r.G)(C),hasParsingWarnings:Object(r.G)(O)});const x=Object(o.a)();return new n.default({el:e,name:"VulnerabilityReportRoot",router:x,apolloProvider:l.a,provide:w,render:e=>e(Se[t].component)})}},"0PCB":function(e,t,i){"use strict";var n=i("Og7b"),a=i("t9l/"),r=i("0Vpo"),s={components:{GlBanner:n.a,SecurityTrainingPromo:r.a},inject:["securityConfigurationPath","projectFullPath"],i18n:{title:Object(a.a)("Reduce risk and triage fewer vulnerabilities with security training"),content:Object(a.a)("Enable security training to help your developers learn how to fix vulnerabilities. Developers can view security training from selected educational providers, relevant to the detected vulnerability.")}},l=i("bPvS"),o=Object(l.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("security-training-promo",{attrs:{"security-configuration-path":e.securityConfigurationPath,"project-full-path":e.projectFullPath},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.buttonLink,a=t.buttonText,r=t.dismiss,s=t.trackCTAClick;return[i("gl-banner",{attrs:{title:e.$options.i18n.title,"button-text":a,"button-link":n,variant:"introduction"},on:{primary:s,close:r}},[i("p",[e._v(e._s(e.$options.i18n.content))])])]}}])})}),[],!1,null,null,null);t.a=o.exports},"0Vpo":function(e,t,i){"use strict";var n=i("t9l/"),a=i("Vb3e"),r=i("mWeI"),s=i("/6K+"),l={components:{UserCalloutDismisser:a.a},mixins:[r.a.mixin()],props:{securityConfigurationPath:{type:String,required:!0},projectFullPath:{type:String,required:!0}},i18n:{buttonText:Object(n.a)("Enable security training")},computed:{buttonLink(){return this.securityConfigurationPath+"?tab=vulnerability-management"}},methods:{trackCTAClick(){this.track(s.b,{label:s.c,property:this.projectFullPath})}}},o=i("bPvS"),d=Object(o.a)(l,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("user-callout-dismisser",{attrs:{"feature-name":"security_training_feature_promotion"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.dismiss;return[t.shouldShowCallout?e._t("default",null,null,{dismiss:i,buttonLink:e.buttonLink,buttonText:e.$options.i18n.buttonText,trackCTAClick:e.trackCTAClick}):e._e()]}}],null,!0)})}),[],!1,null,null,null);t.a=d.exports},"0sqQ":function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"d",(function(){return s})),i.d(t,"a",(function(){return l}));var n=i("t9l/"),a=i("UPUA");i.d(t,"b",(function(){return a.a}));const r={unknown:Object(n.g)("SecurityReports|Sometimes a scanner can't determine a finding's severity. Those findings may still be a potential source of risk though. Please review these manually.")},s="modal-mrwidget-security-issue",l="<Message body is not provided>"},"0ysm":function(e,t,i){"use strict";var n=i("CkNe"),a=i("cuRJ"),r=i("u1ru"),s=i("H8gz"),l=i("htOw"),o=i("w1SK"),d=i("ifd7"),c=i("883b"),u=i("aZq6"),m=i("4OTu"),v=i("xN8+"),p=i("EzJj"),f={name:"MrWidgetLicenses",componentNames:o.a,iconComponentNames:o.c,components:{GlButton:a.a,GlLink:r.a,ReportItem:u.a,ReportSection:m.a,SmartVirtualList:v.a,GlIcon:s.a},mixins:[c.a],props:{fullReportPath:{type:String,required:!1,default:null},licenseManagementSettingsPath:{type:String,required:!1,default:null},apiUrl:{type:String,required:!0},licensesApiPath:{type:String,required:!1,default:""},approvalsApiPath:{type:String,required:!1,default:""},canManageLicenses:{type:Boolean,required:!0},reportSectionClass:{type:String,required:!1,default:""},alwaysOpen:{type:Boolean,required:!1,default:!1},licenseComplianceDocsPath:{type:String,required:!1,default:""}},typicalReportItemHeight:26,maxShownReportItems:20,computed:{...Object(n.f)(d.a,["loadLicenseReportError"]),...Object(n.d)(d.a,["licenseReport","isLoading","licenseSummaryText","reportContainsDeniedLicense","licenseReportGroups"]),hasLicenseReportIssues(){const{licenseReport:e}=this;return e&&e.length>0},licenseReportStatus(){return this.checkReportStatus(this.isLoading,this.loadLicenseReportError)},showActionButtons(){return null!==this.licenseManagementSettingsPath||null!==this.fullReportPath}},watch:{licenseReport(){this.$emit("updateBadgeCount",this.licenseReport.length)}},beforeCreate(){Object(p.c)(this.$store)},mounted(){const{apiUrl:e,canManageLicenses:t,licensesApiPath:i,approvalsApiPath:n}=this;this.setAPISettings({apiUrlManageLicenses:e,canManageLicenses:t,licensesApiPath:i,approvalsApiPath:n}),this.fetchParsedLicenseReport(),this.fetchLicenseCheckApprovalRule()},methods:{trackVisitedPath(e){l.b.trackRedisHllUserEvent(e),l.b.trackRedisCounterEvent(e)},...Object(n.c)(d.a,["setAPISettings","fetchParsedLicenseReport","fetchLicenseCheckApprovalRule"])}},g=i("bPvS"),h=Object(g.a)(f,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("report-section",{staticClass:"license-report-widget mr-report",class:e.reportSectionClass,attrs:{status:e.licenseReportStatus,"loading-text":e.licenseSummaryText,"error-text":e.licenseSummaryText,"neutral-issues":e.licenseReport,"has-issues":e.hasLicenseReportIssues,component:e.$options.componentNames.LicenseIssueBody,"track-action":"users_expanding_testing_license_compliance_report","always-open":e.alwaysOpen,"data-qa-selector":"license_report_widget"},scopedSlots:e._u([{key:"body",fn:function(){return[i("smart-virtual-list",{ref:"reportSectionBody",staticClass:"report-block-container",attrs:{size:e.$options.typicalReportItemHeight,length:e.licenseReport.length,remain:e.$options.maxShownReportItems,wtag:"ul",wclass:"report-block-list my-1"}},[e._l(e.licenseReportGroups,(function(t,n){return[i("li",{key:t.name,class:["mx-1","mb-1",n>0?"mt-3":""],attrs:{"data-testid":"report-heading"}},[i("h2",{staticClass:"h5 m-0"},[e._v(e._s(t.name))]),e._v(" "),i("p",{staticClass:"m-0"},[e._v(e._s(t.description))])]),e._v(" "),e._l(t.licenses,(function(t){return i("report-item",{key:t.name,staticClass:"gl-m-2",attrs:{issue:t,"status-icon-size":12,status:t.status,component:e.$options.componentNames.LicenseIssueBody,"icon-component":e.$options.iconComponentNames.LicenseStatusIcon,"show-report-section-status-icon":!0}})}))]}))],2)]},proxy:!0},{key:"success",fn:function(){return[i("div",{staticClass:"pr-3"},[e._v("\n        "+e._s(e.licenseSummaryText)+"\n        "),e.reportContainsDeniedLicense&&e.licenseComplianceDocsPath?i("gl-link",{attrs:{href:e.licenseComplianceDocsPath,"data-testid":"security-approval-help-link",target:"_blank"}},[i("gl-icon",{attrs:{size:12,name:"question"}})],1):e._e()],1)]},proxy:!0},e.showActionButtons?{key:"action-buttons",fn:function(t){var n=t.isCollapsible;return[e.fullReportPath?i("gl-button",{staticClass:"gl-mr-3",attrs:{href:e.fullReportPath,icon:"external-link",target:"_blank","data-testid":"full-report-button"},on:{click:function(t){return e.trackVisitedPath("users_visiting_testing_license_compliance_full_report")}}},[e._v("\n        "+e._s(e.s__("ciReport|View full report"))+"\n      ")]):e._e(),e._v(" "),e.licenseManagementSettingsPath?i("gl-button",{class:{"gl-mr-3":n},attrs:{"data-testid":"manage-licenses-button",href:e.licenseManagementSettingsPath,"data-qa-selector":"manage_licenses_button"},on:{click:function(t){return e.trackVisitedPath("users_visiting_testing_manage_license_compliance")}}},[e._v("\n        "+e._s(e.s__("ciReport|Manage licenses"))+"\n      ")]):e._e()]}}:null],null,!0)})],1)}),[],!1,null,null,null);t.a=h.exports},"1AlE":function(e,t,i){"use strict";var n={};i.r(n),i.d(n,"setPipelineJobsPath",(function(){return l})),i.d(n,"setProjectId",(function(){return o})),i.d(n,"setPipelineId",(function(){return d})),i.d(n,"fetchPipelineJobs",(function(){return c}));var a=i("W7MF"),r=i("htOw"),s=i("mphk");const l=function(e,t){let{commit:i}=e;return i("SET_PIPELINE_JOBS_PATH",t)},o=function(e,t){let{commit:i}=e;return i("SET_PROJECT_ID ",t)},d=function(e,t){let{commit:i}=e;return i("SET_PIPELINE_ID ",t)},c=function(e){let t,{commit:i,state:n}=e;return n.pipelineJobsPath||n.projectId&&n.pipelineId?(i("REQUEST_PIPELINE_JOBS"),t=n.pipelineJobsPath?Object(s.a)({method:"GET",url:n.pipelineJobsPath}):r.b.pipelineJobs(n.projectId,n.pipelineId),t.then((function(e){const{data:t}=e;i("RECEIVE_PIPELINE_JOBS_SUCESS",t)})).catch((function(e){a.a(e),i("RECEIVE_PIPELINE_JOBS_ERROR")}))):i("RECEIVE_PIPELINE_JOBS_ERROR")};var u={SET_PIPELINE_JOBS_PATH(e,t){e.pipelineJobsPath=t},"SET_PROJECT_ID "(e,t){e.projectId=t},"SET_PIPELINE_ID "(e,t){e.pipelineId=t},REQUEST_PIPELINE_JOBS(e){e.isLoading=!0},RECEIVE_PIPELINE_JOBS_SUCESS(e,t){e.isLoading=!1,e.pipelineJobs=t},RECEIVE_PIPELINE_JOBS_ERROR(e){e.isLoading=!1}};t.a={namespaced:!0,state:function(){return{projectId:void 0,pipelineId:void 0,pipelineJobsPath:"",isLoading:!1,pipelineJobs:[]}},mutations:u,actions:n}},"29lL":function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"vulnerabilityConfirm"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilityConfirm"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerability"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"confirmedAt"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:182}};i.loc.source={body:"mutation vulnerabilityConfirm($id: VulnerabilityID!) {\n  vulnerabilityConfirm(input: { id: $id }) {\n    errors\n    vulnerability {\n      id\n      state\n      confirmedAt\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.vulnerabilityConfirm=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"vulnerabilityConfirm")},"2SQ7":function(e,t,i){"use strict";var n=i("nPFI"),a=i("u1ru"),r=i("XW4O"),s=i("t9l/"),l={components:{EventItem:r.a,GlSprintf:n.a,GlLink:a.a},props:{feedback:{type:Object,required:!0},project:{type:Object,required:!1,default:function(){return{}}}},computed:{hasProjectUrl(){var e,t;return Boolean((null===(e=this.project)||void 0===e?void 0:e.value)&&(null===(t=this.project)||void 0===t?void 0:t.url))},eventText(){return this.hasProjectUrl?Object(s.a)("Created merge request %{mergeRequestLink} at %{projectLink}"):Object(s.a)("Created merge request %{mergeRequestLink}")},createdAt(){return this.feedback.created_at||this.feedback.createdAt},mergeRequestPath(){return this.feedback.merge_request_path||this.feedback.mergeRequestPath},mergeRequestIid(){return this.feedback.merge_request_iid||this.feedback.mergeRequestIid}}},o=i("bPvS"),d=Object(o.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("event-item",{attrs:{author:e.feedback.author,"created-at":e.createdAt,"icon-name":"merge-request"}},[i("gl-sprintf",{attrs:{message:e.eventText},scopedSlots:e._u([{key:"mergeRequestLink",fn:function(){return[i("gl-link",{attrs:{"data-testid":"mergeRequestLink",href:e.mergeRequestPath}},[e._v("\n        !"+e._s(e.mergeRequestIid)+"\n      ")])]},proxy:!0},e.hasProjectUrl?{key:"projectLink",fn:function(){return[i("gl-link",{attrs:{"data-testid":"projectLink",href:e.project.url}},[e._v(e._s(e.project.value))])]},proxy:!0}:null],null,!0)})],1)}),[],!1,null,null,null);t.a=d.exports},"3lde":function(e,t,i){"use strict";var n=i("B0bW"),a=i("cuRJ"),r=i("t9l/"),s=i("Wrl+"),l={components:{GlEmptyState:n.a,GlButton:a.a},inject:["emptyStateSvgPath","securityConfigurationPath","newVulnerabilityPath","canAdminVulnerability"],computed:{shouldShowNewVulnerabilityButton(){return Boolean(this.newVulnerabilityPath)&&this.canAdminVulnerability}},i18n:{title:Object(r.g)("SecurityReports|Monitor vulnerabilities in your project"),submitVulnerability:Object(r.g)("SecurityReports|Submit vulnerability"),description:Object(r.g)("SecurityReports|Manage and track vulnerabilities identified in your project. Vulnerabilities are shown here when security testing is configured."),primaryButtonText:Object(r.g)("SecurityReports|Configure security testing"),secondaryButtonText:Object(r.a)("Learn more")},DOC_PATH_SECURITY_CONFIGURATION:s.d},o=i("bPvS"),d=Object(o.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.shouldShowNewVulnerabilityButton?i("div",{staticClass:"gl-my-4 gl-text-right"},[i("gl-button",{staticClass:"gl-ml-auto",attrs:{href:e.newVulnerabilityPath,icon:"plus"}},[e._v("\n      "+e._s(e.$options.i18n.submitVulnerability)+"\n    ")])],1):e._e(),e._v(" "),i("gl-empty-state",{attrs:{title:e.$options.i18n.title,"svg-path":e.emptyStateSvgPath,description:e.$options.i18n.description,"primary-button-text":e.$options.i18n.primaryButtonText,"primary-button-link":e.securityConfigurationPath,"secondary-button-text":e.$options.i18n.secondaryButtonText,"secondary-button-link":e.$options.DOC_PATH_SECURITY_CONFIGURATION}})],1)}),[],!1,null,null,null);t.a=d.exports},"52Lr":function(e,t,i){"use strict";var n=i("B0bW"),a=i("t9l/"),r=i("Wrl+"),s={components:{GlEmptyState:n.a},inject:["emptyStateSvgPath"],i18n:{title:Object(a.g)("SecurityReports|Monitor vulnerabilities in your group"),description:Object(a.g)("SecurityReports|Manage and track vulnerabilities identified in projects within your group. Vulnerabilities in projects are shown here when security testing is configured."),secondaryButtonText:Object(a.a)("Learn more")},DOC_PATH_SECURITY_CONFIGURATION:r.d},l=i("bPvS"),o=Object(l.a)(s,(function(){var e=this.$createElement;return(this._self._c||e)("gl-empty-state",{attrs:{title:this.$options.i18n.title,"svg-path":this.emptyStateSvgPath,description:this.$options.i18n.description,"secondary-button-text":this.$options.i18n.secondaryButtonText,"secondary-button-link":this.$options.DOC_PATH_SECURITY_CONFIGURATION}})}),[],!1,null,null,null);t.a=o.exports},"53mf":function(e,t){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"JobArtifacts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Pipeline"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"jobs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"securityReportTypes"},value:{kind:"Variable",name:{kind:"Name",value:"reportTypes"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"artifacts"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fileType"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:223}};i.loc.source={body:"fragment JobArtifacts on Pipeline {\n  id\n  jobs(securityReportTypes: $reportTypes) {\n    nodes {\n      id\n      name\n      artifacts {\n        nodes {\n          downloadPath\n          fileType\n        }\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.JobArtifacts=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"JobArtifacts")},"6K7K":function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"instanceProjects"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"search"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"instance"},name:{kind:"Name",value:"instanceSecurityDashboard"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[{kind:"Argument",name:{kind:"Name",value:"search"},value:{kind:"Variable",name:{kind:"Name",value:"search"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"pageSize"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nameWithNamespace"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endCursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasNextPage"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:377}};i.loc.source={body:"query instanceProjects($search: String, $pageSize: Int, $after: String) {\n  instance: instanceSecurityDashboard {\n    projects(search: $search, first: $pageSize, after: $after) {\n      edges {\n        node {\n          id\n          name\n          nameWithNamespace\n          avatarUrl\n        }\n      }\n      pageInfo {\n        endCursor\n        hasNextPage\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.instanceProjects=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"instanceProjects")},"7SPT":function(e,t,i){"use strict";var n=i("B0bW"),a=i("t9l/"),r=i("Wrl+"),s={components:{GlEmptyState:n.a},inject:["emptyStateSvgPath","instanceDashboardSettingsPath"],i18n:{title:Object(a.g)("SecurityReports|Monitor vulnerabilities in all of your projects"),description:Object(a.g)("SecurityReports|Manage and track vulnerabilities identified in your selected projects. Vulnerabilities for selected projects with security testing configured are shown here."),primaryButtonText:Object(a.a)("Add projects"),secondaryButtonText:Object(a.a)("Learn more")},DOC_PATH_SECURITY_CONFIGURATION:r.d},l=i("bPvS"),o=Object(l.a)(s,(function(){var e=this.$createElement;return(this._self._c||e)("gl-empty-state",{attrs:{title:this.$options.i18n.title,"svg-path":this.emptyStateSvgPath,description:this.$options.i18n.description,"primary-button-text":this.$options.i18n.primaryButtonText,"primary-button-link":this.instanceDashboardSettingsPath,"secondary-button-text":this.$options.i18n.secondaryButtonText,"secondary-button-link":this.$options.DOC_PATH_SECURITY_CONFIGURATION}})}),[],!1,null,null,null);t.a=o.exports},"7fsO":function(e,t,i){"use strict";var n=i("lT7T"),a=i("H8gz"),r=i("nPFI"),s=i("E4+D"),l=i("u1ru"),o=i("t9l/"),d={components:{GlModal:n.a,GlIcon:a.a,GlSprintf:r.a,GlTruncate:s.a,GlLink:l.a},props:{scannedUrls:{required:!0,type:Array},scannedResourcesCount:{required:!0,type:Number},downloadLink:{required:!0,type:String}},modal:{modalId:"dastUrl",actionPrimary:{text:Object(o.a)("Done"),attributes:{variant:"default"}}},computed:{title(){return Object(o.f)("%d Scanned URL","%d Scanned URLs",this.scannedResourcesCount)},limitedScannedUrls(){return this.scannedUrls.slice(0,15)}}},c=i("bPvS"),u=Object(c.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-modal",e._b({attrs:{title:e.title,"title-tag":"h5"}},"gl-modal",e.$options.modal,!1),[i("div",{staticClass:"row gl-text-gray-400"},[i("div",{staticClass:"col-1"},[e._v(e._s(e.__("Method")))]),e._v(" "),i("div",{staticClass:"col-11"},[e._v(e._s(e.__("URL")))])]),e._v(" "),i("hr",{staticClass:"gl-my-3"}),e._v(" "),e._l(e.limitedScannedUrls,(function(t,n){return i("div",{key:n,staticClass:"row gl-my-2"},[i("div",{staticClass:"col-1"},[e._v(e._s(t.requestMethod.toUpperCase()))]),e._v(" "),i("div",{staticClass:"col-11",attrs:{"data-testid":"dast-scanned-url"}},[i("gl-truncate",{attrs:{text:t.url,position:"middle"}})],1)])})),e._v(" "),e.downloadLink?i("div",{staticClass:"gl-display-inline-block gl-bg-gray-50 gl-my-3 gl-pl-3 gl-pr-7 gl-py-5"},[i("gl-icon",{staticClass:"gl-vertical-align-middle gl-mr-5",attrs:{name:"bulb"}}),e._v(" "),i("b",{staticClass:"gl-vertical-align-middle"},[i("gl-sprintf",{attrs:{message:e.__("To view all %{scannedResourcesCount} scanned URLs, %{linkStart}please download the CSV file%{linkEnd}")},scopedSlots:e._u([{key:"link",fn:function(t){var n=t.content;return[i("gl-link",{attrs:{download:"",href:e.downloadLink,"data-testid":"download-link"}},[e._v("\n            "+e._s(n)+"\n          ")])]}},{key:"scannedResourcesCount",fn:function(){return[e._v("\n          "+e._s(e.scannedResourcesCount)+"\n        ")]},proxy:!0}],null,!1,2770013784)})],1)],1):e._e()],2)}),[],!1,null,null,null);t.a=u.exports},"883b":function(e,t,i){"use strict";var n=i("sEKB");t.a={methods:{checkReportStatus:(e,t)=>e?n.c:t?n.a:n.j}}},"8ArR":function(e,t,i){"use strict";var n=i("CkNe"),a=i("cuRJ"),r=i("zLBL"),s=i("H8gz"),l=i("KFH7"),o=i("ifd7"),d=i("t9l/"),c=i("xQPl"),u=i("Zxcm"),m=i("P+fY"),v=(i("ylB9"),i("3R5X"),i("XexO"),i("cqb2")),p=i("6R2j"),f=i("wYtT"),g={name:"AddLicenseFormDropdown",components:{GlFormCombobox:i("5gAt").a},props:{knownLicenses:{type:Array,required:!0}},data:()=>({licenseName:""}),watch:{licenseName(e){this.$emit("update-selected-license",e)}}},h=i("bPvS"),b={name:"AddLicenseForm",components:{AddLicenseFormDropdown:Object(h.a)(g,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("gl-form-combobox",{attrs:{"token-list":e.knownLicenses,"label-text":e.s__("LicenseCompliance|Add license and related policy"),placeholder:e.s__("LicenseCompliance|License name")},model:{value:e.licenseName,callback:function(t){e.licenseName=t},expression:"licenseName"}})}),[],!1,null,null,null).exports,GlButton:a.a,GlFormRadioGroup:v.a,GlFormRadio:p.a},mixins:[Object(u.a)()],LICENSE_APPROVAL_STATUS:f.c,approvalStatusOptions:[{value:f.c.ALLOWED,label:Object(d.g)("LicenseCompliance|Allow"),description:Object(d.g)("LicenseCompliance|Acceptable license to be used in the project")},{value:f.c.DENIED,label:Object(d.g)("LicenseCompliance|Deny"),description:Object(d.g)("LicenseCompliance|Disallow merge request if detected and will instruct developer to remove")}],props:{managedLicenses:{type:Array,required:!1,default:function(){return[]}},knownLicenses:{type:Array,required:!0},loading:{type:Boolean,required:!1,default:!1}},data:()=>({approvalStatus:"",licenseName:""}),computed:{isInvalidLicense(){var e=this;return this.managedLicenses.some((function(t){let{name:i}=t;return i===e.licenseName}))},submitDisabled(){return this.isInvalidLicense||""===this.licenseName.trim()||""===this.approvalStatus}},methods:{addLicense(){this.$emit("addLicense",{newStatus:this.approvalStatus,license:{name:this.licenseName}})},closeForm(){this.$emit("closeForm")},handleLicenseUpdate(e){this.licenseName=e}}},y=Object(h.a)(b,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"col-sm-6 js-add-license-form"},[i("div",{staticClass:"form-group"},[i("add-license-form-dropdown",{attrs:{"known-licenses":e.knownLicenses},on:{"update-selected-license":e.handleLicenseUpdate}}),e._v(" "),i("div",{staticClass:"invalid-feedback",class:{"d-block":e.isInvalidLicense}},[e._v("\n      "+e._s(e.s__("LicenseCompliance|This license already exists in this project."))+"\n    ")])],1),e._v(" "),i("div",{staticClass:"form-group"},[i("gl-form-radio-group",{attrs:{name:"approvalStatus"},model:{value:e.approvalStatus,callback:function(t){e.approvalStatus=t},expression:"approvalStatus"}},e._l(e.$options.approvalStatusOptions,(function(t){return i("gl-form-radio",{key:t.value,staticClass:"gl-mb-3",attrs:{value:t.value,"data-qa-selector":t.value+"_license_radio","aria-describedby":"js-"+t.value+"-license-radio"}},[e._v("\n        "+e._s(t.label)+"\n        "),i("div",{staticClass:"text-secondary"},[e._v("\n          "+e._s(t.description)+"\n        ")])])})),1)],1),e._v(" "),i("div",{staticClass:"gl-display-flex"},[i("gl-button",{staticClass:"js-submit",attrs:{disabled:e.submitDisabled,loading:e.loading,variant:"confirm","data-qa-selector":"add_license_submit_button"},on:{click:e.addLicense}},[e._v("\n      "+e._s(e.__("Submit"))+"\n    ")]),e._v(" "),i("gl-button",{staticClass:"js-cancel ml-2",attrs:{disabled:e.loading},on:{click:e.closeForm}},[e._v("\n      "+e._s(e.__("Cancel"))+"\n    ")])],1)])}),[],!1,null,null,null).exports,k=(i("h8Et"),i("OkMp")),S=i("0X+3"),_=i("ly/8"),N=i("qINL"),E=i("95xt"),D=i("dwKt");var C={name:"AdminLicenseManagementRow",components:{GlDropdown:k.a,GlDropdownItem:S.a,GlButton:a.a,GlLoadingIcon:r.a,GlIcon:s.a,IssueStatusIcon:D.a},directives:{GlTooltip:_.a,GlModal:N.a},props:{license:{type:Object,required:!0,validator:function(e){return Boolean(e.name)&&Object.values(f.c).includes(e.approvalStatus)}},loading:{type:Boolean,required:!1,default:!1}},LICENSE_APPROVAL_STATUS:f.c,LICENSE_APPROVAL_ACTION:f.a,[f.a.ALLOW]:Object(d.g)("LicenseCompliance|Allow"),[f.a.DENY]:Object(d.g)("LicenseCompliance|Deny"),[f.c.ALLOWED]:Object(d.g)("LicenseCompliance|Allowed"),[f.c.DENIED]:Object(d.g)("LicenseCompliance|Denied"),computed:{allowedIconClass(){return this.license.approvalStatus===f.c.ALLOWED?"visible":"invisible"},deniedIconClass(){return this.license.approvalStatus===f.c.DENIED?"visible":"invisible"},status(){return Object(E.c)(this.license.approvalStatus)},dropdownText(){return this.$options[this.license.approvalStatus]}},methods:{...Object(n.c)(o.a,["setLicenseInModal","allowLicense","denyLicense"])}},O=Object(h.a)(C,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"gl-display-flex gl-align-items-center",attrs:{"data-qa-selector":"admin_license_compliance_container","data-testid":"admin-license-compliance-row"}},[i("issue-status-icon",{staticClass:"gl-display-flex gl-mr-3",attrs:{status:e.status}}),e._v(" "),i("span",{staticClass:"gl-flex-grow-1",attrs:{"data-testid":"license-name"}},[e._v(e._s(e.license.name))]),e._v(" "),i("div",{staticClass:"gl-display-flex"},[e.loading?i("gl-loading-icon",{staticClass:"gl-display-flex gl-align-items-center gl-mr-3",attrs:{size:"sm"}}):e._e(),e._v(" "),i("gl-dropdown",{attrs:{text:e.dropdownText,disabled:e.loading,"toggle-class":"gl-display-flex gl-justify-content-space-between gl-align-items-center",right:""}},[i("gl-dropdown-item",{on:{click:function(t){return e.allowLicense(e.license)}}},[i("gl-icon",{class:e.allowedIconClass,attrs:{name:"mobile-issue-close"}}),e._v("\n        "+e._s(e.$options[e.$options.LICENSE_APPROVAL_ACTION.ALLOW])+"\n      ")],1),e._v(" "),i("gl-dropdown-item",{on:{click:function(t){return e.denyLicense(e.license)}}},[i("gl-icon",{class:e.deniedIconClass,attrs:{name:"mobile-issue-close"}}),e._v("\n        "+e._s(e.$options[e.$options.LICENSE_APPROVAL_ACTION.DENY])+"\n      ")],1)],1),e._v(" "),i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"},{name:"gl-modal",rawName:"v-gl-modal.modal-license-delete-confirmation",modifiers:{"modal-license-delete-confirmation":!0}}],staticClass:"gl-ml-3",attrs:{title:e.__("Remove license"),"aria-label":e.__("Remove license"),disabled:e.loading,icon:"remove",category:"tertiary"},on:{click:function(t){return e.setLicenseInModal(e.license)}}})],1)],1)}),[],!1,null,null,null).exports,I=i("lT7T"),T=i("nPFI"),j={name:"LicenseDeleteConfirmationModal",components:{GlModal:I.a,GlSprintf:T.a},computed:{...Object(n.f)(o.a,["currentLicenseInModal"])},methods:{...Object(n.c)(o.a,["resetLicenseInModal","deleteLicense"])},modal:{title:Object(d.g)("LicenseCompliance|Remove license?"),actionPrimary:{text:Object(d.g)("LicenseCompliance|Remove license"),attributes:[{variant:"danger"}]},actionCancel:{text:Object(d.a)("Cancel")}}},V=Object(h.a)(j,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-modal",{attrs:{"modal-id":"modal-license-delete-confirmation",title:e.$options.modal.title,"action-primary":e.$options.modal.actionPrimary,"action-cancel":e.$options.modal.actionCancel},on:{primary:function(t){return e.deleteLicense(e.currentLicenseInModal)},cancel:e.resetLicenseInModal}},[e.currentLicenseInModal?i("gl-sprintf",{attrs:{message:e.s__("LicenseCompliance|You are about to remove the license, %{name}, from this project.")},scopedSlots:e._u([{key:"name",fn:function(){return[i("strong",[e._v(e._s(e.currentLicenseInModal.name))])]},proxy:!0}],null,!1,1729309668)}):e._e()],1)}),[],!1,null,null,null).exports,L={name:"LicenseManagementRow",components:{IssueStatusIcon:D.a},props:{license:{type:Object,required:!1,default:null}},computed:{iconStatus(){return Object(E.c)(this.license.approvalStatus)},textStatus(){return Object(E.e)(this.license.approvalStatus)}}},R={name:"LicenseManagement",components:{AddLicenseForm:y,DeleteConfirmationModal:V,AdminLicenseManagementRow:O,LicenseManagementRow:Object(h.a)(L,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"gl-responsive-table-row flex-md-column align-items-md-stretch p-0"},[i("div",{staticClass:"d-md-flex align-items-center js-license-row"},[i("div",{staticClass:"table-section section-30 section-wrap pr-md-3"},[i("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v("\n        "+e._s(e.s__("Licenses|Name"))+"\n      ")]),e._v(" "),i("div",{staticClass:"table-mobile-content name"},[e._v("\n        "+e._s(e.license.name)+"\n      ")])]),e._v(" "),i("div",{staticClass:"table-section section-70 section-wrap pr-md-3"},[i("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("Licenses|Policy")))]),e._v(" "),i("div",{staticClass:"table-mobile-content text-capitalize d-flex align-items-center justify-content-end justify-content-md-start status"},[i("issue-status-icon",{attrs:{status:e.iconStatus}}),e._v("\n        "+e._s(e.textStatus)+"\n      ")],1)])])])}),[],!1,null,null,null).exports,GlButton:a.a,GlLoadingIcon:r.a,GlIcon:s.a,GlPopover:l.a,PaginatedList:c.a,LicenseApprovals:m.a},mixins:[Object(u.a)()],data:()=>({formIsOpen:!1}),computed:{...Object(n.f)(o.a,["managedLicenses","isLoadingManagedLicenses","isAdmin","knownLicenses"]),...Object(n.d)(o.a,["isLicenseBeingUpdated","hasPendingLicenses","isAddingNewLicense"]),showLoadingSpinner(){return this.isLoadingManagedLicenses&&!this.hasPendingLicenses}},watch:{isAddingNewLicense(e){e||this.closeAddLicenseForm()}},mounted(){this.fetchManagedLicenses()},methods:{...Object(n.c)(o.a,["fetchManagedLicenses","setLicenseApproval"]),openAddLicenseForm(){this.formIsOpen=!0},closeAddLicenseForm(){this.formIsOpen=!1}},emptyMessage:Object(d.g)("LicenseCompliance|There are currently no policies in this project."),emptySearchMessage:Object(d.g)("LicenseCompliance|There are currently no policies that match in this project.")},w=Object(h.a)(R,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.showLoadingSpinner?i("gl-loading-icon",{attrs:{size:"sm"}}):i("div",{staticClass:"license-management"},[e.isAdmin?i("delete-confirmation-modal"):e._e(),e._v(" "),i("paginated-list",{attrs:{list:e.managedLicenses,"empty-search-message":e.$options.emptySearchMessage,"empty-message":e.$options.emptyMessage,filterable:e.isAdmin,filter:"name","data-qa-selector":"license_compliance_list"},scopedSlots:e._u([{key:"header",fn:function(){return[e.isAdmin?i("div",{staticClass:"order-1 gl-display-flex gl-align-items-center"},[i("gl-button",{staticClass:"js-open-form",attrs:{disabled:e.formIsOpen,variant:"confirm","data-qa-selector":"license_add_button"},on:{click:e.openAddLicenseForm}},[e._v("\n          "+e._s(e.s__("LicenseCompliance|Add license policy"))+"\n        ")]),e._v(" "),i("license-approvals",{staticClass:"gl-ml-3"})],1):[i("div",{staticClass:"table-section gl-display-flex gl-pl-2 section-70",attrs:{role:"rowheader"}},[e._v("\n          "+e._s(e.s__("Licenses|Policy"))+"\n          "),i("gl-icon",{ref:"reportInfo",staticClass:"text-info gl-ml-2 gl-cursor-pointer",attrs:{name:"question","aria-label":e.__("help"),size:14}}),e._v(" "),i("gl-popover",{attrs:{target:function(){return e.$refs.reportInfo.$el},placement:"bottom",triggers:"click blur","css-classes":["gl-mt-3"]}},[i("div",{staticClass:"h5"},[e._v(e._s(e.__("Allowed")))]),e._v(" "),i("span",{staticClass:"text-secondary"},[e._v("\n              "+e._s(e.s__("Licenses|Acceptable license to be used in the project")))]),e._v(" "),i("div",{staticClass:"h5"},[e._v(e._s(e.__("Denied")))]),e._v(" "),i("span",{staticClass:"text-secondary"},[e._v("\n              "+e._s(e.s__("Licenses|Unacceptable license, if detected it will disallow a merge request until it's removed")))])])],1),e._v(" "),i("div",{staticClass:"table-section section-30",attrs:{role:"rowheader"}},[e._v("\n          "+e._s(e.s__("Licenses|Name"))+"\n        ")])]]},proxy:!0},e.isAdmin?{key:"subheader",fn:function(){return[e.formIsOpen?i("div",{staticClass:"gl-mt-3 gl-mb-3"},[i("add-license-form",{attrs:{"managed-licenses":e.managedLicenses,"known-licenses":e.knownLicenses,loading:e.isAddingNewLicense},on:{addLicense:e.setLicenseApproval,closeForm:e.closeAddLicenseForm}})],1):e._e()]},proxy:!0}:null,{key:"default",fn:function(t){var n=t.listItem;return[e.isAdmin?i("admin-license-management-row",{attrs:{license:n,loading:e.isLicenseBeingUpdated(n.id)}}):i("license-management-row",{attrs:{license:n}})]}}],null,!0)})],1)}),[],!1,null,null,null);t.a=w.exports},"8VXI":function(e,t,i){"use strict";var n=i("q+nE"),a=i("rP6D");n.default.use(a.a);const r={render:e=>e("div")};t.a=function(){const e=[{path:"/",name:"dashboard",component:r}];return new a.a({mode:"history",base:window.location.pathname,routes:e})}},"95xt":function(e,t,i){"use strict";i.d(t,"f",(function(){return o})),i.d(t,"e",(function(){return d})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return u})),i.d(t,"b",(function(){return m})),i.d(t,"a",(function(){return v})),i.d(t,"g",(function(){return p}));var n=i("lKw0"),a=i.n(n),r=(i("uHfJ"),i("R0RX"),i("wYtT")),s=i("t9l/"),l=i("sEKB");const o=function(e){const{approval_status:t,...i}=e;return{...i,approvalStatus:t}},d=function(e){return e===r.c.ALLOWED?Object(s.g)("LicenseCompliance|Allowed"):e===r.c.DENIED?Object(s.g)("LicenseCompliance|Denied"):""},c=function(e){return e===r.c.ALLOWED?l.i:e===r.c.DENIED?l.g:l.h},u=function(e,t,i){const n=Object(s.f)("ciReport|Used by %{packagesString}","ciReport|Used by %{packagesString}, and %{lastPackage}",e.length);let a,r="";return 1===e.length?a=e[0].name:t&&e.length>i?a=e.slice(0,i).map((function(e){return e.name})).join(", "):(a=e.slice(0,e.length-1).map((function(e){return e.name})).join(", "),r=e[e.length-1].name),Object(s.h)(n,{packagesString:a,lastPackage:r})},m=function(e){const t=e.classification.approval_status;return{...e,approvalStatus:t,id:e.classification.id,packages:e.dependencies,status:c(t)}},v=function(e){const t=a()(e,"status");return function(e){return{...e,licenses:t[e.status]||[]}}},p=function(e){let{licenses:t}=e;return(null==t?void 0:t.length)>0}},"9X95":function(e,t){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"VulnerabilityLocation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationClusterImageScanning"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"kubernetesResource"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"agent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webPath"},arguments:[],directives:[]}]}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationContainerScanning"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationDependencyScanning"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blobPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationSast"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blobPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"startLine"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationSecretDetection"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blobPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"startLine"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationDast"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:576}};i.loc.source={body:"fragment VulnerabilityLocation on VulnerabilityLocation {\n  ... on VulnerabilityLocationClusterImageScanning {\n    image\n    kubernetesResource {\n      agent {\n        id\n        name\n        webPath\n      }\n    }\n  }\n  ... on VulnerabilityLocationContainerScanning {\n    image\n  }\n  ... on VulnerabilityLocationDependencyScanning {\n    blobPath\n    file\n  }\n  ... on VulnerabilityLocationSast {\n    blobPath\n    file\n    startLine\n  }\n  ... on VulnerabilityLocationSecretDetection {\n    blobPath\n    file\n    startLine\n  }\n  ... on VulnerabilityLocationDast {\n    path\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.VulnerabilityLocation=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"VulnerabilityLocation")},B9Cy:function(e,t,i){var n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"VulnerabilityFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Vulnerability"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"severity"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"detectedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilityPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolvedOnDefaultBranch"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userNotesCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"falsePositive"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"vetEnabled"}}}]}]},{kind:"Field",name:{kind:"Name",value:"issueLinks"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"issue"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"iid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"identifiers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilityLocation"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"project"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nameWithNamespace"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"reportType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"scanner"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendor"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:589}};n.loc.source={body:'#import "./vulnerability_location.fragment.graphql"\n\nfragment VulnerabilityFragment on Vulnerability {\n  id\n  title\n  state\n  severity\n  detectedAt\n  vulnerabilityPath\n  resolvedOnDefaultBranch\n  userNotesCount\n  falsePositive @include(if: $vetEnabled)\n  issueLinks {\n    nodes {\n      id\n      issue {\n        id\n        iid\n        webUrl\n        webPath\n        title\n        state\n      }\n    }\n  }\n  identifiers {\n    externalType\n    name\n  }\n  location {\n    ...VulnerabilityLocation\n  }\n  project {\n    id\n    nameWithNamespace\n  }\n  reportType\n  scanner {\n    id\n    vendor\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};n.definitions=n.definitions.concat(i("9X95").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)})));var r={};function s(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),r[e.name.value]=t}})),e.exports=n,e.exports.VulnerabilityFragment=function(e,t){var i={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=r[t]||new Set,a=new Set,l=new Set;for(n.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(r[e]||new Set).forEach((function(e){l.add(e)})))}))}return a.forEach((function(t){var n=s(e,t);n&&i.definitions.push(n)})),i}(n,"VulnerabilityFragment")},BC1l:function(e,t,i){"use strict";i("WmlO"),i("3R5X"),i("W9Nl");var n=i("RwX1");t.a=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1?arguments[1]:void 0;const a=t.find((function(e){return e[i]===n.d}));return(null==a?void 0:a.name)||(null===(e=t[0])||void 0===e?void 0:e.name)||""}},BKj5:function(e,t,i){"use strict";var n=i("q+nE"),a=i("EfTh"),r=i("1/rY"),s=i("voi4");n.default.use(a.b);const l={typePolicies:{Group:{fields:{projects:Object(r.b)(["includeSubgroups","ids","search"])}},InstanceSecurityDashboard:{fields:{projects:Object(r.b)(["search"])}}}},o=Object(s.a)({},{cacheConfig:l});t.a=new a.b({defaultClient:o})},COCf:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"projectVulnerabilities"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"20"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"severity"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitySeverity"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportType"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityReportType"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scanner"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scannerId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitiesScannerID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"state"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityState"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sort"}},type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitySort"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeExternalIssueLinks"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"vetEnabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clusterAgentId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClustersAgentID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"image"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilities"},arguments:[{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"severity"},value:{kind:"Variable",name:{kind:"Name",value:"severity"}}},{kind:"Argument",name:{kind:"Name",value:"reportType"},value:{kind:"Variable",name:{kind:"Name",value:"reportType"}}},{kind:"Argument",name:{kind:"Name",value:"scanner"},value:{kind:"Variable",name:{kind:"Name",value:"scanner"}}},{kind:"Argument",name:{kind:"Name",value:"scannerId"},value:{kind:"Variable",name:{kind:"Name",value:"scannerId"}}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"Variable",name:{kind:"Name",value:"state"}}},{kind:"Argument",name:{kind:"Name",value:"sort"},value:{kind:"Variable",name:{kind:"Name",value:"sort"}}},{kind:"Argument",name:{kind:"Name",value:"hasIssues"},value:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}}},{kind:"Argument",name:{kind:"Name",value:"hasResolution"},value:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}}},{kind:"Argument",name:{kind:"Name",value:"clusterAgentId"},value:{kind:"Variable",name:{kind:"Name",value:"clusterAgentId"}}},{kind:"Argument",name:{kind:"Name",value:"image"},value:{kind:"Variable",name:{kind:"Name",value:"image"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilityFragment"},directives:[]},{kind:"Field",name:{kind:"Name",value:"externalIssueLinks"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"includeExternalIssueLinks"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"issue"},name:{kind:"Name",value:"externalIssue"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalTracker"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"iid"},name:{kind:"Name",value:"relativeReference"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"hasSolutions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mergeRequest"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"securityAutoFix"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"iid"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PageInfo"},directives:[]}]}}]}}]}}]}}],loc:{start:0,end:1574}};n.loc.source={body:'#import "../fragments/vulnerability.fragment.graphql"\n#import "~/graphql_shared/fragments/page_info.fragment.graphql"\n\nquery projectVulnerabilities(\n  $fullPath: ID!\n  $before: String\n  $after: String\n  $first: Int = 20\n  $last: Int\n  $severity: [VulnerabilitySeverity!]\n  $reportType: [VulnerabilityReportType!]\n  $scanner: [String!]\n  $scannerId: [VulnerabilitiesScannerID!]\n  $state: [VulnerabilityState!]\n  $sort: VulnerabilitySort\n  $hasIssues: Boolean\n  $hasResolution: Boolean\n  $includeExternalIssueLinks: Boolean = false\n  $vetEnabled: Boolean = false\n  $clusterAgentId: [ClustersAgentID!]\n  $image: [String!]\n) {\n  project(fullPath: $fullPath) {\n    id\n    vulnerabilities(\n      before: $before\n      after: $after\n      first: $first\n      last: $last\n      severity: $severity\n      reportType: $reportType\n      scanner: $scanner\n      scannerId: $scannerId\n      state: $state\n      sort: $sort\n      hasIssues: $hasIssues\n      hasResolution: $hasResolution\n      clusterAgentId: $clusterAgentId\n      image: $image\n    ) {\n      nodes {\n        ...VulnerabilityFragment\n        externalIssueLinks @include(if: $includeExternalIssueLinks) {\n          nodes {\n            id\n            issue: externalIssue {\n              externalTracker\n              webUrl\n              title\n              iid: relativeReference\n            }\n          }\n        }\n        hasSolutions\n        mergeRequest {\n          id\n          webUrl\n          state\n          securityAutoFix\n          iid\n        }\n      }\n      pageInfo {\n        ...PageInfo\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)}))}n.definitions=n.definitions.concat(r(i("B9Cy").definitions)),n.definitions=n.definitions.concat(r(i("IVfO").definitions));var s={};function l(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),s[e.name.value]=t}})),e.exports=n,e.exports.projectVulnerabilities=function(e,t){var i={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=s[t]||new Set,a=new Set,r=new Set;for(n.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(t){var n=l(e,t);n&&i.definitions.push(n)})),i}(n,"projectVulnerabilities")},"D/gg":function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"vulnerabilityResolve"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilityResolve"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerability"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolvedAt"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:181}};i.loc.source={body:"mutation vulnerabilityResolve($id: VulnerabilityID!) {\n  vulnerabilityResolve(input: { id: $id }) {\n    errors\n    vulnerability {\n      id\n      state\n      resolvedAt\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.vulnerabilityResolve=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"vulnerabilityResolve")},DQim:function(e,t){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"VulnerabilitySeveritiesCount"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitySeveritiesCount"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"critical"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"high"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"info"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"low"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"medium"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unknown"},arguments:[],directives:[]}]}}],loc:{start:0,end:124}};i.loc.source={body:"fragment VulnerabilitySeveritiesCount on VulnerabilitySeveritiesCount {\n  critical\n  high\n  info\n  low\n  medium\n  unknown\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.VulnerabilitySeveritiesCount=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"VulnerabilitySeveritiesCount")},EEVk:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"projectVulnerabilitiesCount"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"startDate"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ISO8601Date"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"endDate"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ISO8601Date"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCountByDay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"startDate"},value:{kind:"Variable",name:{kind:"Name",value:"startDate"}}},{kind:"Argument",name:{kind:"Name",value:"endDate"},value:{kind:"Variable",name:{kind:"Name",value:"endDate"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"critical"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"high"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"info"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"low"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"medium"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unknown"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:355}};i.loc.source={body:"query projectVulnerabilitiesCount(\n  $fullPath: ID!\n  $startDate: ISO8601Date!\n  $endDate: ISO8601Date!\n) {\n  project(fullPath: $fullPath) {\n    id\n    vulnerabilitiesCountByDay(startDate: $startDate, endDate: $endDate) {\n      nodes {\n        date\n        critical\n        high\n        info\n        low\n        medium\n        unknown\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.projectVulnerabilitiesCount=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"projectVulnerabilitiesCount")},EghD:function(e,t,i){"use strict";var n=i("OkMp"),a=i("6HTq"),r=i("E4+D"),s=i("Ox/j"),l={components:{GlDropdown:n.a,GlSearchBoxByType:a.a,GlTruncate:r.a,GlDropdownText:s.a},props:{value:{type:String,required:!1,default:""},name:{type:String,required:!0},selectedOptions:{type:Array,required:!0},showSearchBox:{type:Boolean,required:!1,default:!1},loading:{type:Boolean,required:!1,default:!1}},data:function(){return{searchBoxText:""}},computed:{firstSelectedOption(){var e;return(null===(e=this.selectedOptions[0])||void 0===e?void 0:e.name)||"-"},extraOptionCount(){return this.selectedOptions.length-1},qaSelector(){return`filter_${this.name.toLowerCase().replace(" ","_")}_dropdown`}},methods:{emitInput(e){this.$emit("input",e)},async emitDropdownShow(){var e;this.$emit("dropdown-show"),await this.$nextTick(),null===(e=this.$refs.searchBox)||void 0===e||e.focusInput()}}},o=i("bPvS"),d=Object(o.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("strong",{attrs:{"data-testid":"name"}},[e._v(e._s(e.name))]),e._v(" "),i("gl-dropdown",{staticClass:"gl-mt-2 gl-w-full",attrs:{"menu-class":"dropdown-extended-height","header-text":e.name,loading:e.loading,"toggle-class":"gl-w-full"},on:{show:e.emitDropdownShow,hide:function(t){return e.$emit("dropdown-hide")}},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("div",{staticClass:"gl-display-flex"},[i("gl-truncate",{staticClass:"gl-min-w-0",attrs:{text:e.firstSelectedOption,"data-qa-selector":e.qaSelector}}),e._v(" "),e.extraOptionCount?i("span",{staticClass:"gl-ml-2"},[e._v("\n          "+e._s(e.n__("+%d more","+%d more",e.extraOptionCount))+"\n        ")]):e._e()],1)]},proxy:!0},e.showSearchBox?{key:"header",fn:function(){return[i("gl-search-box-by-type",{ref:"searchBox",attrs:{placeholder:e.__("Search"),autocomplete:"off"},on:{input:e.emitInput},model:{value:e.searchBoxText,callback:function(t){e.searchBoxText=t},expression:"searchBoxText"}})]},proxy:!0}:null],null,!0)},[e._v(" "),e._v(" "),e._t("default",(function(){return[i("gl-dropdown-text",[i("span",{staticClass:"gl-text-gray-500"},[e._v(e._s(e.__("No matching results")))])])]}))],2)],1)}),[],!1,null,null,null);t.a=d.exports},EzJj:function(e,t,i){"use strict";i.d(t,"b",(function(){return ie})),i.d(t,"c",(function(){return ne}));var n={};i.r(n),i.d(n,"setAPISettings",(function(){return p})),i.d(n,"setLicenseInModal",(function(){return f})),i.d(n,"setIsAdmin",(function(){return g})),i.d(n,"setKnownLicenses",(function(){return h})),i.d(n,"resetLicenseInModal",(function(){return b})),i.d(n,"receiveDeleteLicense",(function(){return y})),i.d(n,"receiveDeleteLicenseError",(function(){return k})),i.d(n,"deleteLicense",(function(){return S})),i.d(n,"requestManagedLicenses",(function(){return _})),i.d(n,"receiveManagedLicensesSuccess",(function(){return N})),i.d(n,"receiveManagedLicensesError",(function(){return E})),i.d(n,"fetchManagedLicenses",(function(){return D})),i.d(n,"requestParsedLicenseReport",(function(){return C})),i.d(n,"receiveParsedLicenseReportSuccess",(function(){return O})),i.d(n,"receiveParsedLicenseReportError",(function(){return I})),i.d(n,"fetchParsedLicenseReport",(function(){return T})),i.d(n,"receiveSetLicenseApproval",(function(){return j})),i.d(n,"receiveSetLicenseApprovalError",(function(){return V})),i.d(n,"fetchLicenseCheckApprovalRule",(function(){return L})),i.d(n,"requestLicenseCheckApprovalRule",(function(){return R})),i.d(n,"receiveLicenseCheckApprovalRuleSuccess",(function(){return w})),i.d(n,"receiveLicenseCheckApprovalRuleError",(function(){return x})),i.d(n,"addPendingLicense",(function(){return P})),i.d(n,"removePendingLicense",(function(){return A})),i.d(n,"setLicenseApproval",(function(){return F})),i.d(n,"allowLicense",(function(){return $})),i.d(n,"denyLicense",(function(){return q}));var a={};i.r(a),i.d(a,"isLoading",(function(){return M})),i.d(a,"isLicenseBeingUpdated",(function(){return G})),i.d(a,"isAddingNewLicense",(function(){return U})),i.d(a,"hasPendingLicenses",(function(){return H})),i.d(a,"licenseReport",(function(){return z})),i.d(a,"licenseReportGroups",(function(){return Q})),i.d(a,"hasReportItems",(function(){return W})),i.d(a,"baseReportHasLicenses",(function(){return J})),i.d(a,"licenseReportLength",(function(){return Y})),i.d(a,"licenseSummaryText",(function(){return X})),i.d(a,"summaryTextWithLicenseCheck",(function(){return K})),i.d(a,"summaryTextWithoutLicenseCheck",(function(){return Z})),i.d(a,"reportContainsDeniedLicense",(function(){return ee}));var r=i("q+nE"),s=i("CkNe"),l=i("ifd7"),o=(i("uHfJ"),i("R0RX"),i("g+EE"),i("ylB9"),i("3R5X"),i("XexO"),i("h8Et"),i("pNYv")),d=i("mphk"),c=i("GONB"),u=i("QIJl"),m=i("wYtT");var v=i("95xt");const p=function(e,t){let{commit:i}=e;i("SET_API_SETTINGS",t)},f=function(e,t){let{commit:i}=e;i("SET_LICENSE_IN_MODAL",t)},g=function(e,t){let{commit:i}=e;i("SET_IS_ADMIN",t)},h=function(e,t){let{commit:i}=e;i("SET_KNOWN_LICENSES",t)},b=function(e){let{commit:t}=e;t("RESET_LICENSE_IN_MODAL")},y=function(e,t){let{commit:i,dispatch:n}=e;return i("RESET_LICENSE_IN_MODAL"),n(u.a+"/fetchLicenses",null,{root:!0}),n("fetchManagedLicenses").then((function(){n("removePendingLicense",t)}))},k=function(e){let{commit:t}=e;t("RESET_LICENSE_IN_MODAL")},S=function(e){let{dispatch:t,state:i}=e;const n=i.currentLicenseInModal.id;t("addPendingLicense",n);const a=`${i.apiUrlManageLicenses}/${n}`;return d.a.delete(a).then((function(){t("receiveDeleteLicense",n)})).catch((function(){t("receiveDeleteLicenseError"),t("removePendingLicense",n)}))},_=function(e){let{commit:t}=e;t("REQUEST_MANAGED_LICENSES")},N=function(e,t){let{commit:i}=e;i("RECEIVE_MANAGED_LICENSES_SUCCESS",t)},E=function(e){let{commit:t}=e;t("RECEIVE_MANAGED_LICENSES_ERROR")},D=function(e){let{dispatch:t,state:i}=e;t("requestManagedLicenses");const{apiUrlManageLicenses:n}=i;return d.a.get(n,{params:{per_page:100}}).then((function(e){let{data:i}=e;t("receiveManagedLicensesSuccess",i)})).catch((function(){t("receiveManagedLicensesError")}))},C=function(e){let{commit:t}=e;t("REQUEST_PARSED_LICENSE_REPORT")},O=function(e,t){let{commit:i}=e;i("RECEIVE_PARSED_LICENSE_REPORT_SUCCESS",t)},I=function(e,t){let{commit:i}=e;i("RECEIVE_PARSED_LICENSE_REPORT_ERROR",t)},T=function(e){let{dispatch:t,state:i}=e;t("requestParsedLicenseReport"),Object(c.a)(i.licensesApiPath).then((function(e){let{data:i}=e;const n=(i.new_licenses||i).map(v.b),a=(i.existing_licenses||[]).map(v.b);t("receiveParsedLicenseReportSuccess",{newLicenses:n,existingLicenses:a})})).catch((function(e){t("receiveParsedLicenseReportError",e)}))},j=function(e,t){let{commit:i,dispatch:n,state:a}=e;return i("RESET_LICENSE_IN_MODAL"),n(u.a+"/fetchLicenses",null,{root:!0}),a.licensesApiPath?n("fetchParsedLicenseReport"):n("fetchManagedLicenses").then((function(){n("removePendingLicense",t)}))},V=function(e){let{commit:t}=e;t("RESET_LICENSE_IN_MODAL")},L=function(e){let{dispatch:t,state:i}=e;return t("requestLicenseCheckApprovalRule"),i.approvalsApiPath?d.a.get(i.approvalsApiPath).then((function(e){let{data:i}=e;const n=i.approval_rules_left.some((function(e){return e.name===o.f}));t("receiveLicenseCheckApprovalRuleSuccess",{hasLicenseCheckApprovalRule:n})})).catch((function(e){t("receiveLicenseCheckApprovalRuleError",e)})):t("receiveLicenseCheckApprovalRuleError",new Error("approvalsApiPath not provided"))},R=function(e){let{commit:t}=e;t("REQUEST_LICENSE_CHECK_APPROVAL_RULE")},w=function(e,t){let{commit:i}=e;i("RECEIVE_LICENSE_CHECK_APPROVAL_RULE_SUCCESS",t)},x=function(e,t){let{commit:i}=e;i("RECEIVE_LICENSE_CHECK_APPROVAL_RULE_ERROR",t)},P=function(e){let{state:t,commit:i}=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.pendingLicenses.includes(n)||i("ADD_PENDING_LICENSE",n)},A=function(e){let{commit:t}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t("REMOVE_PENDING_LICENSE",i)},F=function(e,t){let{dispatch:i,state:n}=e;const{apiUrlManageLicenses:a}=n,{license:r,newStatus:s}=t,{id:l,name:o}=r;let c;return i("addPendingLicense",l),c=l?d.a.patch(`${a}/${l}`,{approval_status:s}):d.a.post(a,{approval_status:s,name:o}),c.then((function(){i("receiveSetLicenseApproval",l)})).catch((function(){i("receiveSetLicenseApprovalError"),i("removePendingLicense",l)}))},$=function(e,t){let{dispatch:i}=e;const{approvalStatus:n}=t;n!==m.c.ALLOWED&&i("setLicenseApproval",{license:t,newStatus:m.c.ALLOWED})},q=function(e,t){let{dispatch:i}=e;const{approvalStatus:n}=t;n!==m.c.DENIED&&i("setLicenseApproval",{license:t,newStatus:m.c.DENIED})};i("ujLG"),i("HaUQ");var B=i("t9l/");const M=function(e){return e.isLoadingManagedLicenses||e.isLoadingLicenseReport||e.isLoadingLicenseCheckApprovalRule},G=function(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e.pendingLicenses.includes(t)}},U=function(e,t){return t.isLicenseBeingUpdated()},H=function(e){return e.pendingLicenses.length>0},z=function(e){return e.newLicenses},Q=function(e){return m.e.map(Object(v.a)(e.newLicenses)).filter(v.g)},W=function(e,t){return Boolean(t.licenseReportLength)},J=function(e){return Boolean(e.existingLicenses.length)},Y=function(e,t){return t.licenseReport.length},X=function(e,t){return t.isLoading?Object(B.h)(Object(B.g)("ciReport|Loading %{reportName} report"),{reportName:Object(B.a)("License Compliance")}):e.loadLicenseReportError?Object(B.h)(Object(B.g)("ciReport|Failed to load %{reportName} report"),{reportName:Object(B.a)("License Compliance")}):t.hasReportItems?e.hasLicenseCheckApprovalRule?t.summaryTextWithLicenseCheck:t.summaryTextWithoutLicenseCheck:t.baseReportHasLicenses?Object(B.g)("LicenseCompliance|License Compliance detected no new licenses"):Object(B.g)("LicenseCompliance|License Compliance detected no licenses for the source branch only")},K=function(e,t){return t.baseReportHasLicenses?t.reportContainsDeniedLicense?Object(B.f)("LicenseCompliance|License Compliance detected %d new license and policy violation; approval required","LicenseCompliance|License Compliance detected %d new licenses and policy violations; approval required",t.licenseReportLength):Object(B.f)("LicenseCompliance|License Compliance detected %d new license","LicenseCompliance|License Compliance detected %d new licenses",t.licenseReportLength):t.reportContainsDeniedLicense?Object(B.f)("LicenseCompliance|License Compliance detected %d license and policy violation for the source branch only; approval required","LicenseCompliance|License Compliance detected %d licenses and policy violations for the source branch only; approval required",t.licenseReportLength):Object(B.f)("LicenseCompliance|License Compliance detected %d license for the source branch only","LicenseCompliance|License Compliance detected %d licenses for the source branch only",t.licenseReportLength)},Z=function(e,t){return t.baseReportHasLicenses?t.reportContainsDeniedLicense?Object(B.f)("LicenseCompliance|License Compliance detected %d new license and policy violation","LicenseCompliance|License Compliance detected %d new licenses and policy violations",t.licenseReportLength):Object(B.f)("LicenseCompliance|License Compliance detected %d new license","LicenseCompliance|License Compliance detected %d new licenses",t.licenseReportLength):t.reportContainsDeniedLicense?Object(B.f)("LicenseCompliance|License Compliance detected %d license and policy violation for the source branch only","LicenseCompliance|License Compliance detected %d licenses and policy violations for the source branch only",t.licenseReportLength):Object(B.f)("LicenseCompliance|License Compliance detected %d license for the source branch only","LicenseCompliance|License Compliance detected %d licenses for the source branch only",t.licenseReportLength)},ee=function(e,t){return(t.licenseReport||[]).some((function(e){return e.approvalStatus===m.c.DENIED}))};var te={SET_LICENSE_IN_MODAL(e,t){Object.assign(e,{currentLicenseInModal:t})},RESET_LICENSE_IN_MODAL(e){Object.assign(e,{currentLicenseInModal:null})},SET_API_SETTINGS(e,t){Object.assign(e,t)},SET_IS_ADMIN(e,t){Object.assign(e,{isAdmin:t})},SET_KNOWN_LICENSES(e,t){Object.assign(e,{knownLicenses:t})},RECEIVE_MANAGED_LICENSES_SUCCESS(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(v.f).reverse();Object.assign(e,{managedLicenses:t,isLoadingManagedLicenses:!1})},RECEIVE_MANAGED_LICENSES_ERROR(e){Object.assign(e,{managedLicenses:[],isLoadingManagedLicenses:!1})},REQUEST_MANAGED_LICENSES(e){Object.assign(e,{isLoadingManagedLicenses:!0})},RECEIVE_PARSED_LICENSE_REPORT_SUCCESS(e,t){let{newLicenses:i,existingLicenses:n}=t;Object.assign(e,{newLicenses:i,existingLicenses:n,isLoadingLicenseReport:!1,loadLicenseReportError:!1})},RECEIVE_PARSED_LICENSE_REPORT_ERROR(e,t){Object.assign(e,{isLoadingLicenseReport:!1,loadLicenseReportError:t})},REQUEST_PARSED_LICENSE_REPORT(e){Object.assign(e,{isLoadingLicenseReport:!0})},REQUEST_LICENSE_CHECK_APPROVAL_RULE(e){Object.assign(e,{isLoadingLicenseCheckApprovalRule:!0})},RECEIVE_LICENSE_CHECK_APPROVAL_RULE_SUCCESS(e,t){let{hasLicenseCheckApprovalRule:i}=t;Object.assign(e,{isLoadingLicenseCheckApprovalRule:!1,hasLicenseCheckApprovalRule:i})},RECEIVE_LICENSE_CHECK_APPROVAL_RULE_ERROR(e){Object.assign(e,{isLoadingLicenseCheckApprovalRule:!1})},ADD_PENDING_LICENSE(e,t){e.pendingLicenses.push(t)},REMOVE_PENDING_LICENSE(e,t){e.pendingLicenses=e.pendingLicenses.filter((function(e){return e!==t}))}};r.default.use(s.b);const ie=function(){return{namespaced:!0,state:{apiUrlManageLicenses:null,approvalsApiPath:null,licensesApiPath:null,canManageLicenses:!1,currentLicenseInModal:null,isAdmin:!1,isLoadingLicenseReport:!1,isLoadingManagedLicenses:!1,pendingLicenses:[],loadLicenseReportError:!1,managedLicenses:[],newLicenses:[],existingLicenses:[],hasLicenseCheckApprovalRule:!1,isLoadingLicenseCheckApprovalRule:!1,knownLicenses:[]},actions:n,getters:a,mutations:te}},ne=function(e){e.hasModule(l.a)||e.registerModule(l.a,ie())};t.a=function(){return new s.b.Store({modules:{licenseManagement:ie()}})}},F9Mj:function(e,t,i){"use strict";var n=i("Q04j"),a=i("lT7T"),r=i("oSqs"),s={name:"DismissalCommentBox",components:{GlFormTextarea:r.a},props:{placeholder:{type:String,required:!1,default:""},value:{type:String,required:!1,default:""},dismissalComment:{type:String,required:!1,default:""},errorMessage:{type:String,required:!1,default:""}},computed:{localComment:{get(){return this.value},set(e){this.$emit("input",e)}},textAreaState(){return!this.errorMessage&&null}},mounted(){this.$emit("input",this.dismissalComment),this.$emit("clearError"),this.$refs.dismissalComment.$el.focus()},methods:{handleKeyPress(e){13===e.keyCode&&e.metaKey&&this.$emit("submit")}}},l=i("bPvS"),o=Object(l.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("gl-form-textarea",{ref:"dismissalComment",attrs:{rows:"3",state:e.textAreaState,placeholder:e.placeholder},nativeOn:{keydown:function(t){return e.handleKeyPress.apply(null,arguments)}},model:{value:e.localComment,callback:function(t){e.localComment=t},expression:"localComment"}}),e._v(" "),e.errorMessage?i("span",{staticClass:"js-error invalid-feedback"},[e._v(e._s(e.errorMessage))]):e._e()],1)}),[],!1,null,null,null).exports,d=i("t9l/");const c=Object(d.g)("vulnerability|Add a comment or reason for dismissal");var u={name:"DismissalCommentBoxToggle",components:{DismissalCommentBox:o,GlFormTextarea:r.a},props:{value:{type:String,required:!1,default:""},dismissalComment:{type:String,required:!1,default:""},errorMessage:{type:String,required:!1,default:""},isActive:{type:Boolean,required:!1,default:!1}},PLACEHOLDER:c,computed:{localComment:{get(){return this.value},set(e){this.$emit("input",e)}}}},m=Object(l.a)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("hr",{staticClass:"my-3"}),e._v(" "),e.isActive?i("dismissal-comment-box",{attrs:{"data-qa-selector":"dismiss_comment_field","dismissal-comment":e.dismissalComment,"error-message":e.errorMessage,placeholder:e.$options.PLACEHOLDER},on:{submit:function(t){return e.$emit("submit")},clearError:function(t){return e.$emit("clearError")}},model:{value:e.localComment,callback:function(t){e.localComment=t},expression:"localComment"}}):i("gl-form-textarea",{staticClass:"bg-gray-light js-comment-placeholder",attrs:{placeholder:e.$options.PLACEHOLDER},nativeOn:{focus:function(t){return e.$emit("openDismissalCommentBox")}}})],1)}),[],!1,null,null,null).exports,v=i("cuRJ"),p=i("mWeI"),f={name:"DismissalCommentModalFooter",components:{GlButton:v.a},props:{isDismissingVulnerability:{type:Boolean,required:!1,default:!1},isDismissed:{type:Boolean,required:!1,default:!1},isEditingExistingFeedback:{type:Boolean,required:!1,default:!1}},computed:{submitLabel(){return this.isEditingExistingFeedback?Object(d.g)("vulnerability|Save comment"):this.isDismissed?Object(d.g)("vulnerability|Add comment"):Object(d.g)("vulnerability|Add comment & dismiss")}},methods:{addCommentAndDismiss(){p.a.event(document.body.dataset.page,"click_add_comment_and_dismiss"),this.$emit("addCommentAndDismiss")},addDismissalComment(){this.isEditingExistingFeedback?p.a.event(document.body.dataset.page,"click_edit_comment"):p.a.event(document.body.dataset.page,"click_add_comment"),this.$emit("addDismissalComment")},handleSubmit(){this.isDismissed?this.addDismissalComment():this.addCommentAndDismiss()}}},g=Object(l.a)(f,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("gl-button",{staticClass:"js-cancel",attrs:{variant:"default",category:"primary"},on:{click:function(t){return e.$emit("cancel")}}},[e._v("\n    "+e._s(e.__("Cancel"))+"\n  ")]),e._v(" "),i("gl-button",{attrs:{loading:e.isDismissingVulnerability,disabled:e.isDismissingVulnerability,"data-qa-selector":"add_and_dismiss_button","data-testid":"add_and_dismiss_button"},on:{click:e.handleSubmit}},[e._v("\n    "+e._s(e.submitLabel)+"\n  ")])],1)}),[],!1,null,null,null).exports,h=i("nPFI"),b=i("u1ru"),y=i("XW4O"),k={components:{EventItem:y.a,GlButton:v.a,GlSprintf:h.a,GlLink:b.a},props:{feedback:{type:Object,required:!0},project:{type:Object,required:!1,default:function(){return{}}},isCommentingOnDismissal:{type:Boolean,required:!1,default:!1},isShowingDeleteButtons:{type:Boolean,required:!1,default:!1},showDismissalCommentActions:{type:Boolean,required:!1,default:!1},isDismissingVulnerability:{type:Boolean,required:!1,default:!1}},computed:{pipeline(){var e;return null===(e=this.feedback)||void 0===e?void 0:e.pipeline},eventText(){const{project:e,pipeline:t}=this,i=Boolean((null==t?void 0:t.path)&&(null==t?void 0:t.id)),n=Boolean((null==e?void 0:e.url)&&(null==e?void 0:e.value));return i&&n?Object(d.a)("Dismissed on pipeline %{pipelineLink} at %{projectLink}"):i?Object(d.a)("Dismissed on pipeline %{pipelineLink}"):n?Object(d.a)("Dismissed at %{projectLink}"):Object(d.a)("Dismissed")},commentDetails(){return this.feedback.comment_details},vulnDismissalActionButtons(){var e=this;return[{iconName:"pencil",onClick:function(){return e.$emit("editVulnerabilityDismissalComment")},title:Object(d.a)("Edit Comment")},{iconName:"remove",onClick:function(){return e.$emit("showDismissalDeleteButtons")},title:Object(d.a)("Delete Comment")}]}}},S=Object(l.a)(k,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("event-item",{attrs:{author:e.feedback.author,"created-at":e.feedback.created_at,"icon-name":"cancel","icon-class":"ci-status-icon-pending"}},[e.feedback.created_at?i("div",[i("gl-sprintf",{attrs:{message:e.eventText},scopedSlots:e._u([e.pipeline?{key:"pipelineLink",fn:function(){return[i("gl-link",{attrs:{href:e.pipeline.path}},[e._v("#"+e._s(e.pipeline.id))])]},proxy:!0}:null,e.project?{key:"projectLink",fn:function(){return[i("gl-link",{attrs:{href:e.project.value}},[e._v(e._s(e.project.value))])]},proxy:!0}:null],null,!0)})],1):e._e()]),e._v(" "),e.commentDetails&&!e.isCommentingOnDismissal?[i("hr",{staticClass:"my-3"}),e._v(" "),i("event-item",{attrs:{"action-buttons":e.vulnDismissalActionButtons,author:e.commentDetails.comment_author,"created-at":e.commentDetails.comment_timestamp,"show-right-slot":e.isShowingDeleteButtons,"show-action-buttons":e.showDismissalCommentActions,"icon-name":"comment","icon-class":"ci-status-icon-pending"},scopedSlots:e._u([{key:"right-content",fn:function(){return[i("div",{staticClass:"d-flex flex-grow-1 align-self-start flex-row-reverse"},[i("gl-button",{attrs:{category:"primary",variant:"danger"},on:{click:function(t){return e.$emit("deleteDismissalComment")}}},[e._v("\n            "+e._s(e.__("Delete comment"))+"\n          ")]),e._v(" "),i("gl-button",{staticClass:"mr-2",on:{click:function(t){return e.$emit("hideDismissalDeleteButtons")}}},[e._v("\n            "+e._s(e.__("Cancel"))+"\n          ")])],1)]},proxy:!0}],null,!1,2859865025)},[e._v("\n      "+e._s(e.commentDetails.comment)+"\n\n      ")])]:e._e()],2)}),[],!1,null,null,null).exports,_={components:{EventItem:y.a,GlSprintf:h.a,GlLink:b.a},props:{feedback:{type:Object,required:!0},project:{type:Object,required:!1,default:function(){return{}}}},computed:{hasProjectUrl(){var e,t;return Boolean((null===(e=this.project)||void 0===e?void 0:e.value)&&(null===(t=this.project)||void 0===t?void 0:t.url))},eventText(){return this.hasProjectUrl?Object(d.a)("Created issue %{issueLink} at %{projectLink}"):Object(d.a)("Created issue %{issueLink}")}}},N=Object(l.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("event-item",{attrs:{author:e.feedback.author,"created-at":e.feedback.created_at,"icon-name":"issues"}},[i("gl-sprintf",{attrs:{message:e.eventText},scopedSlots:e._u([{key:"issueLink",fn:function(){return[i("gl-link",{attrs:{href:e.feedback.issue_url}},[e._v("#"+e._s(e.feedback.issue_iid))])]},proxy:!0},e.hasProjectUrl?{key:"projectLink",fn:function(){return[i("gl-link",{attrs:{href:e.project.url}},[e._v(e._s(e.project.value))])]},proxy:!0}:null],null,!0)})],1)}),[],!1,null,null,null).exports,E=i("2SQ7"),D=i("ly/8"),C={name:"DismissButton",components:{GlButton:v.a},directives:{GlTooltip:D.a},props:{isDismissing:{type:Boolean,required:!1,default:!1},isDismissed:{type:Boolean,required:!0},disabled:{type:Boolean,required:!1,default:!1}},computed:{buttonText(){return this.isDismissed?Object(d.g)("vulnerability|Undo dismiss"):Object(d.g)("vulnerability|Dismiss vulnerability")}},methods:{handleDismissClick(){this.isDismissed?this.$emit("revertDismissVulnerability"):this.$emit("dismissVulnerability")}}},O=Object(l.a)(C,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"btn-group",attrs:{role:"group"}},[i("gl-button",{staticClass:"js-dismiss-btn",attrs:{loading:e.isDismissing,disabled:e.isDismissing||e.disabled},on:{click:e.handleDismissClick}},[e._v("\n    "+e._s(e.buttonText)+"\n  ")]),e._v(" "),e.isDismissed?e._e():i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"js-dismiss-with-comment",attrs:{disabled:e.disabled,title:e.s__("vulnerability|Add comment and dismiss"),"data-qa-selector":"dismiss_with_comment_button","aria-label":e.s__("vulnerability|Add comment and dismiss"),icon:"comment"},on:{click:function(t){return e.$emit("openDismissalCommentBox")}}})],1)}),[],!1,null,null,null).exports,I=i("gjqA"),T={components:{DismissButton:O,GlButton:v.a,SplitButton:I.a},props:{modal:{type:Object,required:!0},isDismissed:{type:Boolean,required:!1,default:!1},canCreateIssue:{type:Boolean,required:!1,default:!1},canCreateMergeRequest:{type:Boolean,required:!1,default:!1},canDownloadPatch:{type:Boolean,required:!1,default:!1},canDismissVulnerability:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},isCreatingIssue:{type:Boolean,required:!0},isDismissingVulnerability:{type:Boolean,required:!0},isCreatingMergeRequest:{type:Boolean,required:!0},vulnerability:{type:Object,required:!0}},computed:{createIssueButtonText(){return this.vulnerability.create_jira_issue_url?Object(d.g)("ciReport|Create Jira issue"):Object(d.g)("ciReport|Create issue")},actionButtons(){const e=[],t={name:this.createIssueButtonText,tagline:Object(d.g)("ciReport|Investigate this vulnerability by creating an issue"),icon:this.vulnerability.create_jira_issue_url?"external-link":void 0,loading:this.isCreatingIssue,target:this.vulnerability.create_jira_issue_url?"_blank":void 0,action:this.vulnerability.create_jira_issue_url?void 0:"createNewIssue",href:this.vulnerability.create_jira_issue_url},i={name:Object(d.g)("ciReport|Resolve with merge request"),tagline:Object(d.g)("ciReport|Automatically apply the patch in a new branch"),loading:this.isCreatingMergeRequest,action:"createMergeRequest"},n={name:Object(d.g)("ciReport|Download patch to resolve"),tagline:Object(d.g)("ciReport|Download the patch to apply it manually"),action:"downloadPatch"};return this.canCreateMergeRequest&&e.push(i),this.canDownloadPatch&&e.push(n),this.canCreateIssue&&e.push(t),e}}},j=Object(l.a)(T,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("gl-button",{attrs:{"data-qa-selector":"cancel_button",disabled:e.disabled},on:{click:function(t){return e.$emit("cancel")}}},[e._v("\n    "+e._s(e.__("Cancel"))+"\n  ")]),e._v(" "),e.canDismissVulnerability?i("dismiss-button",{attrs:{"is-dismissing":e.isDismissingVulnerability,"is-dismissed":e.isDismissed,disabled:e.disabled},on:{dismissVulnerability:function(t){return e.$emit("dismissVulnerability")},openDismissalCommentBox:function(t){return e.$emit("openDismissalCommentBox")},revertDismissVulnerability:function(t){return e.$emit("revertDismissVulnerability")}}}):e._e(),e._v(" "),e.actionButtons.length>1?i("split-button",{staticClass:"js-split-button",attrs:{buttons:e.actionButtons,"data-qa-selector":"resolve_split_button",disabled:e.disabled},on:{createMergeRequest:function(t){return e.$emit("createMergeRequest")},createNewIssue:function(t){return e.$emit("createNewIssue")},downloadPatch:function(t){return e.$emit("downloadPatch")}}}):e.actionButtons.length>0?i("gl-button",e._b({attrs:{disabled:e.disabled,variant:"confirm",category:"secondary","data-testid":"create-issue-button","data-qa-selector":"create_issue_button"},on:{click:function(t){return e.$emit(e.actionButtons[0].action)}}},"gl-button",e.actionButtons[0],!1),[e._v("\n    "+e._s(e.actionButtons[0].name)+"\n  ")]):e._e()],1)}),[],!1,null,null,null).exports,V=i("H8gz"),L=i("Etn4"),R={name:"SolutionCard",components:{GlIcon:V.a,GlCard:L.a},props:{solution:{type:String,default:"",required:!1},remediation:{type:Object,default:null,required:!1},hasDownload:{type:Boolean,default:!1,required:!1},hasMr:{type:Boolean,default:!1,required:!1},isStandaloneVulnerability:{type:Boolean,required:!1,default:!1}},computed:{solutionText(){return this.solution||this.remediation&&this.remediation.summary},showCreateMergeRequestMsg(){return!this.hasMr&&Boolean(this.remediation)&&this.hasDownload}}},w=Object(l.a)(R,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.solutionText||e.showCreateMergeRequestMsg?i("gl-card",{staticClass:"gl-my-6",attrs:{"body-class":{"gl-p-0":!e.solutionText},"footer-class":{"gl-border-0":!e.solutionText}},scopedSlots:e._u([e.solutionText?{key:"default",fn:function(){return[i("div",{staticClass:"gl-display-flex gl-align-items-center"},[i("div",{staticClass:"col-auto gl-display-flex gl-align-items-center gl-justify-content-end gl-pl-0",class:{"col-md-2":!e.isStandaloneVulnerability}},[i("gl-icon",{staticClass:"gl-mr-5",attrs:{name:"bulb"}}),e._v(" "),i("strong",[e._v(e._s(e.s__("ciReport|Solution"))+":")])],1),e._v(" "),i("span",{staticClass:"flex-shrink-1 gl-pl-0",class:{"col-md-10":!e.isStandaloneVulnerability}},[e._v(e._s(e.solutionText))])])]},proxy:!0}:null,e.showCreateMergeRequestMsg?{key:"footer",fn:function(){return[i("em",{staticClass:"gl-text-gray-500",attrs:{"data-testid":"merge-request-solution"}},[e._v("\n      "+e._s(e.s__("ciReport|Create a merge request to implement this solution, or download and apply the patch manually."))+"\n    ")])]},proxy:!0}:null],null,!0)}):e._e()}),[],!1,null,null,null).exports,x=(i("WmlO"),i("3R5X"),i("W9Nl"),i("uHfJ"),i("R0RX"),i("47Gk")),P=i("F+K/"),A=i("JmT7"),F=i("RwX1"),$=i("t8no"),q=i("5jZV"),B=i("ZMYx"),M=i("oj/M"),G=i("yYHy"),U=i("y+fM"),H=i("V0Nv");var z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hostname:t,path:i}=e;return"string"!=typeof t||"string"!=typeof i?null:`${t}${i}`},Q=i("TBKw"),W=i("hY08"),J={name:"VulnerabilityDetail",props:{label:{type:String,required:!0}}},Y=Object(l.a)(J,(function(e,t){var i=t._c;return i("div",{staticClass:"d-sm-flex my-sm-2 my-4"},[i("label",{staticClass:"col-sm-2 text-sm-right gl-font-weight-bold gl-pl-0"},[t._v(t._s(t.props.label)+":")]),t._v(" "),i("div",{staticClass:"col-sm-10 gl-pl-0 gl-text-gray-500"},[t._t("default")],2)])}),[],!0,null,null,null).exports,X={name:"VulnerabilityDetails",components:{CodeBlock:U.a,GenericReportSection:q.a,GlFriendlyWrap:x.a,SeverityBadge:W.a,VulnerabilityDetail:Y,GlLink:b.a,GlBadge:P.a,FalsePositiveAlert:$.a,VulnerabilityTraining:H.a},directives:{SafeHtml:A.a},props:{vulnerability:{type:Object,required:!0}},data:()=>({showTraining:!1}),computed:{url(){var e;return(null===(e=this.vulnerability.request)||void 0===e?void 0:e.url)||z(this.vulnLocation)},file(){var e,t;const i=null===(e=this.vulnerability)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.file;if(!i)return null;let n="";const{start_line:a,end_line:r}=this.vulnLocation;return a&&(n+=":"+a,r&&a!==r&&(n+="-"+r)),`${i}${n}`},identifiers(){return this.asNonEmptyListOrNull(this.vulnerability.identifiers)},vulnLocation(){return this.vulnerability.location},crashAddress(){var e;return null===(e=this.vulnLocation)||void 0===e?void 0:e.crash_address},crashType(){var e;return null===(e=this.vulnLocation)||void 0===e?void 0:e.crash_type},crashState(){var e;return null===(e=this.vulnLocation)||void 0===e?void 0:e.crash_state},className(){var e;return null===(e=this.vulnLocation)||void 0===e?void 0:e.class},methodName(){var e;return null===(e=this.vulnLocation)||void 0===e?void 0:e.method},image(){var e;return null===(e=this.vulnLocation)||void 0===e?void 0:e.image},namespace(){var e;return null===(e=this.vulnLocation)||void 0===e?void 0:e.operating_system},assets(){return this.asNonEmptyListOrNull(this.vulnerability.assets)},links(){return this.asNonEmptyListOrNull(this.vulnerability.links)},assertion(){var e;return null===(e=this.vulnerability.evidenceSource)||void 0===e?void 0:e.name},recordedMessage(){var e,t;return null===(e=this.vulnerability.supporting_messages)||void 0===e||null===(t=e.find((function(e){return e.name===B.h.RECORDED})))||void 0===t?void 0:t.response},constructedRequest(){const{request:e}=this.vulnerability;return e?this.constructRequest(e):""},constructedResponse(){const{response:e}=this.vulnerability;return e?this.constructResponse(e):""},constructedRecordedResponse(){return this.recordedMessage?this.constructResponse(this.recordedMessage):""},responseStatusCode(){var e;return null===(e=this.vulnerability.response)||void 0===e?void 0:e.status_code},scannerType(){return F.e[this.vulnerability.report_type]},scannerUrl(){var e;return(null===(e=this.vulnerability.scanner)||void 0===e?void 0:e.url)||""},scannerVersion(){var e;return null===(e=this.vulnerability.scanner)||void 0===e?void 0:e.version},scannerName(){var e;return null===(e=this.vulnerability.scanner)||void 0===e?void 0:e.name},scannerProvider(){return this.scannerVersion?Object(d.h)(Object(d.g)("Vulnerability|%{scannerName} (version %{scannerVersion})"),{scannerName:this.scannerName,scannerVersion:this.scannerVersion}):this.scannerName},stacktraceSnippet(){var e;return null===(e=this.vulnLocation)||void 0===e?void 0:e.stacktrace_snippet},falsePositive(){return this.vulnerability.false_positive},hasDescription(){return this.vulnerability.description_html||this.vulnerability.description},hasRequest(){return Boolean(this.constructedRequest)},hasResponse(){return Boolean(this.constructedResponse)},hasRecordedResponse(){return Boolean(this.constructedRecordedResponse)},normalizedProjectFullPath(){var e;const t=null===(e=this.vulnerability.project)||void 0===e?void 0:e.full_path;return t?Object(G.e)(t):""},camelCaseFormattedIdentifiers(){return Object(M.h)(this.identifiers)}},methods:{getHeadersAsCodeBlockLines:e=>Array.isArray(e)?e.map((function(e){let{name:t,value:i}=e;return`${t}: ${i}`})).join("\n"):"",hasMoreValues:(e,t)=>e<t.length-1,asNonEmptyListOrNull:e=>(null==e?void 0:e.length)>0?e:null,constructResponse(e){const{body:t,statusCode:i,reasonPhrase:n="",headers:a=[]}=Object(M.j)(e),r=this.getHeadersAsCodeBlockLines(a);return i&&r?[`${i} ${n}\n`,r,"\n\n",Object(Q.a)(t)].join(""):""},constructRequest(e){const{body:t,method:i,url:n,headers:a=[]}=e,r=this.getHeadersAsCodeBlockLines(a);return i&&n&&r?[`${i} ${n}\n`,r,"\n\n",Object(Q.a)(t)].join(""):""},handleShowTraining(e){this.showTraining=e}},i18n:{VULNERABILITY_TRAINING_HEADING:B.k}},K=Object(l.a)(X,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"border-white mb-0 px-3"},[e.falsePositive?i("false-positive-alert"):e._e(),e._v(" "),e.vulnerability.state?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Status")}},[i("gl-badge",{staticClass:"text-capitalize",attrs:{variant:"warning"}},[e._v(e._s(e.vulnerability.state))])],1):e._e(),e._v(" "),e.hasDescription?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Description")}},[e.vulnerability.description_html?i("p",{directives:[{name:"safe-html",rawName:"v-safe-html",value:e.vulnerability.description_html,expression:"vulnerability.description_html"}],attrs:{"data-testid":"description"}}):i("p",{attrs:{"data-testid":"description"}},[e._v(e._s(e.vulnerability.description))])]):e._e(),e._v(" "),e.vulnerability.project?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Project")}},[i("gl-link",{ref:"projectLink",attrs:{href:e.vulnerability.project.full_path,target:"_blank"}},[i("gl-friendly-wrap",{attrs:{text:e.vulnerability.project.full_name}})],1)],1):e._e(),e._v(" "),e.methodName?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Method")}},[i("gl-friendly-wrap",{attrs:{text:e.methodName}})],1):e._e(),e._v(" "),e.url?i("vulnerability-detail",{attrs:{label:e.__("URL")}},[i("gl-link",{ref:"urlLink",attrs:{href:e.url,target:"_blank"}},[i("gl-friendly-wrap",{attrs:{text:e.url}})],1)],1):e._e(),e._v(" "),e.hasRequest?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Request")}},[i("code-block",{ref:"request",attrs:{code:e.constructedRequest,"max-height":"225px"}})],1):e._e(),e._v(" "),e.hasRecordedResponse?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Unmodified Response")}},[i("code-block",{ref:"recordedResponse",attrs:{code:e.constructedRecordedResponse,"max-height":"225px"}})],1):e._e(),e._v(" "),e.hasResponse?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Actual Response")}},[i("code-block",{ref:"unmodifiedResponse",attrs:{code:e.constructedResponse,"max-height":"225px"}})],1):e._e(),e._v(" "),e.file?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|File")}},[e.vulnerability.blob_path?i("gl-link",{ref:"fileLink",attrs:{href:e.vulnerability.blob_path,target:"_blank"}},[i("gl-friendly-wrap",{attrs:{text:e.file}})],1):i("gl-friendly-wrap",{attrs:{text:e.file}})],1):e._e(),e._v(" "),e.vulnerability.evidence?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Evidence")}},[i("gl-friendly-wrap",{attrs:{text:e.vulnerability.evidence}})],1):e._e(),e._v(" "),e.crashAddress?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Crash address")}},[i("span",{ref:"crashAddress"},[e._v(" "+e._s(e.crashAddress)+" ")])]):e._e(),e._v(" "),e.crashType?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Crash type")}},[i("span",{ref:"crashType"},[e._v(" "+e._s(e.crashType)+" ")])]):e._e(),e._v(" "),e.crashState?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Crash state")}},[i("span",{ref:"crashState"},[e._v(" "+e._s(e.crashState)+" ")])]):e._e(),e._v(" "),e.stacktraceSnippet?i("vulnerability-detail",{attrs:{label:e.__("Stacktrace snippet")}},[i("code-block",{ref:"stacktraceSnippet",attrs:{code:e.stacktraceSnippet,"max-height":"225px"}})],1):e._e(),e._v(" "),e.identifiers?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Identifiers")}},e._l(e.identifiers,(function(t,n){return i("span",{key:n},[t.url?i("gl-link",{ref:"identifiersLink",refInFor:!0,staticClass:"gl-word-break-all",attrs:{href:t.url,target:"_blank",rel:"nofollow"}},[e._v("\n        "+e._s(t.name)+"\n      ")]):i("span",[e._v(" "+e._s(t.name)+" ")]),e._v(" "),e.hasMoreValues(n,e.identifiers)?i("span",[e._v(", ")]):e._e()],1)})),0):e._e(),e._v(" "),e.vulnerability.severity?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Severity")}},[i("severity-badge",{staticClass:"d-inline",attrs:{severity:e.vulnerability.severity}})],1):e._e(),e._v(" "),e.vulnerability.report_type?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Tool")}},[i("gl-friendly-wrap",{attrs:{text:e.scannerType}})],1):e._e(),e._v(" "),e.scannerProvider?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Scanner Provider")}},[e.scannerUrl?i("gl-link",{ref:"scannerLink",attrs:{href:e.scannerUrl,target:"_blank"}},[i("gl-friendly-wrap",{attrs:{text:e.scannerProvider}})],1):i("gl-friendly-wrap",{attrs:{text:e.scannerProvider}})],1):e._e(),e._v(" "),e.className?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Class")}},[i("gl-friendly-wrap",{attrs:{text:e.className}})],1):e._e(),e._v(" "),e.image?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Image")}},[i("gl-friendly-wrap",{attrs:{text:e.image}})],1):e._e(),e._v(" "),e.namespace?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Namespace")}},[i("gl-friendly-wrap",{attrs:{text:e.namespace}})],1):e._e(),e._v(" "),e.links?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Links")}},e._l(e.links,(function(t,n){return i("span",{key:n},[i("gl-link",{ref:"linksLink",refInFor:!0,staticClass:"gl-word-break-all",attrs:{href:t.url,target:"_blank"}},[e._v("\n        "+e._s(t.value||t.url)+"\n      ")]),e._v(" "),e.hasMoreValues(n,e.links)?i("span",[e._v(", ")]):e._e()],1)})),0):e._e(),e._v(" "),e.assets?i("vulnerability-detail",{attrs:{label:e.s__("Vulnerability|Reproduction Assets")}},e._l(e.assets,(function(t,n){return i("span",{key:n},[t.url?i("gl-link",{ref:"assetsLink",refInFor:!0,staticClass:"gl-word-break-all",attrs:{href:t.url,target:"_blank",rel:"nofollow"}},[e._v("\n        "+e._s(e.s__("Vulnerability|Download"))+" "+e._s(t.name)+"\n      ")]):i("span",[e._v(" "+e._s(t.name)+" ")]),e._v(" "),e.hasMoreValues(n,e.assets)?i("span",[e._v(", ")]):e._e()],1)})),0):e._e(),e._v(" "),e.vulnerability.details?i("generic-report-section",{staticClass:"gl-mt-4",attrs:{details:e.vulnerability.details}}):e._e(),e._v(" "),e.identifiers&&e.normalizedProjectFullPath?i("div",{directives:[{name:"show",rawName:"v-show",value:e.showTraining,expression:"showTraining"}]},[i("vulnerability-detail",{attrs:{label:e.$options.i18n.VULNERABILITY_TRAINING_HEADING.title}},[i("vulnerability-training",{attrs:{"project-full-path":e.normalizedProjectFullPath,identifiers:e.camelCaseFormattedIdentifiers,file:e.vulnLocation.file},on:{"show-vulnerability-training":e.handleShowTraining}})],1)],1):e._e()],1)}),[],!1,null,null,null).exports,Z={VULNERABILITY_MODAL_ID:i("0sqQ").d,components:{DismissalNote:S,DismissalCommentBoxToggle:m,DismissalCommentModalFooter:g,IssueNote:N,MergeRequestNote:E.a,GlAlert:n.a,GlModal:a.a,ModalFooter:j,SolutionCard:w,VulnerabilityDetails:K},props:{modal:{type:Object,required:!0},canCreateIssue:{type:Boolean,required:!1,default:!1},canDismissVulnerability:{type:Boolean,required:!1,default:!1},isCreatingIssue:{type:Boolean,required:!0},isDismissingVulnerability:{type:Boolean,required:!0},isCreatingMergeRequest:{type:Boolean,required:!0}},data:()=>({localDismissalComment:"",dismissalCommentErrorMessage:""}),computed:{canCreateIssueForThisVulnerability(){return Boolean(!this.isResolved&&!this.vulnerability.hasIssue&&this.canCreateIssue)},canCreateMergeRequestForThisVulnerability(){return Boolean(!this.isResolved&&!this.vulnerability.hasMergeRequest&&this.remediation)},canDismissThisVulnerability(){return Boolean(!this.isResolved&&this.canDismissVulnerability)},canDownloadPatchForThisVulnerability(){var e,t;return Boolean(!this.isResolved&&(null===(e=this.remediation)||void 0===e||null===(t=e.diff)||void 0===t?void 0:t.length)>0&&!this.vulnerability.hasMergeRequest&&this.remediation)},isResolved(){return Boolean(this.modal.isResolved)},project(){return this.modal.project},solution(){var e;return null===(e=this.vulnerability)||void 0===e?void 0:e.solution},remediation(){var e,t;return null===(e=this.vulnerability)||void 0===e||null===(t=e.remediations)||void 0===t?void 0:t[0]},vulnerability(){return this.modal.vulnerability},issueFeedback(){var e;return null===(e=this.vulnerability)||void 0===e?void 0:e.issue_feedback},canReadIssueFeedback(){var e;return null===(e=this.issueFeedback)||void 0===e?void 0:e.issue_url},mergeRequestFeedback(){var e;return null===(e=this.vulnerability)||void 0===e?void 0:e.merge_request_feedback},canReadMergeRequestFeedback(){var e;return null===(e=this.mergeRequestFeedback)||void 0===e?void 0:e.merge_request_path},dismissalFeedback(){var e,t;return(null===(e=this.vulnerability)||void 0===e?void 0:e.dismissalFeedback)||(null===(t=this.vulnerability)||void 0===t?void 0:t.dismissal_feedback)},isEditingExistingFeedback(){return this.dismissalFeedback&&this.modal.isCommentingOnDismissal},dismissalFeedbackObject(){if(this.dismissalFeedback)return this.dismissalFeedback;const{current_user_avatar_url:e,current_user_fullname:t,current_user_id:i,current_username:n}=gon;return{author:{id:i,name:t,username:n,state:"active",avatar_url:e}}},dismissalFeedbackComment(){var e,t;return null===(e=this.dismissalFeedback)||void 0===e||null===(t=e.comment_details)||void 0===t?void 0:t.comment},showFeedbackNotes(){return(this.canReadIssueFeedback||this.canReadMergeRequestFeedback)&&(this.issueFeedback||this.mergeRequestFeedback)},showDismissalCard(){return this.dismissalFeedback||this.modal.isCommentingOnDismissal},showDismissalCommentActions(){var e;return!(null!==(e=this.dismissalFeedback)&&void 0!==e&&e.comment_details&&this.isEditingExistingFeedback)},showDismissalCommentTextbox(){var e;return!(null!==(e=this.dismissalFeedback)&&void 0!==e&&e.comment_details)||this.isEditingExistingFeedback}},methods:{handleDismissalCommentSubmission(){this.dismissalFeedback?this.addDismissalComment():this.addCommentAndDismiss()},addCommentAndDismiss(){this.localDismissalComment.length?this.$emit("dismissVulnerability",this.localDismissalComment):this.addDismissalError()},addDismissalComment(){this.localDismissalComment.length?this.$emit("addDismissalComment",this.localDismissalComment):this.addDismissalError()},addDismissalError(){this.dismissalCommentErrorMessage=Object(d.a)("Please add a comment in the text area above")},clearDismissalError(){this.dismissalCommentErrorMessage=""},close(){this.$refs.modal.close()}}},ee=Object(l.a)(Z,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-modal",e._b({ref:"modal",staticClass:"modal-security-report-dast",attrs:{"modal-id":e.$options.VULNERABILITY_MODAL_ID,title:e.modal.title,size:"lg","data-qa-selector":"vulnerability_modal_content"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[e.modal.isCommentingOnDismissal?i("dismissal-comment-modal-footer",{attrs:{"is-dismissed":e.vulnerability.isDismissed,"is-editing-existing-feedback":e.isEditingExistingFeedback,"is-dismissing-vulnerability":e.isDismissingVulnerability},on:{addCommentAndDismiss:e.addCommentAndDismiss,addDismissalComment:e.addDismissalComment,cancel:function(t){return e.$emit("closeDismissalCommentBox")}}}):i("modal-footer",{ref:"footer",attrs:{modal:e.modal,vulnerability:e.vulnerability,disabled:e.modal.isShowingDeleteButtons,"can-create-issue":e.canCreateIssueForThisVulnerability,"can-create-merge-request":e.canCreateMergeRequestForThisVulnerability,"can-download-patch":e.canDownloadPatchForThisVulnerability,"can-dismiss-vulnerability":e.canDismissThisVulnerability,"is-dismissed":e.vulnerability.isDismissed,"is-creating-issue":e.isCreatingIssue,"is-dismissing-vulnerability":e.isDismissingVulnerability,"is-creating-merge-request":e.isCreatingMergeRequest},on:{createMergeRequest:function(t){return e.$emit("createMergeRequest")},createNewIssue:function(t){return e.$emit("createNewIssue")},dismissVulnerability:function(t){return e.$emit("dismissVulnerability")},openDismissalCommentBox:function(t){return e.$emit("openDismissalCommentBox")},revertDismissVulnerability:function(t){return e.$emit("revertDismissVulnerability")},downloadPatch:function(t){return e.$emit("downloadPatch")},cancel:e.close}})]},proxy:!0}])},"gl-modal",e.$attrs,!1),[e._t("default",(function(){return[i("vulnerability-details",{staticClass:"js-vulnerability-details",attrs:{vulnerability:e.vulnerability}}),e._v(" "),i("solution-card",{attrs:{solution:e.solution,remediation:e.remediation,"has-mr":e.vulnerability.hasMergeRequest,"has-download":e.canDownloadPatchForThisVulnerability}}),e._v(" "),e.showFeedbackNotes?i("div",{staticClass:"card my-4"},[e.issueFeedback?i("issue-note",{staticClass:"card-body",attrs:{feedback:e.issueFeedback,project:e.project}}):e._e(),e._v(" "),e.mergeRequestFeedback?i("merge-request-note",{staticClass:"card-body",attrs:{feedback:e.mergeRequestFeedback,project:e.project}}):e._e()],1):e._e(),e._v(" "),e.showDismissalCard?i("div",{staticClass:"card card-body my-4"},[i("dismissal-note",{attrs:{feedback:e.dismissalFeedbackObject,"is-commenting-on-dismissal":e.modal.isCommentingOnDismissal,"is-showing-delete-buttons":e.modal.isShowingDeleteButtons,project:e.project,"show-dismissal-comment-actions":e.showDismissalCommentActions},on:{editVulnerabilityDismissalComment:function(t){return e.$emit("editVulnerabilityDismissalComment")},showDismissalDeleteButtons:function(t){return e.$emit("showDismissalDeleteButtons")},hideDismissalDeleteButtons:function(t){return e.$emit("hideDismissalDeleteButtons")},deleteDismissalComment:function(t){return e.$emit("deleteDismissalComment")}}}),e._v(" "),e.showDismissalCommentTextbox?i("dismissal-comment-box-toggle",{attrs:{"dismissal-comment":e.dismissalFeedbackComment,"is-active":e.modal.isCommentingOnDismissal,"error-message":e.dismissalCommentErrorMessage},on:{openDismissalCommentBox:function(t){return e.$emit("openDismissalCommentBox")},submit:e.handleDismissalCommentSubmission,clearError:e.clearDismissalError},model:{value:e.localDismissalComment,callback:function(t){e.localDismissalComment=t},expression:"localDismissalComment"}}):e._e()],1):e._e(),e._v(" "),e.modal.error?i("gl-alert",{attrs:{variant:"danger",dismissible:!1}},[e._v(e._s(e.modal.error))]):e._e()]}))],2)}),[],!1,null,null,null);t.a=ee.exports},"G+28":function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return o}));var n=i("G7sT"),a=i.n(n),r=(i("h8Et"),i("0no1"),i("3R5X"),i("gdbl"),i("JHu5"),i("XUYm"),i("qzef"));const s=function(e,t,i,n,a){t&&t.includes(i)&&e.push({reportType:i,name:n(i),path:a})},l=function(e,t){return t.reduce((function(t,i){var n,l;return(null!==(n=null===(l=i.artifacts)||void 0===l?void 0:l.nodes)&&void 0!==n?n:[]).forEach((function(n){let{downloadPath:l,fileType:o}=n;s(t,e,r.l[o],(function(){return i.name}),l),s(t,e,r.a[o],(function(e){return`${i.name} ${a()(e)}`}),l)})),t}),[])},o=function(e,t){var i,n,a,r,s;const o=null!==(i=null===(n=t.project)||void 0===n||null===(a=n.mergeRequest)||void 0===a||null===(r=a.headPipeline)||void 0===r||null===(s=r.jobs)||void 0===s?void 0:s.nodes)&&void 0!==i?i:[];return l(e,o)}},HDPV:function(e,t,i){"use strict";i.d(t,"l",(function(){return b})),i.d(t,"i",(function(){return y})),i.d(t,"d",(function(){return k})),i.d(t,"j",(function(){return S})),i.d(t,"k",(function(){return _})),i.d(t,"m",(function(){return N})),i.d(t,"b",(function(){return D})),i.d(t,"h",(function(){return C})),i.d(t,"c",(function(){return O})),i.d(t,"g",(function(){return I})),i.d(t,"f",(function(){return T})),i.d(t,"e",(function(){return j})),i.d(t,"a",(function(){return V}));i("uHfJ"),i("R0RX"),i("ujLG"),i("3R5X"),i("HaUQ"),i("h8Et");var n=i("Zqnx"),a=i.n(n),r=i("lKw0"),s=i.n(r),l=i("RwX1"),o=i("aPPG"),d=i("ZMYx"),c=i("oj/M"),u=i("t9l/"),m=i("Wrl+");const v=function(e){return Object.entries(e).map((function(e){let[t,i]=e;return{id:t.toUpperCase(),name:i}}))},p=Object(u.g)("SecurityReports|Tool"),f=Object(u.g)("ciReport|All tools"),g=v(d.i),h=g.filter((function(e){return["DETECTED","CONFIRMED"].includes(e.id)})),b={name:Object(u.g)("SecurityReports|Status"),id:"state",options:g,allOption:{id:"all",name:Object(u.g)("VulnerabilityStatusTypes|All statuses")},defaultOptions:h},y={name:Object(u.g)("SecurityReports|Severity"),id:"severity",options:v(l.i),allOption:{name:Object(u.g)("ciReport|All severities")},defaultOptions:[]},k=function(e,t){return{id:`${e}.${t.toUpperCase()}`,reportType:t.toUpperCase(),name:Object(o.a)(t),scannerIds:[]}},S={name:p,id:"reportType",options:v(l.h),allOption:{name:f},defaultOptions:[]},_={name:p,id:"reportType",options:v(l.g),allOption:{name:f},defaultOptions:[]},N={name:p,id:"scanner",options:Object.keys(l.h).map((function(e){return k(m.b,e)})),allOption:{name:f},defaultOptions:[]},E={NO_ACTIVITY:{id:"NO_ACTIVITY",name:Object(u.g)("SecurityReports|No activity")},WITH_ISSUES:{id:"WITH_ISSUES",name:Object(u.g)("SecurityReports|With issues")},NO_LONGER_DETECTED:{id:"NO_LONGER_DETECTED",name:Object(u.g)("SecurityReports|No longer detected")}},D={name:Object(u.g)("Reports|Activity"),id:"activity",options:Object.values(E),allOption:{name:Object(u.g)("SecurityReports|All activity")},defaultOptions:[]},C={name:Object(u.g)("SecurityReports|Project"),id:"projectId",options:[],allOption:{name:Object(u.g)("ciReport|All projects")},defaultOptions:[]},O={name:Object(u.g)("SecurityReports|Cluster"),id:"cluster",options:[],allOption:{name:Object(u.g)("ciReport|All clusters")},defaultOptions:[]},I={name:Object(u.g)("SecurityReports|Image"),id:"image",options:[],allOption:{name:Object(u.g)("ciReport|All images")},defaultOptions:[]},T=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!a()(e))return[];const t=Object(c.k)(e),i=Object.entries(t),n=i.filter((function(e){let[,t]=e;return void 0!==(null==t?void 0:t.vulnerabilitiesCount)})),r=n.map((function(e){let[t,i]=e;const n=l.e[t];return n?[n,i]:null}));return r.filter((function(e){return null!==e}))},j=function(e){const t=s()(e,"reportType");return Object.entries(l.h).map((function(e){let[i,n]=e;const a=i.toUpperCase();return{id:a,reportType:a,name:n,disabled:(t[a]||[]).length<=0}}))},V=Object(u.a)("An error occurred while retrieving projects.")},K0dZ:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"agentImages"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"agentName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"clusterAgent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"agentName"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilityImages"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:238}};i.loc.source={body:"query agentImages($agentName: String!, $projectPath: ID!) {\n  project(fullPath: $projectPath) {\n    id\n    clusterAgent(name: $agentName) {\n      id\n      vulnerabilityImages {\n        nodes {\n          name\n        }\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.agentImages=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"agentImages")},K1pz:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"instanceVulnerabilities"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"20"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"severity"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitySeverity"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportType"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityReportType"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scanner"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scannerId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitiesScannerID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"state"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityState"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sort"}},type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitySort"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"vetEnabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clusterAgentId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClustersAgentID"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilities"},arguments:[{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"severity"},value:{kind:"Variable",name:{kind:"Name",value:"severity"}}},{kind:"Argument",name:{kind:"Name",value:"reportType"},value:{kind:"Variable",name:{kind:"Name",value:"reportType"}}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"Variable",name:{kind:"Name",value:"state"}}},{kind:"Argument",name:{kind:"Name",value:"projectId"},value:{kind:"Variable",name:{kind:"Name",value:"projectId"}}},{kind:"Argument",name:{kind:"Name",value:"scanner"},value:{kind:"Variable",name:{kind:"Name",value:"scanner"}}},{kind:"Argument",name:{kind:"Name",value:"scannerId"},value:{kind:"Variable",name:{kind:"Name",value:"scannerId"}}},{kind:"Argument",name:{kind:"Name",value:"sort"},value:{kind:"Variable",name:{kind:"Name",value:"sort"}}},{kind:"Argument",name:{kind:"Name",value:"hasIssues"},value:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}}},{kind:"Argument",name:{kind:"Name",value:"hasResolution"},value:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}}},{kind:"Argument",name:{kind:"Name",value:"clusterAgentId"},value:{kind:"Variable",name:{kind:"Name",value:"clusterAgentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilityFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PageInfo"},directives:[]}]}}]}}]}}],loc:{start:0,end:1008}};n.loc.source={body:'#import "../fragments/vulnerability.fragment.graphql"\n#import "~/graphql_shared/fragments/page_info.fragment.graphql"\n\nquery instanceVulnerabilities(\n  $before: String\n  $after: String\n  $first: Int = 20\n  $last: Int\n  $projectId: [ID!]\n  $severity: [VulnerabilitySeverity!]\n  $reportType: [VulnerabilityReportType!]\n  $scanner: [String!]\n  $scannerId: [VulnerabilitiesScannerID!]\n  $state: [VulnerabilityState!]\n  $sort: VulnerabilitySort\n  $hasIssues: Boolean\n  $hasResolution: Boolean\n  $vetEnabled: Boolean = false\n  $clusterAgentId: [ClustersAgentID!]\n) {\n  vulnerabilities(\n    before: $before\n    after: $after\n    first: $first\n    last: $last\n    severity: $severity\n    reportType: $reportType\n    state: $state\n    projectId: $projectId\n    scanner: $scanner\n    scannerId: $scannerId\n    sort: $sort\n    hasIssues: $hasIssues\n    hasResolution: $hasResolution\n    clusterAgentId: $clusterAgentId\n  ) {\n    nodes {\n      ...VulnerabilityFragment\n    }\n    pageInfo {\n      ...PageInfo\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)}))}n.definitions=n.definitions.concat(r(i("B9Cy").definitions)),n.definitions=n.definitions.concat(r(i("IVfO").definitions));var s={};function l(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),s[e.name.value]=t}})),e.exports=n,e.exports.instanceVulnerabilities=function(e,t){var i={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=s[t]||new Set,a=new Set,r=new Set;for(n.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(t){var n=l(e,t);n&&i.definitions.push(n)})),i}(n,"instanceVulnerabilities")},KE9z:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getSecurityReportFinding"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectFullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pipelineIid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"findingUuid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectFullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pipeline"},arguments:[{kind:"Argument",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"pipelineIid"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"securityReportFinding"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uuid"},value:{kind:"Variable",name:{kind:"Name",value:"findingUuid"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uuid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"descriptionHtml"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"severity"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"solution"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reportType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"falsePositive"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mergeRequest"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"remediations"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diff"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"summary"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"scanner"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"assets"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"project"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nameWithNamespace"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationSast"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startLine"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endLine"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blobPath"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationDependencyScanning"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blobPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationSecretDetection"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startLine"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endLine"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blobPath"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityLocationCoverageFuzzing"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startLine"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endLine"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blobPath"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"links"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"identifiers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"issueLinks"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"linkType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"issue"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"iid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"author"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FileLocation"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Url"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Diff"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Code"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Commit"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"List"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Int"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Boolean"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ModuleLocation"},directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:2041}};n.loc.source={body:'#import "../fragments/vulnerability_detail.fragment.graphql"\n\nquery getSecurityReportFinding($projectFullPath: ID!, $pipelineIid: ID!, $findingUuid: String!) {\n  project(fullPath: $projectFullPath) {\n    id\n    pipeline(iid: $pipelineIid) {\n      id\n      securityReportFinding(uuid: $findingUuid) {\n        uuid\n        title\n        description\n        descriptionHtml\n        state\n        severity\n        solution\n        reportType\n        falsePositive\n        mergeRequest {\n          id\n        }\n        remediations {\n          diff\n          summary\n        }\n        scanner {\n          id\n          name\n        }\n        assets {\n          name\n          url\n        }\n        project {\n          id\n          name\n          webUrl\n          nameWithNamespace\n        }\n        location {\n          ... on VulnerabilityLocationSast {\n            startLine\n            endLine\n            file\n            blobPath\n          }\n          ... on VulnerabilityLocationDependencyScanning {\n            blobPath\n            file\n          }\n          ... on VulnerabilityLocationSecretDetection {\n            startLine\n            endLine\n            file\n            blobPath\n          }\n          ... on VulnerabilityLocationCoverageFuzzing {\n            startLine\n            endLine\n            file\n            blobPath\n          }\n        }\n        links {\n          name\n          url\n        }\n        identifiers {\n          name\n          url\n        }\n        issueLinks {\n          nodes {\n            id\n            linkType\n            issue {\n              id\n              iid\n              createdAt\n              webUrl\n              author {\n                id\n                webUrl\n                name\n                username\n              }\n            }\n          }\n        }\n        details {\n          ...FileLocation\n          ...Url\n          ...Diff\n          ...Code\n          ...Commit\n          ...List\n          ...Int\n          ...Boolean\n          ...ModuleLocation\n        }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};n.definitions=n.definitions.concat(i("qKmR").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)})));var r={};function s(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),r[e.name.value]=t}})),e.exports=n,e.exports.getSecurityReportFinding=function(e,t){var i={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=r[t]||new Set,a=new Set,l=new Set;for(n.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(r[e]||new Set).forEach((function(e){l.add(e)})))}))}return a.forEach((function(t){var n=s(e,t);n&&i.definitions.push(n)})),i}(n,"getSecurityReportFinding")},MNkS:function(e,t,i){"use strict";i("h8Et");var n=i("VYQf"),a=i("oj/M"),r=(i("uHfJ"),i("R0RX"),i("Etn4")),s=i("Fj12"),l=i("hY08"),o=i("RwX1"),d=i("teVv"),c=i("t9l/"),u=i("+w6P"),m=i.n(u),v=i("cRBX"),p={components:{GlCard:r.a,GlSkeletonLoader:s.a,SeverityBadge:l.a},inject:["fullPath","dashboardType"],props:{filters:{type:Object,required:!1,default:null}},data:()=>({counts:{}}),apollo:{counts:{query:m.a,errorPolicy:"none",variables(){return{fullPath:this.fullPath,isProject:this.dashboardType===o.a.PROJECT,isGroup:this.dashboardType===o.a.GROUP,isInstance:this.dashboardType===o.a.INSTANCE,...this.filters}},update(e){return e[this.dashboardType].vulnerabilitySeveritiesCount},error(){Object(d.createAlert)({message:Object(c.g)("SecurityReports|Error fetching the vulnerability counts. Please check your network connection and try again.")})},skip(){return!this.filters}}},computed:{isLoadingCounts(){return!this.filters||this.$apollo.queries.counts.loading},severityCounts(){var e=this;return v.c.map((function(t){return{severity:t,count:e.counts[t]||0}}))}},watch:{severityCounts(){this.$emit("counts-changed",this.severityCounts)}}},f=i("bPvS"),g=Object(f.a)(p,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vulnerability-counts gl-font-weight-bold gl-text-center"},e._l(e.severityCounts,(function(t){var n=t.severity,a=t.count;return i("gl-card",{key:n,attrs:{"data-testid":n,"header-class":"gl-p-3","body-class":"gl--flex-center"},scopedSlots:e._u([{key:"header",fn:function(){return[i("severity-badge",{staticClass:"gl-text-center!",attrs:{severity:n}})]},proxy:!0},{key:"default",fn:function(){return[e.isLoadingCounts?i("gl-skeleton-loader",{attrs:{"equal-width-lines":!0,lines:1}}):i("span",{staticClass:"gl-font-size-h2"},[e._v(e._s(a))])]},proxy:!0}],null,!0)})})),1)}),[],!1,null,null,null).exports,h=i("pY+i"),b=i.n(h),y=i("k6qc"),k=i.n(y),S=i("CxXE"),_=i("Zxcm"),N=i("vRHk"),E=i("j8Yr"),D=i("JpoM"),C=(i("ylB9"),i("3R5X"),i("XexO"),i("SXnf"),i("f5Le"),i("TTAZ"),i("W2Di"),i("9gLG"),i("pO+W"),i("DGqX"),i("DuA4"),i("8AuF"),i("bDpz"),i("JbNT"),i("CYm8"),i("s4MS"),i("fDBp"),i("Z+bI"),i("n0qn"),i("JHu5"),i("XUYm"),i("0no1"),i("gdbl"),i("ujLG"),i("HaUQ"),i("OkA1")),O=i("u1ru"),I=i("nPFI"),T=i("Hmw5"),j=i("ly/8"),V=i("B0bW"),L=i("Wrl+"),R={components:{GlEmptyState:V.a},inject:["emptyStateSvgPath"],i18n:{title:Object(c.g)("SecurityReports|No vulnerabilities found"),primaryButtonText:Object(c.g)("SecurityReports|Learn more about setting up your dashboard"),description:Object(c.g)("SecurityReports|Although it's rare to have no vulnerabilities, it can happen. Check your settings to make sure you've set up your dashboard correctly.")},DOC_PATH_SECURITY_CONFIGURATION:L.d},w=Object(f.a)(R,(function(){var e=this.$createElement;return(this._self._c||e)("gl-empty-state",{staticClass:"gl-mt-0",attrs:{title:this.$options.i18n.title,"svg-path":this.emptyStateSvgPath,"primary-button-link":this.$options.DOC_PATH_SECURITY_CONFIGURATION,"primary-button-text":this.$options.i18n.primaryButtonText,description:this.$options.i18n.description}})}),[],!1,null,null,null).exports,x={components:{GlEmptyState:V.a},inject:["noVulnerabilitiesSvgPath"]},P=Object(f.a)(x,(function(){var e=this.$createElement;return(this._self._c||e)("gl-empty-state",{staticClass:"gl-mt-0",attrs:{title:this.s__("SecurityReports|Sorry, your filter produced no results"),"svg-path":this.noVulnerabilitiesSvgPath,description:this.s__("SecurityReports|To widen your search, change or remove filters above")}})}),[],!1,null,null,null).exports,A=i("aPPG"),F=i("BC1l"),$=i("+srj"),q=i("h0pY"),B=i("ZMYx"),M=i("U1Ws"),G=i("F+K/"),U=i("H8gz"),H=i("KFH7");const z={opened:"gl-text-green-500",closed:"gl-text-red-500",merged:"gl-text-blue-500"},Q={opened:"issue-open-m",closed:"issue-close",merged:"merge"};var W={i18n:{AUTO_FIX:Object(c.g)("AutoRemediation|Auto-fix")},components:{GlBadge:G.a,GlIcon:U.a,GlPopover:H.a},props:{mergeRequest:{type:Object,required:!0}},methods:{getIconColor:e=>z[e]||"gl-text-gray-500",getIcon:e=>Q[e]||"issue-open-m"}},J=Object(f.a)(W,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"popover",attrs:{"data-testid":"vulnerability-solutions-bulb"}},[i("gl-badge",{ref:"badge",attrs:{variant:"neutral",icon:"merge-request"}}),e._v(" "),i("gl-popover",{attrs:{"data-testid":"vulnerability-solutions-popover",target:function(){return e.$refs.popover},placement:"top"},scopedSlots:e._u([{key:"title",fn:function(){return[i("span",[e._v(e._s(e.s__("AutoRemediation| 1 Merge Request")))])]},proxy:!0}])},[e._v(" "),i("ul",{staticClass:"gl-list-style-none gl-pl-0 gl-mb-0"},[i("li",{staticClass:"gl-align-items-center gl-display-flex gl-mb-2"},[i("gl-icon",{class:e.getIconColor(e.mergeRequest.state),attrs:{"data-testid":"vulnerability-solutions-popover-icon",name:e.getIcon(e.mergeRequest.state),size:16}}),e._v(" "),i("a",{staticClass:"gl-ml-3",attrs:{"data-testid":"vulnerability-solutions-popover-link",href:e.mergeRequest.webUrl}},[i("span",{attrs:{"data-testid":"vulnerability-solutions-popover-link-id"}},[e._v("!"+e._s(e.mergeRequest.iid)),e.mergeRequest.securityAutoFix?i("span",{attrs:{"data-testid":"vulnerability-solutions-popover-link-autofix"}},[e._v(e._s(": "+e.$options.i18n.AUTO_FIX))]):e._e()])])],1)])])],1)}),[],!1,null,null,null).exports,Y=i("mTTo"),X={components:{GlBadge:G.a,GlPopover:H.a,IssueLink:Y.a},props:{issues:{type:Array,required:!0},isJira:{type:Boolean,required:!1,default:!1}},computed:{numberOfIssues(){return this.issues.length},popoverTitle(){return Object(c.f)("1 Issue","%d Issues",this.numberOfIssues)},issueBadgeEl(){var e=this;return function(){var t;return null===(t=e.$refs.issueBadge)||void 0===t?void 0:t.$el}}}},K=Object(f.a)(X,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"gl-display-inline-block"},[i("gl-badge",{ref:"issueBadge",staticClass:"gl-px-3",attrs:{icon:"issues"}},[e._v("\n    "+e._s(e.numberOfIssues)+"\n  ")]),e._v(" "),i("gl-popover",{ref:"popover",attrs:{target:e.issueBadgeEl,placement:"top"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("\n      "+e._s(e.popoverTitle)+"\n    ")]},proxy:!0}])},[e._v(" "),i("ul",{staticClass:"gl-list-style-none gl-p-0 gl-m-0"},e._l(e.issues,(function(t){var n=t.issue;return i("li",{key:n.iid},[i("issue-link",{attrs:{issue:n,"is-jira":e.isJira}})],1)})),0)])],1)}),[],!1,null,null,null).exports,Z={components:{GlIcon:U.a,GlLink:O.a},directives:{GlTooltip:j.a},props:{vulnerability:{type:Object,required:!0}}},ee=Object(f.a)(Z,(function(){var e=this.$createElement,t=this._self._c||e;return t("gl-link",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:this.s__("Vulnerability|Comments"),expression:"s__('Vulnerability|Comments')"}],staticClass:"gl-display-inline-flex gl-align-items-center gl-ml-3 gl-flex-shrink-0 gl-text-body",attrs:{href:this.vulnerability.vulnerabilityPath,"data-testid":"vulnerability-comments-"+this.vulnerability.id}},[t("gl-icon",{attrs:{name:"comment"}})],1)}),[],!1,null,null,null).exports,te=i("E4+D"),ie={name:"VulnerabilityPath",components:{GlLink:O.a,GlTruncate:te.a},props:{location:{type:Object,required:!0,default:function(){return{}}}},computed:{fileUrl(){const{startLine:e,endLine:t,blobPath:i}=this.location,n=t>e?`${e}-${t}`:e;return i?`${i}${n?"#L"+n:""}`:""},locationString(){const{image:e,file:t,startLine:i,path:n}=this.location;return e||(t&&i?`${t}:${i}`:n&&!t?n:t)},hasBlobPath(){return Boolean(this.location.blobPath)},shouldShowVulnerabilityPath(){return Boolean(this.locationString)}}},ne=Object(f.a)(ie,(function(){var e=this.$createElement,t=this._self._c||e;return this.shouldShowVulnerabilityPath?t("div",[this.hasBlobPath?t("gl-link",{attrs:{href:this.fileUrl}},[t("gl-truncate",{attrs:{text:this.locationString,position:"middle"}})],1):t("gl-truncate",{attrs:{text:this.locationString,position:"middle"}})],1):this._e()}),[],!1,null,null,null).exports,ae=i("Cbzh"),re=i("cuRJ"),se=i("Q04j"),le=i("OkMp"),oe=i("0X+3"),de=i("SYh6"),ce=Object(de.a)(),ue=i("LuMo"),me={components:{GlCollapse:ae.a,GlButton:re.a,GlAlert:se.a,GlDropdown:le.a,GlDropdownItem:oe.a,GlSprintf:I.a},inject:["vulnerabilitiesQuery"],props:{selectedVulnerabilities:{type:Array,required:!0},visible:{type:Boolean,required:!1,default:!1}},data:()=>({isSubmitting:!1,updateErrorText:null,selectedStatus:null}),computed:{statusDropdownText(){var e;return(null===(e=this.selectedStatus)||void 0===e?void 0:e.dropdownText)||this.$options.i18n.statusDropdownPlaceholder}},methods:{updateStatus(e){this.selectedStatus=e},resetSelected(){this.$emit("cancel-selection")},handleSubmit(){var e=this;this.isSubmitting=!0,this.updateErrorText=null;let t=0;const i=[],n=this.selectedVulnerabilities.map((function(n){return e.$apollo.mutate({mutation:e.selectedStatus.mutation,variables:{id:n.id,...e.selectedStatus.payload},refetchQueries:[e.vulnerabilitiesQuery],awaitRefetchQueries:!0}).then((function(i){var a;let{data:r}=i;const[s]=Object.keys(r);if((null===(a=r[s].errors)||void 0===a?void 0:a.length)>0)throw r[s].errors;t+=1,e.$emit("vulnerability-updated",n.id)})).catch((function(){i.push(n.id.split("/").pop())}))}));return Promise.all(n).then((function(){e.isSubmitting=!1,t>0&&(Object(ue.a)(e.$options.i18n.statusChanged(e.selectedStatus.action,t)),ce.$emit("vulnerabilities-updated",e)),i.length>0&&(e.updateErrorText=e.$options.i18n.vulnerabilitiesUpdateFailed(i.join(", ")))}))}},i18n:{cancel:Object(c.a)("Cancel"),selected:Object(c.g)("SecurityReports|%{count} Selected"),statusDropdownPlaceholder:Object(c.g)("SecurityReports|Set status"),changeStatus:Object(c.g)("SecurityReports|Change status"),statusChanged:function(e,t){return{confirm:Object(c.f)("%d vulnerability set to confirmed","%d vulnerabilities set to confirmed",t),resolve:Object(c.f)("%d vulnerability set to resolved","%d vulnerabilities set to resolved",t),dismiss:Object(c.f)("%d vulnerability set to dismissed","%d vulnerabilities set to dismissed",t),revert:Object(c.f)("%d vulnerability set to needs triage","%d vulnerabilities set to needs triage",t)}[e]},vulnerabilitiesUpdateFailed:function(e){return Object(c.g)("SecurityReports|Failed updating vulnerabilities with the following IDs: "+e)}},VULNERABILITY_STATE_OBJECTS:B.j},ve=Object(f.a)(me,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-collapse",{attrs:{visible:e.visible}},[i("div",{staticClass:"card",class:{"with-error":Boolean(e.updateErrorText)}},[e.updateErrorText?i("gl-alert",{attrs:{variant:"danger",dismissible:!1}},[e._v("\n      "+e._s(e.updateErrorText)+"\n    ")]):e._e(),e._v(" "),i("form",{staticClass:"card-body gl-display-flex gl-align-items-center",on:{submit:function(t){return t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[i("div",[i("gl-sprintf",{attrs:{message:e.$options.i18n.selected},scopedSlots:e._u([{key:"count",fn:function(){return[i("span",{staticClass:"gl-font-weight-bold"},[e._v(e._s(e.selectedVulnerabilities.length))])]},proxy:!0}])})],1),e._v(" "),i("gl-dropdown",{staticClass:"gl-ml-6 gl-mr-4 gl-pl-6 gl-border-l",attrs:{"data-qa-selector":"vulnerability_card_status_dropdown",text:e.statusDropdownText,disabled:e.isSubmitting}},e._l(e.$options.VULNERABILITY_STATE_OBJECTS,(function(t){return i("gl-dropdown-item",{key:t.action,attrs:{"data-qa-selector":"item_status_"+t.action,"data-testid":t.action,"is-checked":t===e.selectedStatus,"is-check-item":""},on:{click:function(i){return e.updateStatus(t)}}},[i("div",{staticClass:"gl-font-weight-bold"},[e._v(e._s(t.dropdownText))]),e._v(" "),i("div",[e._v(e._s(t.dropdownDescription))])])})),1),e._v(" "),e.selectedStatus?[i("gl-button",{staticClass:"gl-ml-auto gl-mr-4",attrs:{type:"button",disabled:e.isSubmitting},on:{click:e.resetSelected}},[e._v("\n          "+e._s(e.$options.i18n.cancel)+"\n        ")]),e._v(" "),i("gl-button",{attrs:{"data-qa-selector":"change_status_button",type:"submit",variant:"confirm",loading:e.isSubmitting}},[e._v("\n          "+e._s(e.$options.i18n.changeStatus)+"\n        ")])]:e._e()],2)],1)])}),[],!1,null,null,null).exports,pe=i("e2Sm"),fe={components:{GlFormCheckbox:C.a,GlLink:O.a,GlSkeletonLoader:s.a,GlSprintf:I.a,GlTable:T.a,IssuesBadge:K,AutoFixHelpText:J,RemediatedBadge:q.a,FalsePositiveBadge:$.a,SelectionSummary:ve,SeverityBadge:l.a,VulnerabilityCommentIcon:ee,VulnerabilityPath:ne,FiltersProducedNoResults:P,DashboardHasNoVulnerabilities:w,Portal:n.Portal},directives:{GlTooltip:j.a},inject:{hasVulnerabilities:{default:!1},canAdminVulnerability:{default:!1},hasJiraVulnerabilitiesIntegrationEnabled:{default:!1}},props:{fields:{type:Array,required:!0},vulnerabilities:{type:Array,required:!0},isLoading:{type:Boolean,required:!1,default:!1},shouldShowProjectNamespace:{type:Boolean,required:!1,default:!1},portalName:{type:String,required:!0},pageSize:{type:Number,required:!0},sort:{type:Object,required:!1,default:function(){return{sortBy:pe.a.SEVERITY.key,sortDesc:!0}}}},data:()=>({selectedVulnerabilities:{}}),computed:{displayFields(){return this.canAdminVulnerability?[pe.a.CHECKBOX,...this.fields]:this.fields},hasAnyScannersOtherThanGitLab(){return this.vulnerabilities.some((function(e){var t,i;return"GitLab"!==(null===(t=e.scanner)||void 0===t?void 0:t.vendor)&&""!==(null===(i=e.scanner)||void 0===i?void 0:i.vendor)}))},hasSelectedSomeVulnerabilities(){return this.numOfSelectedVulnerabilities>0&&!this.hasSelectedAllVulnerabilities},hasSelectedAllVulnerabilities(){return!!this.vulnerabilities.length&&this.numOfSelectedVulnerabilities===this.vulnerabilities.length},numOfSelectedVulnerabilities(){return Object.keys(this.selectedVulnerabilities).length},shouldShowSelectionSummary(){return this.numOfSelectedVulnerabilities>0}},watch:{vulnerabilities(){var e=this;const t=new Set(this.vulnerabilities.map((function(e){return e.id})));Object.keys(this.selectedVulnerabilities).forEach((function(i){t.has(i)||e.$delete(e.selectedVulnerabilities,i)}))}},methods:{hasCluster(e){var t;return null===(t=e.location.kubernetesResource)||void 0===t?void 0:t.agent},clusterName(e){var t,i;return null===(t=e.location.kubernetesResource)||void 0===t||null===(i=t.agent)||void 0===i?void 0:i.name},clusterUrl(e){var t,i;return null===(t=e.location.kubernetesResource)||void 0===t||null===(i=t.agent)||void 0===i?void 0:i.webPath},deselectVulnerability(e){this.$delete(this.selectedVulnerabilities,e)},deselectAllVulnerabilities(){this.selectedVulnerabilities={}},extraIdentifierCount:e=>e.length-1,primaryIdentifier:e=>Object(F.a)(e,"externalType"),isSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Boolean(this.selectedVulnerabilities[e.id])},selectAllVulnerabilities(){this.selectedVulnerabilities=this.vulnerabilities.reduce((function(e,t){return e[t.id]=t,e}),{})},shouldShowExtraIdentifierCount:e=>(null==e?void 0:e.length)>1,toggleAllVulnerabilities(){this.hasSelectedAllVulnerabilities?this.deselectAllVulnerabilities():this.selectAllVulnerabilities()},toggleVulnerability(e){this.canAdminVulnerability&&(this.selectedVulnerabilities[e.id]?this.$delete(this.selectedVulnerabilities,""+e.id):this.$set(this.selectedVulnerabilities,""+e.id,e))},gitlabIssues(e){var t;return(null===(t=e.issueLinks)||void 0===t?void 0:t.nodes)||[]},externalIssues(e){var t;return(null===(t=e.externalIssueLinks)||void 0===t?void 0:t.nodes)||[]},jiraIssues(e){return this.externalIssues(e).filter((function(e){let{issue:t}=e;return"jira"===(null==t?void 0:t.externalTracker)}))},badgeIssues(e){return this.hasJiraVulnerabilitiesIntegrationEnabled?this.jiraIssues(e):this.gitlabIssues(e)},formatDate:e=>Object(M.q)(e.detectedAt,"yyyy-mm-dd"),formatDateTooltip:e=>Object(M.q)(e.detectedAt),hasComments:e=>e.userNotesCount>0,useConvertReportType:e=>Object(A.a)(e),handleSortChange(e){let{sortBy:t,sortDesc:i}=e;this.$emit("update:sort",{sortBy:t,sortDesc:i})},getVulnerabilityState(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase();return B.i[e]||e}}},ge=Object(f.a)(fe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("portal",{attrs:{to:e.portalName}},[i("selection-summary",{attrs:{"selected-vulnerabilities":Object.values(e.selectedVulnerabilities),visible:e.shouldShowSelectionSummary},on:{"cancel-selection":e.deselectAllVulnerabilities,"vulnerability-updated":e.deselectVulnerability}})],1),e._v(" "),i("gl-table",{staticClass:"vulnerability-list",attrs:{busy:e.isLoading,fields:e.displayFields,items:e.vulnerabilities,"thead-class":{"below-selection-summary":e.shouldShowSelectionSummary},"sort-desc":e.sort.sortDesc,"sort-by":e.sort.sortBy,"sort-direction":"last","sort-icon-left":"","no-local-sorting":"","no-sort-reset":"",stacked:"sm","show-empty":"",responsive:"",hover:"","primary-key":"id","tbody-tr-class":{"gl-cursor-pointer":e.canAdminVulnerability},"head-variant":"white"},on:{"sort-changed":e.handleSortChange,"row-clicked":e.toggleVulnerability},scopedSlots:e._u([{key:"head(checkbox)",fn:function(){return[i("gl-form-checkbox",{staticClass:"gl-display-table-cell",attrs:{"data-qa-selector":"vulnerability_report_checkbox_all","data-testid":"vulnerability-checkbox-all",checked:e.hasSelectedAllVulnerabilities,indeterminate:e.hasSelectedSomeVulnerabilities},on:{change:e.toggleAllVulnerabilities}})]},proxy:!0},{key:"cell(checkbox)",fn:function(t){var n=t.item;return[i("gl-form-checkbox",{staticClass:"gl-pointer-events-none gl-display-table-cell",attrs:{"data-testid":"vulnerability-checkbox",checked:e.isSelected(n)},on:{change:function(t){return e.toggleVulnerability(n)}}})]}},{key:"cell(detected)",fn:function(t){var n=t.item;return[i("time",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],attrs:{"data-testid":"detected-"+n.id,title:e.formatDateTooltip(n)}},[e._v("\n        "+e._s(e.formatDate(n))+"\n      ")])]}},{key:"cell(state)",fn:function(t){var n=t.item;return[i("span",{staticClass:"text-capitalize js-status",attrs:{"data-qa-selector":"vulnerability_status_content","data-qa-status-description":n.title||n.name}},[e._v(e._s(e.getVulnerabilityState(n.state))+"\n      ")])]}},{key:"cell(severity)",fn:function(e){var t=e.item;return[i("severity-badge",{staticClass:"js-severity",attrs:{severity:t.severity}})]}},{key:"cell(title)",fn:function(t){var n=t.item;return[i("div",{staticClass:"gl-display-flex gl-flex-direction-column flex-sm-row gl-align-items-end align-items-sm-center",attrs:{"data-testid":"title-"+n.id}},[i("gl-link",{staticClass:"gl-text-body vulnerability-title js-description",attrs:{href:n.vulnerabilityPath,"data-qa-vulnerability-description":n.title||n.name,"data-qa-selector":"vulnerability"},on:{click:function(t){return e.$emit("vulnerability-clicked",n)}}},[e._v("\n          "+e._s(n.title||n.name)+"\n        ")]),e._v(" "),e.hasComments(n)?i("vulnerability-comment-icon",{attrs:{vulnerability:n}}):e._e()],1),e._v(" "),n.location?i("div",{staticClass:"gl-text-color-secondary gl-font-sm",attrs:{"data-testid":"location-"+n.id}},[e.shouldShowProjectNamespace?i("div",[e._v("\n          "+e._s(n.project.nameWithNamespace)+"\n        ")]):e._e(),e._v(" "),i("vulnerability-path",{attrs:{location:n.location}})],1):e._e()]}},{key:"cell(identifier)",fn:function(t){var n=t.item;return[i("div",{attrs:{"data-testid":"vulnerability-identifier"}},[e._v("\n        "+e._s(e.primaryIdentifier(n.identifiers))+"\n      ")]),e._v(" "),e.shouldShowExtraIdentifierCount(n.identifiers)?i("div",{staticClass:"gl-text-gray-300",attrs:{"data-testid":"vulnerability-more-identifiers"}},[i("gl-sprintf",{attrs:{message:e.__("+ %{count} more")},scopedSlots:e._u([{key:"count",fn:function(){return[e._v("\n            "+e._s(e.extraIdentifierCount(n.identifiers))+"\n          ")]},proxy:!0}],null,!0)})],1):e._e()]}},{key:"cell(reportType)",fn:function(t){var n=t.item;return[i("div",{class:{"text-capitalize":"GENERIC"!==n.reportType},attrs:{"data-testid":"vulnerability-report-type"}},[e._v("\n        "+e._s(e.useConvertReportType(n.reportType))+"\n      ")]),e._v(" "),e.hasAnyScannersOtherThanGitLab&&n.scanner?i("div",{staticClass:"gl-text-gray-300",attrs:{"data-testid":"vulnerability-vendor"}},[e._v("\n        "+e._s(n.scanner.vendor)+"\n      ")]):e._e()]}},{key:"cell(cluster)",fn:function(t){var n=t.item;return[e.hasCluster(n)?i("gl-link",{attrs:{"data-testid":"cluster-"+n.id,href:e.clusterUrl(n)}},[e._v("\n        "+e._s(e.clusterName(n))+"\n      ")]):e._e()]}},{key:"cell(activity)",fn:function(t){var n=t.item;return[i("div",{staticClass:"gl-display-flex gl-justify-content-end"},[n.mergeRequest?i("auto-fix-help-text",{attrs:{"merge-request":n.mergeRequest}}):e._e(),e._v(" "),e.badgeIssues(n).length>0?i("issues-badge",{attrs:{issues:e.badgeIssues(n),"is-jira":e.hasJiraVulnerabilitiesIntegrationEnabled,"data-qa-selector":"vulnerability_issue_created_badge_content","data-qa-badge-description":n.title||n.name}}):e._e(),e._v(" "),n.falsePositive?i("false-positive-badge",{staticClass:"gl-ml-3",attrs:{"data-qa-selector":"false_positive_vulnerability"}}):e._e(),e._v(" "),n.resolvedOnDefaultBranch?i("remediated-badge",{staticClass:"gl-ml-3",attrs:{"data-qa-selector":"vulnerability_remediated_badge_content","data-qa-activity-description":n.title||n.name}}):e._e()],1)]}},{key:"table-busy",fn:function(){return e._l(e.pageSize,(function(e){return i("gl-skeleton-loader",{key:e,attrs:{lines:2}})}))},proxy:!0},{key:"empty",fn:function(){return[e.hasVulnerabilities?i("filters-produced-no-results",{staticClass:"gl-cursor-default"}):i("dashboard-has-no-vulnerabilities",{staticClass:"gl-cursor-default"})]},proxy:!0}])})],1)}),[],!1,null,null,null).exports;const he={[o.a.PROJECT]:"project.vulnerabilities",[o.a.GROUP]:"group.vulnerabilities",[o.a.INSTANCE]:"vulnerabilities",[o.a.PIPELINE]:"project.pipeline.securityReportFindings"};var be={components:{VulnerabilityList:ge,GlKeysetPagination:S.a,PageSizeSelector:D.a,LocalStorageSync:E.a},mixins:[Object(_.a)()],inject:{dashboardType:"dashboardType",vulnerabilitiesQuery:"vulnerabilitiesQuery",fullPath:"fullPath",canViewFalsePositive:{default:!1},hasJiraVulnerabilitiesIntegrationEnabled:{default:!1},pipeline:{default:{}}},props:{filters:{type:Object,required:!1,default:null},fields:{type:Array,required:!0},showProjectNamespace:{type:Boolean,required:!1,default:!1},portalName:{type:String,required:!0}},data(){var e;return{vulnerabilities:[],pageInfo:{},initialBefore:this.$route.query.before,pageSize:Number(null!==(e=localStorage.getItem("vulnerability_list_page_size"))&&void 0!==e?e:20)}},apollo:{vulnerabilities:{query(){return this.vulnerabilitiesQuery},context:{isSingleRequest:!0},errorPolicy:"none",variables(){return this.queryVariables},update(e){const t=this.getVulnerabilitiesFromData(e);return this.pageInfo=t.pageInfo,t.nodes},error(){Object(d.createAlert)({message:Object(c.g)("SecurityReports|Error fetching the vulnerability list. Please check your network connection and try again.")})},skip(){return!this.filters}}},computed:{before:{get(){return this.after?void 0:this.$route.query.before},set(e){e!==this.before&&this.pushQuerystring({before:e,after:void 0})}},after:{get(){return this.$route.query.after},set(e){e!==this.after&&this.pushQuerystring({before:void 0,after:e})}},sort:{get(){return{sortBy:this.$route.query.sortBy||pe.a.SEVERITY.key,sortDesc:!this.$route.query.sortDesc||Object(a.G)(this.$route.query.sortDesc)}},set(e){let{sortBy:t,sortDesc:i}=e;this.pushQuerystring({sortBy:t,sortDesc:i})}},isLoadingVulnerabilities(){return this.$apollo.queries.vulnerabilities.loading},queryVariables(){return{fullPath:this.fullPath,sort:`${Object(N.i)(this.sort.sortBy)}_${this.sort.sortDesc?"desc":"asc"}`,vetEnabled:this.canViewFalsePositive,includeExternalIssueLinks:this.hasJiraVulnerabilitiesIntegrationEnabled,pipelineId:this.pipeline.iid,first:this.before?null:this.pageSize,last:this.before?this.pageSize:null,before:this.before,after:this.after,...this.filters}}},watch:{filters(e,t){null!==t&&this.resetPaging()},sort(e,t){e.sortBy===t.sortBy&&e.sortDesc===t.sortDesc||this.resetPaging()},queryVariables(e,t){b()(e,t)||this.$emit("query-variables-changed",e)}},methods:{getNextPage(){this.after=this.pageInfo.endCursor||this.before},getPrevPage(){this.before=this.pageInfo.startCursor||this.after},resetPaging(){this.before=void 0,this.after=void 0},pushQuerystring(e){this.$router.push({query:{...this.$route.query,...e}})},getVulnerabilitiesFromData(e){return k()(e,he[this.dashboardType])}},PAGE_SIZE_STORAGE_KEY:"vulnerability_list_page_size"},ye=Object(f.a)(be,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("vulnerability-list",{attrs:{"is-loading":e.isLoadingVulnerabilities,vulnerabilities:e.vulnerabilities,fields:e.fields,sort:e.sort,"page-size":e.pageSize,"should-show-project-namespace":e.showProjectNamespace,"portal-name":e.portalName},on:{"update:sort":function(t){e.sort=t},"vulnerability-clicked":function(t){return e.$emit("vulnerability-clicked",t)}}}),e._v(" "),i("div",{staticClass:"gl-text-center gl-mt-6 gl-relative"},[i("gl-keyset-pagination",{attrs:{"has-previous-page":e.pageInfo.hasPreviousPage,"has-next-page":e.pageInfo.hasNextPage,"start-cursor":e.pageInfo.startCursor,"end-cursor":e.pageInfo.endCursor,disabled:e.isLoadingVulnerabilities},on:{next:e.getNextPage,prev:e.getPrevPage}}),e._v(" "),i("local-storage-sync",{attrs:{"storage-key":e.$options.PAGE_SIZE_STORAGE_KEY},model:{value:e.pageSize,callback:function(t){e.pageSize=t},expression:"pageSize"}},[i("page-size-selector",{staticClass:"gl-absolute gl-right-0",model:{value:e.pageSize,callback:function(t){e.pageSize=t},expression:"pageSize"}})],1)],1)],1)}),[],!1,null,null,null).exports,ke=i("s1va"),Se=i.n(ke),_e=i("4pZC"),Ne=i.n(_e),Ee=i("T2ea"),De=i.n(Ee),Ce=i("OqKX"),Oe=i("Gr03"),Ie=i("c/7B"),Te=i("ZKb9"),je=i.n(Te),Ve=i("odnV"),Le=i.n(Ve),Re=(i("XblO"),{props:{querystringKey:{type:String,required:!0},value:{type:Array,required:!0},validValues:{type:Array,required:!1,default:null}},computed:{rawQuerystringIds(){const e=this.$route.query[this.querystringKey]||[];return Array.isArray(e)?e:e.split(",")},querystringIds(){return this.cleanUpIds(this.rawQuerystringIds)},validIds(){return new Set(this.validValues)}},watch:{value(){const e=this.cleanUpIds(this.value);b()(e,this.querystringIds)||this.$router.push({query:this.getQuerystringObject(e)})}},created(){(!b()(this.querystringIds,this.rawQuerystringIds)||Object.hasOwn(this.$route.query,this.querystringKey)&&!this.querystringIds.length)&&this.$router.replace({query:this.getQuerystringObject(this.querystringIds)}),this.emitQuerystringIds(),window.addEventListener("popstate",this.emitQuerystringIds)},destroyed(){window.removeEventListener("popstate",this.emitQuerystringIds)},methods:{emitQuerystringIds(){this.$emit("input",this.querystringIds)},cleanUpIds(e){var t=this;return Le()(e.map((function(e){return null==e?void 0:e.toString().trim()})).filter((function(e){return Boolean(e)&&(!t.validIds.size||t.validIds.has(e))})).sort())},getQuerystringObject(e){return e.length?{...this.$route.query,[this.querystringKey]:e.join(",")}:je()(this.$route.query,this.querystringKey)}},render(){var e,t;return null===(e=(t=this.$scopedSlots).default)||void 0===e?void 0:e.call(t)}}),we=Object(f.a)(Re,void 0,void 0,!1,null,null,null).exports,xe={components:{GlTruncate:te.a},props:{items:{type:Array,required:!0},name:{type:String,required:!0}},computed:{firstItemText(){return this.items[0]||""},additionalItemsCount(){return Math.max(0,this.items.length-1)},qaSelector(){return`filter_${this.name.toLowerCase().replaceAll(" ","_")}_dropdown`}}},Pe=Object(f.a)(xe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"gl-display-flex"},[i("gl-truncate",{staticClass:"gl-min-w-0",attrs:{text:e.firstItemText,"data-qa-selector":e.qaSelector}}),e._v(" "),e.additionalItemsCount?i("span",{staticClass:"gl-ml-2"},[e._v("\n    "+e._s(e.n__("+%d more","+%d more",e.additionalItemsCount))+"\n  ")]):e._e()],1)}),[],!1,null,null,null).exports;const Ae=Object(c.g)("SecurityOrchestration|Failed to load cluster agents."),Fe=Object(c.g)("SecurityOrchestration|Failed to load images."),$e=Object(c.g)("SecurityOrchestration|Failed to load vulnerability scanners."),qe={STILL_DETECTED:{id:"STILL_DETECTED",name:Object(c.g)("SecurityReports|Still detected")},NO_LONGER_DETECTED:{id:"NO_LONGER_DETECTED",name:Object(c.g)("SecurityReports|No longer detected")},HAS_ISSUE:{id:"HAS_ISSUE",name:Object(c.g)("SecurityReports|Has issue")},DOES_NOT_HAVE_ISSUE:{id:"DOES_NOT_HAVE_ISSUE",name:Object(c.g)("SecurityReports|Does not have issue")}},Be=[{header:{name:Object(c.g)("SecurityReports|Detection"),icon:"check-circle-dashed",variant:"info"},items:[qe.STILL_DETECTED,qe.NO_LONGER_DETECTED]},{header:{name:Object(c.g)("SecurityReports|Issue"),icon:"issues"},items:[qe.HAS_ISSUE,qe.DOES_NOT_HAVE_ISSUE]}];var Me={components:{FilterItem:Ie.a,GlDropdown:le.a,GlDropdownDivider:Ce.a,GlDropdownSectionHeader:Oe.a,GlBadge:G.a,QuerystringSync:we,DropdownButtonText:Pe},data:function(){return{selected:[]}},computed:{selectedItemNames(){var e=this;const t=Object.values(qe).filter((function(t){let{id:i}=t;return e.selected.includes(i)}));return t.length?t.map((function(e){let{name:t}=e;return t})):[this.$options.i18n.allItemsText]}},watch:{selected(){let e,t;this.selected.includes(qe.NO_LONGER_DETECTED.id)?e=!0:this.selected.includes(qe.STILL_DETECTED.id)&&(e=!1),this.selected.includes(qe.HAS_ISSUE.id)?t=!0:this.selected.includes(qe.DOES_NOT_HAVE_ISSUE.id)&&(t=!1),this.$emit("filter-changed",{hasResolution:e,hasIssues:t})}},methods:{deselectAll(){this.selected=[]},toggleSelected(e,t){if(this.selected.includes(t))this.selected=De()(this.selected,t);else{const i=e.items.map((function(e){return e.id}));this.selected=De()(this.selected,...i).concat(t)}}},i18n:{label:Object(c.g)("SecurityReports|Activity"),allItemsText:Object(c.g)("SecurityReports|All activity")},GROUPS:Be,ALL_ID:"ALL"},Ge=Object(f.a)(Me,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("querystring-sync",{attrs:{"querystring-key":"activity"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),e._v(" "),i("label",{staticClass:"gl-mb-2"},[e._v(e._s(e.$options.i18n.label))]),e._v(" "),i("gl-dropdown",{attrs:{"header-text":e.$options.i18n.label,block:"","toggle-class":"gl-mb-0","data-qa-selector":"filter_activity_dropdown"},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("dropdown-button-text",{attrs:{items:e.selectedItemNames,name:e.$options.i18n.label}})]},proxy:!0}])},[e._v(" "),i("filter-item",{attrs:{"is-checked":!e.selected.length,text:e.$options.i18n.allItemsText,"data-testid":e.$options.ALL_ID},on:{click:e.deselectAll}}),e._v(" "),e._l(e.$options.GROUPS,(function(t){return[i("gl-dropdown-divider",{key:"divider-"+t.header.name}),e._v(" "),i("gl-dropdown-section-header",{key:"header-"+t.header.name,attrs:{"data-testid":"header-"+t.header.name}},[i("div",{staticClass:"gl--flex-center"},[i("div",{staticClass:"gl-flex-grow-1"},[e._v(e._s(t.header.name))]),e._v(" "),i("gl-badge",{attrs:{icon:t.header.icon,variant:t.header.variant}})],1)]),e._v(" "),e._l(t.items,(function(n){var a=n.id,r=n.name;return i("filter-item",{key:a,attrs:{"is-checked":e.selected.includes(a),text:r,"data-testid":a},on:{click:function(i){return e.toggleSelected(t,a)}}})}))]}))],2)],1)}),[],!1,null,null,null).exports,Ue=i("EghD"),He=i("rEpW");const ze={STILL_DETECTED:{id:"STILL_DETECTED",name:Object(c.g)("SecurityReports|Still detected")},NO_LONGER_DETECTED:{id:"NO_LONGER_DETECTED",name:Object(c.g)("SecurityReports|No longer detected")},HAS_ISSUE:{id:"HAS_ISSUE",name:Object(c.g)("SecurityReports|Has issue")},DOES_NOT_HAVE_ISSUE:{id:"DOES_NOT_HAVE_ISSUE",name:Object(c.g)("SecurityReports|Does not have issue")}},Qe=[{header:{name:Object(c.g)("SecurityReports|Detection"),icon:"check-circle-dashed",variant:"info"},items:[ze.STILL_DETECTED,ze.NO_LONGER_DETECTED]},{header:{name:Object(c.g)("SecurityReports|Issue"),icon:"issues"},items:[ze.HAS_ISSUE,ze.DOES_NOT_HAVE_ISSUE]}];var We={components:{FilterBody:Ue.a,FilterItem:Ie.a,GlDropdownDivider:Ce.a,GlDropdownSectionHeader:Oe.a,GlBadge:G.a},extends:He.a,computed:{options:()=>Object.values(ze),filterObject(){let e,t;return this.isSelected(ze.NO_LONGER_DETECTED)?e=!0:this.isSelected(ze.STILL_DETECTED)&&(e=!1),this.isSelected(ze.HAS_ISSUE)?t=!0:this.isSelected(ze.DOES_NOT_HAVE_ISSUE)&&(t=!1),{hasResolution:e,hasIssues:t}}},methods:{toggleOption(e,t){this.selectedOptions.includes(t)?this.selectedOptions=this.selectedOptions.filter((function(e){return e!==t})):this.selectedOptions=this.selectedOptions.filter((function(t){return!e.items.includes(t)})).concat(t),this.updateQuerystring()}},GROUPS:Qe},Je=Object(f.a)(We,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("filter-body",{attrs:{name:e.filter.name,"selected-options":e.selectedOptionsOrAll}},[i("filter-item",{attrs:{"is-checked":e.isNoOptionsSelected,text:e.filter.allOption.name,"data-testid":"option-"+e.filter.allOption.id},on:{click:e.deselectAllOptions}}),e._v(" "),e._l(e.$options.GROUPS,(function(t){return[i("gl-dropdown-divider",{key:"divider-"+t.header.name}),e._v(" "),i("gl-dropdown-section-header",{key:"header-"+t.header.name,attrs:{"data-testid":"header-"+t.header.name}},[i("div",{staticClass:"gl--flex-center"},[i("div",{staticClass:"gl-flex-grow-1"},[e._v(e._s(t.header.name))]),e._v(" "),i("gl-badge",{attrs:{icon:t.header.icon,variant:t.header.variant}})],1)]),e._v(" "),e._l(t.items,(function(n){return i("filter-item",{key:n.id,attrs:{"is-checked":e.isSelected(n),text:n.name,"data-testid":"option-"+n.id},on:{click:function(i){return e.toggleOption(t,n)}}})}))]}))],2)}),[],!1,null,null,null).exports,Ye=i("pwZD"),Xe=i.n(Ye),Ke=i("c0r3"),Ze=i.n(Ke),et=i("Hoxe"),tt=i.n(et),it=i("zLBL"),nt=i("Ox/j"),at=i("JBkr"),rt=i("JmT7"),st=i("+lve"),lt=i("UFYt"),ot=i.n(lt),dt=i("6K7K"),ct=i.n(dt),ut=i("HDPV");const mt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return{id:Object(st.e)(e.id).toString(),name:e.name}}))};var vt={name:"ProjectFilter",components:{FilterBody:Ue.a,FilterItem:Ie.a,GlDropdownDivider:Ce.a,GlLoadingIcon:it.a,GlDropdownText:nt.a,GlIntersectionObserver:at.a},directives:{SafeHtml:rt.a},extends:He.a,inject:["groupFullPath","dashboardType"],data:function(){return{projectsCache:{},projects:[],pageInfo:{hasNextPage:!0},searchTerm:"",hasDropdownBeenOpened:!1}},computed:{options(){return Object.values(this.projectsCache).filter(Boolean)},selectedSet(){return new Set(this.selectedOptions.map((function(e){return e.id})))},selectableProjects(){var e=this;return this.isSearching?this.projects:this.projects.filter((function(t){return!e.isSelected(t.id)}))},isLoadingProjects(){return this.$apollo.queries.projects.loading},isLoadingProjectsById(){return this.$apollo.queries.projectsById.loading},isSearchTooShort(){return this.isSearching&&this.searchTerm.length<3},isSearching(){return this.searchTerm.length>0},showSelectedProjectsSection(){var e;return Boolean(null===(e=this.selectedOptions)||void 0===e?void 0:e.length)&&!this.isSearching},isMaxProjectsSelected(){var e;return(null===(e=this.selectedOptions)||void 0===e?void 0:e.length)>=100},hasNoResults(){return!this.isLoadingProjects&&this.projects.length<=0},uncachedIds(){var e=this;return(this.querystringIds.includes(this.filter.allOption.id)?[]:this.querystringIds).filter((function(t){return!Ze()(e.projectsCache,t)}))},query(){return this.dashboardType===o.a.GROUP?ot.a:ct.a},shouldShowIntersectionObserver(){return this.pageInfo.hasNextPage&&!this.isLoadingProjects}},apollo:{projectsById:{query(){return this.query},manual:!0,variables(){return{fullPath:this.groupFullPath,pageSize:100,ids:Object(st.d)("Project",this.uncachedIds)}},result(e){var t=this;let{data:i}=e;this.uncachedIds.forEach((function(e){t.$set(t.projectsCache,e,void 0)}));const n=mt(i[this.dashboardType].projects.edges.map((function(e){return e.node})));this.saveProjectsToCache(n),this.selectedOptions=this.querystringOptions},error(){Object(d.createAlert)({message:ut.a})},skip(){return!this.uncachedIds.length}},projects:{query(){return this.query},variables(){return{fullPath:this.groupFullPath,search:this.searchTerm}},update(e){const{projects:t}=e[this.dashboardType];return this.pageInfo=t.pageInfo,mt(t.edges.map((function(e){return e.node})))},result(){this.saveProjectsToCache(this.projects)},error(){Object(d.createAlert)({message:ut.a})},skip(){return!this.hasDropdownBeenOpened||this.isSearchTooShort||this.isMaxProjectsSelected}}},watch:{searchTerm(){this.projects=[],this.pageInfo={hasNextPage:!0}}},methods:{processQuerystringIds(){this.uncachedIds.length?this.emitFilterChanged({[this.filter.id]:this.querystringIds}):this.selectedOptions=this.querystringOptions},toggleOption(e){this.selectedOptions=Xe()(this.selectedOptions,[e],(function(e){return e.id})),this.updateQuerystring()},setDropdownOpened(){this.hasDropdownBeenOpened=!0},highlightSearchTerm(e){if(!this.isSearching)return e;const t=tt()(this.searchTerm).split(" ").join("|"),i=new RegExp(`(${t})`,"gi");return e.replace(i,"<b>$1</b>")},saveProjectsToCache(e){var t=this;e.forEach((function(e){return t.$set(t.projectsCache,e.id,e)}))},fetchNextPage(){this.$apollo.queries.projects.fetchMore({variables:{after:this.pageInfo.endCursor}})}},i18n:{enterMoreCharactersToSearch:Object(c.a)("Enter at least three characters to search"),maxProjectsSelected:Object(c.g)("SecurityReports|Maximum selected projects limit reached"),noMatchingResults:Object(c.a)("No matching results")}},pt=Object(f.a)(vt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("filter-body",{attrs:{name:e.filter.name,"selected-options":e.selectedOptionsOrAll,"show-search-box":!0,loading:e.isLoadingProjectsById},on:{"dropdown-show":e.setDropdownOpened},model:{value:e.searchTerm,callback:function(t){e.searchTerm="string"==typeof t?t.trim():t},expression:"searchTerm"}},[e.showSelectedProjectsSection?i("div",{attrs:{"data-testid":"selected-projects-section"}},[e._l(e.selectedOptions,(function(t){return i("filter-item",{key:t.id,attrs:{"is-checked":"",text:t.name},on:{click:function(i){return e.toggleOption(t)}}})})),e._v(" "),i("gl-dropdown-divider")],2):e._e(),e._v(" "),e.isMaxProjectsSelected?i("gl-dropdown-text",[e._v("\n    "+e._s(e.$options.i18n.maxProjectsSelected)+"\n  ")]):e.isSearchTooShort?i("gl-dropdown-text",[e._v("\n    "+e._s(e.$options.i18n.enterMoreCharactersToSearch)+"\n  ")]):e.hasNoResults?i("gl-dropdown-text",[e._v("\n    "+e._s(e.$options.i18n.noMatchingResults)+"\n  ")]):[e.isSearching?e._e():i("filter-item",{attrs:{"is-checked":e.isNoOptionsSelected,text:e.filter.allOption.name,"data-testid":"allOption"},on:{click:e.deselectAllOptions}}),e._v(" "),e._l(e.selectableProjects,(function(t){return i("filter-item",{key:t.id,attrs:{"is-checked":e.isSelected(t.id),text:t.name},on:{click:function(i){return e.toggleOption(t)}}},[i("div",{directives:[{name:"safe-html",rawName:"v-safe-html",value:e.highlightSearchTerm(t.name),expression:"highlightSearchTerm(project.name)"}]})])})),e._v(" "),e.shouldShowIntersectionObserver?i("gl-intersection-observer",{on:{appear:e.fetchNextPage}}):e._e(),e._v(" "),e.pageInfo.hasNextPage?i("gl-loading-icon",{staticClass:"gl-my-2",class:{"gl-visibility-hidden":!e.isLoadingProjects}}):e._e()]],2)}),[],!1,null,null,null).exports,ft=i("FKix"),gt=i.n(ft),ht=i("6HTq");const bt={[o.a.GROUP]:ot.a,[o.a.INSTANCE]:ct.a},yt=function(e){return e.map((function(e){let{id:t,name:i}=e;return{id:Object(st.e)(t).toString(),name:i}}))};var kt={components:{FilterItem:Ie.a,GlLoadingIcon:it.a,GlDropdownText:nt.a,GlIntersectionObserver:at.a,GlDropdown:le.a,QuerystringSync:we,DropdownButtonText:Pe,GlSearchBoxByType:ht.a},directives:{SafeHtml:rt.a},inject:["groupFullPath","dashboardType"],data:function(){return{projectNames:{},projects:[],selected:[],pageInfo:{hasNextPage:!0},searchTerm:"",hasDropdownBeenOpened:!1}},computed:{selectableProjects(){var e=this;return this.isSearching?this.projects:this.projects.filter((function(t){let{id:i}=t;return!e.selected.includes(i)}))},isLoadingProjects(){return this.$apollo.queries.projects.loading},isLoadingProjectsById(){return this.$apollo.queries.projectsById.loading},isSearchTooShort(){return this.isSearching&&this.searchTerm.length<3},isSearching(){return this.searchTerm.length>0},showSelectedProjectsSection(){return Boolean(this.selected.length)&&!this.isSearching},isMaxProjectsSelected(){return this.selected.length>=100},hasNoResults(){return!this.isLoadingProjects&&this.projects.length<=0},unfetchedIds(){var e=this;return this.selected.filter((function(t){return!Object.hasOwn(e.projectNames,t)}))},shouldShowIntersectionObserver(){return this.pageInfo.hasNextPage&&!this.isLoadingProjects},selectedProjectNames(){var e=this;const t=this.validIds.map((function(t){return e.projectNames[t]}));return t.length?t:[this.$options.i18n.allItemsText]},validIds(){var e=this;return this.selected.filter((function(t){return Boolean(e.projectNames[t])}))}},apollo:{projectsById:{query(){return bt[this.dashboardType]},manual:!0,variables(){return{fullPath:this.groupFullPath,pageSize:100,ids:Object(st.d)("Project",this.unfetchedIds)}},result(e){var t=this;let{data:i}=e;this.unfetchedIds.forEach((function(e){t.$set(t.projectNames,e,void 0)}));const n=yt(i[this.dashboardType].projects.edges.map((function(e){return e.node})));this.saveProjectNames(n)},error(){Object(d.createAlert)({message:this.$options.i18n.loadingError})},skip(){return!this.unfetchedIds.length}},projects:{query(){return bt[this.dashboardType]},variables(){return{fullPath:this.groupFullPath,search:this.searchTerm}},update(e){const{projects:t}=e[this.dashboardType],i=yt(t.edges.map((function(e){return e.node})));return this.saveProjectNames(i),this.pageInfo=t.pageInfo,i},error(){Object(d.createAlert)({message:this.$options.i18n.loadingError})},skip(){return!this.hasDropdownBeenOpened||this.isSearchTooShort||this.isMaxProjectsSelected}}},watch:{searchTerm(){this.projects=[],this.pageInfo={hasNextPage:!0}},validIds(){const e=this.unfetchedIds.length||this.validIds.length?this.selected:[];this.$emit("filter-changed",{projectId:e})}},methods:{async setDropdownOpened(){this.hasDropdownBeenOpened=!0,await this.$nextTick(),this.$refs.searchBox.focusInput()},highlightSearchTerm(e){if(!this.isSearching)return e;const t=tt()(this.searchTerm).split(" ").join("|"),i=new RegExp(`(${t})`,"gi");return e.replace(i,"<b>$1</b>")},saveProjectNames(e){var t=this;e.forEach((function(e){let{id:i,name:n}=e;return t.$set(t.projectNames,i,n)}))},fetchNextPage(){this.$apollo.queries.projects.fetchMore({variables:{after:this.pageInfo.endCursor}})},deselectAll(){this.selected=[]},toggleSelected(e){this.selected=gt()(this.validIds,[e])}},i18n:{label:Object(c.g)("SecurityReports|Project"),allItemsText:Object(c.g)("SecurityReports|All projects"),enterMoreCharactersToSearch:Object(c.a)("Enter at least three characters to search"),maxProjectsSelected:Object(c.g)("SecurityReports|Maximum selected projects limit reached"),noMatchingResults:Object(c.a)("No matching results"),loadingError:Object(c.a)("An error occurred while retrieving projects.")},ALL_ID:"ALL"},St=Object(f.a)(kt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("querystring-sync",{attrs:{"querystring-key":"projectId"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),e._v(" "),i("label",{staticClass:"gl-mb-2"},[e._v(e._s(e.$options.i18n.label))]),e._v(" "),i("gl-dropdown",{attrs:{"header-text":e.$options.i18n.label,loading:e.isLoadingProjectsById,block:"","toggle-class":"gl-mb-0"},on:{show:e.setDropdownOpened},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("dropdown-button-text",{attrs:{items:e.selectedProjectNames,name:e.$options.i18n.label}})]},proxy:!0},{key:"header",fn:function(){return[i("gl-search-box-by-type",{ref:"searchBox",attrs:{placeholder:e.__("Search"),autocomplete:"off"},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})]},proxy:!0},{key:"highlighted-items",fn:function(){return[e.showSelectedProjectsSection?e._l(e.validIds,(function(t){return i("filter-item",{key:t,attrs:{"is-checked":"",text:e.projectNames[t],"data-testid":t},on:{click:function(i){return e.toggleSelected(t)}}})})):e._e()]},proxy:!0}])},[e._v(" "),e._v(" "),e._v(" "),e.isMaxProjectsSelected?i("gl-dropdown-text",[e._v("\n      "+e._s(e.$options.i18n.maxProjectsSelected)+"\n    ")]):e.isSearchTooShort?i("gl-dropdown-text",[e._v("\n      "+e._s(e.$options.i18n.enterMoreCharactersToSearch)+"\n    ")]):e.hasNoResults?i("gl-dropdown-text",[e._v("\n      "+e._s(e.$options.i18n.noMatchingResults)+"\n    ")]):[e.isSearching?e._e():i("filter-item",{attrs:{"is-checked":!e.validIds.length,text:e.$options.i18n.allItemsText,"data-testid":e.$options.ALL_ID},on:{click:e.deselectAll}}),e._v(" "),e._l(e.selectableProjects,(function(t){var n=t.id,a=t.name;return i("filter-item",{key:n,attrs:{"is-checked":e.validIds.includes(n),text:a,"data-testid":n},on:{click:function(t){return e.toggleSelected(n)}}},[i("div",{directives:[{name:"safe-html",rawName:"v-safe-html",value:e.highlightSearchTerm(a),expression:"highlightSearchTerm(name)"}]})])})),e._v(" "),e.shouldShowIntersectionObserver?i("gl-intersection-observer",{on:{appear:e.fetchNextPage}}):e._e(),e._v(" "),e.pageInfo.hasNextPage?i("gl-loading-icon",{staticClass:"gl-my-2",class:{"gl-visibility-hidden":!e.isLoadingProjects}}):e._e()]],2)],1)}),[],!1,null,null,null).exports,_t=i("0a2z"),Nt=i.n(_t),Et=i("ifzy"),Dt=i.n(Et),Ct=i("ZPTr"),Ot=i.n(Ct),It=(i("TMxP"),i("iQ9A"),i("u6G8"),i("oVeW"),i("aSYY")),Tt={components:{GlDropdownDivider:Ce.a,GlDropdownItem:oe.a,GlTruncate:te.a,FilterBody:Ue.a,FilterItem:Ie.a},extends:He.a,inject:["scanners"],computed:{options(){return Object.values(this.groups).flatMap((function(e){return Object.values(e)}))},groups(){const e={GitLab:Nt()(this.filter.options,"reportType")};return this.scanners.filter((function(e){return e.report_type.toLowerCase()!==It.f})).forEach((function(t){const i=t.vendor||L.b,n=t.report_type,a=`${i}.${n}`;k()(e,a)||Dt()(e,a,Object(ut.d)(i,n)),e[i][n].scannerIds.push(t.id)})),e},filterObject(){if(this.isNoOptionsSelected)return{scannerId:[]};return{scannerId:this.selectedOptions.flatMap((function(e){let{scannerIds:t,reportType:i}=e;return t.length?t.map((function(e){return`${L.i}${e}`})):[`${L.i}${i}:null`]}))}},hasCustomVendor(){return Object.keys(this.groups).length>1}},methods:{toggleGroup(e){var t=this;const i=Object.values(this.groups[e]);this.selectedOptions=i.every((function(e){return t.selectedSet.has(e)}))?De()(this.selectedOptions,...i):Ot()(this.selectedOptions,i),this.updateQuerystring()}}},jt=Object(f.a)(Tt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("filter-body",{attrs:{name:e.filter.name,"selected-options":e.selectedOptionsOrAll,"show-search-box":!1}},[e.filter.allOption?i("filter-item",{attrs:{"is-checked":e.isNoOptionsSelected,text:e.filter.allOption.name,"data-testid":"all"},on:{click:e.deselectAllOptions}}):e._e(),e._v(" "),e._l(Object.entries(e.groups),(function(t){var n=t[0],a=t[1];return[e.hasCustomVendor?i("gl-dropdown-divider",{key:n+":divider"}):e._e(),e._v(" "),e.hasCustomVendor?i("gl-dropdown-item",{key:n+":header",attrs:{"data-testid":n+"Header"},nativeOn:{"!click":function(t){return t.stopPropagation(),e.toggleGroup(n)}}},[i("gl-truncate",{staticClass:"gl-font-weight-bold",attrs:{text:n}})],1):e._e(),e._v(" "),e._l(Object.values(a),(function(t){return i("filter-item",{key:t.id,attrs:{"is-checked":e.isSelected(t),text:t.name,"data-testid":t.id},on:{click:function(i){return e.toggleOption(t)}}})}))]}))],2)}),[],!1,null,null,null).exports,Vt=i("dkvl"),Lt=i.n(Vt),Rt={components:{FilterItem:Ie.a,GlDropdown:le.a,QuerystringSync:we,DropdownButtonText:Pe},apollo:{clusterAgents:{query:Lt.a,variables(){return{projectPath:this.projectFullPath}},update:function(e){var t,i;return(null===(t=e.project)||void 0===t||null===(i=t.clusterAgents)||void 0===i?void 0:i.nodes.map((function(e){return{id:e.name,name:e.name,gid:e.id}})))||[]},error(){Object(d.createAlert)({message:this.$options.i18n.loadingError})}}},inject:["projectFullPath"],data:function(){return{clusterAgents:[],selected:[]}},computed:{selectedItemNames(){var e,t=this;const i=null===(e=this.clusterAgents)||void 0===e?void 0:e.filter((function(e){let{id:i}=e;return t.selected.includes(i)}));return i.length?i.map((function(e){let{name:t}=e;return t})):[this.$options.i18n.allItemsText]},isLoading(){return this.$apollo.queries.clusterAgents.loading}},watch:{selected(){var e=this;const t=this.clusterAgents.filter((function(t){let{id:i}=t;return e.selected.includes(i)})).map((function(e){let{gid:t}=e;return t}));this.$emit("filter-changed",{clusterAgentId:t})}},methods:{deselectAll(){this.selected=[]},toggleSelected(e){this.selected=gt()(this.selected,[e])}},i18n:{label:Object(c.g)("SecurityReports|Cluster"),allItemsText:Object(c.g)("SecurityReports|All clusters"),loadingError:Object(c.g)("SecurityOrchestration|Failed to load cluster agents.")},ALL_ID:"ALL"},wt=Object(f.a)(Rt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("querystring-sync",{attrs:{"querystring-key":"cluster"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),e._v(" "),i("label",{staticClass:"gl-mb-2"},[e._v(e._s(e.$options.i18n.label))]),e._v(" "),i("gl-dropdown",{attrs:{"header-text":e.$options.i18n.label,loading:e.isLoading,block:"","toggle-class":"gl-mb-0"},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("dropdown-button-text",{attrs:{items:e.selectedItemNames,name:e.$options.i18n.label}})]},proxy:!0}])},[e._v(" "),i("filter-item",{attrs:{"is-checked":!e.selected.length,text:e.$options.i18n.allItemsText,"data-testid":e.$options.ALL_ID},on:{click:e.deselectAll}}),e._v(" "),e._l(e.clusterAgents,(function(t){var n=t.id;return i("filter-item",{key:n,attrs:{"data-testid":n,"is-checked":e.selected.includes(n),text:n},on:{click:function(t){return e.toggleSelected(n)}}})}))],2)],1)}),[],!1,null,null,null).exports,xt={components:{FilterBody:Ue.a,FilterItem:Ie.a},extends:He.a,apollo:{clusterAgents:{query:Lt.a,variables(){return{projectPath:this.projectFullPath}},update:function(e){var t,i;return(null===(t=e.project)||void 0===t||null===(i=t.clusterAgents)||void 0===i?void 0:i.nodes.map((function(e){return{id:e.name,name:e.name,gid:e.id}})))||[]},error(){Object(d.createAlert)({message:Ae})}}},inject:["projectFullPath"],data:()=>({clusterAgents:[]}),computed:{filterObject(){return{clusterAgentId:this.selectedOptions.map((function(e){return e.gid}))}},options(){return this.clusterAgents},isLoading(){return this.$apollo.queries.clusterAgents.loading}},watch:{options(){this.processQuerystringIds()}}},Pt=Object(f.a)(xt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("filter-body",{attrs:{name:e.filter.name,"selected-options":e.selectedOptionsOrAll,loading:e.isLoading}},[i("filter-item",{attrs:{"is-checked":e.isNoOptionsSelected,text:e.filter.allOption.name,"data-testid":"all"},on:{click:e.deselectAllOptions}}),e._v(" "),e._l(e.clusterAgents,(function(t){return i("filter-item",{key:t.id,attrs:{"is-checked":e.isSelected(t),text:t.id,"data-testid":"option:"+t.id},on:{click:function(i){return e.toggleOption(t)}}})}))],2)}),[],!1,null,null,null).exports,At=i("K0dZ"),Ft=i.n(At),$t=i("vnep"),qt=i.n($t),Bt={components:{FilterBody:Ue.a,FilterItem:Ie.a,GlTruncate:te.a},extends:He.a,apollo:{images:{query(){return this.isAgentDashboard?Ft.a:qt.a},variables(){return{agentName:this.agentName,projectPath:this.projectFullPath||this.fullPath}},update(e){var t,i,n;const a=this.isAgentDashboard?null===(t=e.project)||void 0===t||null===(i=t.clusterAgent)||void 0===i?void 0:i.vulnerabilityImages:null===(n=e.project)||void 0===n?void 0:n.vulnerabilityImages;return(null==a?void 0:a.nodes.map((function(e){return{id:e.name,name:e.name}})))||[]},error(){Object(d.createAlert)({message:Fe})}}},inject:{agentName:{default:""},dashboardType:{default:o.a.PROJECT},fullPath:{default:""},projectFullPath:{default:""}},data:()=>({images:[]}),computed:{isAgentDashboard(){return this.dashboardType===o.a.PROJECT&&Boolean(this.agentName)},filterObject(){return{image:this.selectedOptions.map((function(e){return e.id}))}},options(){return this.images},isLoading(){return this.$apollo.queries.images.loading}},watch:{options(){this.processQuerystringIds()}}},Mt=Object(f.a)(Bt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("filter-body",{attrs:{name:e.filter.name,"selected-options":e.selectedOptionsOrAll,loading:e.isLoading}},[i("filter-item",{attrs:{"is-checked":e.isNoOptionsSelected,text:e.filter.allOption.name},on:{click:e.deselectAllOptions}}),e._v(" "),e._l(e.images,(function(t){return i("filter-item",{key:t.id,attrs:{tooltip:t.id,"is-checked":e.isSelected(t)},on:{click:function(i){return e.toggleOption(t)}}},[i("gl-truncate",{attrs:{position:"middle",text:t.id,title:""}})],1)}))],2)}),[],!1,null,null,null).exports,Gt={components:{FilterItem:Ie.a,GlDropdown:le.a,GlTruncate:te.a,QuerystringSync:we,DropdownButtonText:Pe},directives:{GlTooltip:j.a},apollo:{images:{query(){return this.isAgentDashboard?Ft.a:qt.a},variables(){return{agentName:this.agentName,projectPath:this.projectFullPath||this.fullPath}},update(e){var t,i,n;return(this.isAgentDashboard?null===(t=e.project)||void 0===t||null===(i=t.clusterAgent)||void 0===i?void 0:i.vulnerabilityImages:null===(n=e.project)||void 0===n?void 0:n.vulnerabilityImages).nodes.map((function(e){let{name:t}=e;return t}))},error(){Object(d.createAlert)({message:this.$options.i18n.loadingError})}}},inject:{agentName:{default:""},dashboardType:{default:o.a.PROJECT},fullPath:{default:""},projectFullPath:{default:""}},data:function(){return{images:[],selected:[]}},computed:{isAgentDashboard(){return this.dashboardType===o.a.PROJECT&&Boolean(this.agentName)},selectedItemNames(){return this.selected.length?this.selected:[this.$options.i18n.allItemsText]},isLoading(){return this.$apollo.queries.images.loading}},watch:{selected(){this.$emit("filter-changed",{image:this.selected})}},methods:{deselectAll(){this.selected=[]},toggleSelected(e){this.selected=gt()(this.selected,[e])}},i18n:{label:Object(c.g)("SecurityReports|Image"),allItemsText:Object(c.g)("SecurityReports|All images"),loadingError:Object(c.g)("SecurityOrchestration|Failed to load images.")},ALL_ID:"ALL"},Ut=Object(f.a)(Gt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("querystring-sync",{attrs:{"querystring-key":"image"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),e._v(" "),i("label",{staticClass:"gl-mb-2"},[e._v(e._s(e.$options.i18n.label))]),e._v(" "),i("gl-dropdown",{attrs:{"header-text":e.$options.i18n.label,loading:e.isLoading,block:"","toggle-class":"gl-mb-0"},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("dropdown-button-text",{attrs:{items:e.selectedItemNames,name:e.$options.i18n.label}})]},proxy:!0}])},[e._v(" "),i("filter-item",{attrs:{"is-checked":!e.selected.length,text:e.$options.i18n.allItemsText,"data-testid":e.$options.ALL_ID},on:{click:e.deselectAll}}),e._v(" "),e._l(e.images,(function(t){return i("filter-item",{key:t,attrs:{tooltip:t,"data-testid":t,"is-checked":e.selected.includes(t)},on:{click:function(i){return e.toggleSelected(t)}}},[i("gl-truncate",{attrs:{position:"middle",text:t,title:""}})],1)}))],2)],1)}),[],!1,null,null,null).exports,Ht=i("Q1r2"),zt=i.n(Ht),Qt=i("k0ue"),Wt=i.n(Qt),Jt=i("NfBT"),Yt=i.n(Jt);const Xt={[o.a.PROJECT]:{query:zt.a,fullPath:"fullPath",dataType:"project"},[o.a.GROUP]:{query:Wt.a,fullPath:"fullPath",dataType:"group"},[o.a.INSTANCE]:{query:Yt.a,fullPath:void 0,dataType:"instanceSecurityDashboard"}};var Kt={name:"ToolFilter",components:{FilterBody:Ue.a,FilterItem:Ie.a},extends:He.a,inject:["dashboardType","fullPath"],apollo:{vulnerabilityScanners:{query(){return this.query},variables(){return this.queryVariables},update(e){var t,i;const{dataType:n}=Xt[this.dashboardType],a=null===(t=e[n])||void 0===t||null===(i=t.vulnerabilityScanners)||void 0===i?void 0:i.nodes;return a?Object(ut.e)(a):[]},result(){this.selectedOptions=this.querystringOptions},error(){Object(d.createAlert)({message:$e})},skip(){return!this.query}}},data:()=>({vulnerabilityScanners:[]}),computed:{options(){return this.vulnerabilityScanners},query(){var e;return null===(e=Xt[this.dashboardType])||void 0===e?void 0:e.query},queryVariables(){const{fullPath:e}=Xt[this.dashboardType];return{fullPath:this[e]}},isLoading(){return this.$apollo.queries.vulnerabilityScanners.loading}},i18n:{disabledTooltip:Object(c.g)("SecurityReports|Not available")}},Zt=Object(f.a)(Kt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("filter-body",{attrs:{name:e.filter.name,"selected-options":e.selectedOptionsOrAll,loading:e.isLoading}},[i("filter-item",{attrs:{"is-checked":e.isNoOptionsSelected,text:e.filter.allOption.name,"data-testid":"all"},on:{click:e.deselectAllOptions}}),e._v(" "),e._l(e.vulnerabilityScanners,(function(t){return i("filter-item",{key:t.id,attrs:{"is-checked":e.isSelected(t),text:t.name,disabled:t.disabled,tooltip:t.disabled?e.$options.i18n.disabledTooltip:"","data-testid":"option:"+t.id},on:{click:function(i){return e.toggleOption(t)}}})}))],2)}),[],!1,null,null,null).exports;const ei=Object.entries(o.h).map((function(e){let[t,i]=e;return{id:t.toUpperCase(),text:i}}));var ti={components:{FilterItem:Ie.a,GlDropdown:le.a,DropdownButtonText:Pe,QuerystringSync:we},data:()=>({selected:[]}),computed:{selectedItemTexts(){var e=this;const t=ei.filter((function(t){let{id:i}=t;return e.selected.includes(i)}));return t.length?t.map((function(e){let{text:t}=e;return t})):[this.$options.i18n.allItemsText]}},watch:{selected(){this.$emit("filter-changed",{reportType:this.selected})}},methods:{deselectAll(){this.selected=[]},toggleSelected(e){this.selected=gt()(this.selected,[e])}},i18n:{label:Object(c.g)("SecurityReports|Tool"),allItemsText:Object(c.g)("SecurityReports|All tools")},DROPDOWN_OPTIONS:ei,ALL_ID:"ALL"},ii=Object(f.a)(ti,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("querystring-sync",{attrs:{"querystring-key":"reportType"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),e._v(" "),i("label",{staticClass:"gl-mb-2"},[e._v(e._s(e.$options.i18n.label))]),e._v(" "),i("gl-dropdown",{attrs:{"header-text":e.$options.i18n.label,block:"","toggle-class":"gl-mb-0","menu-class":"dropdown-extended-height"},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("dropdown-button-text",{attrs:{items:e.selectedItemTexts,name:e.$options.i18n.label}})]},proxy:!0}])},[e._v(" "),i("filter-item",{attrs:{"is-checked":!e.selected.length,text:e.$options.i18n.allItemsText,"data-testid":e.$options.ALL_ID},on:{click:e.deselectAll}}),e._v(" "),e._l(e.$options.DROPDOWN_OPTIONS,(function(t){var n=t.id,a=t.text;return i("filter-item",{key:n,attrs:{"data-testid":n,"is-checked":e.selected.includes(n),text:a},on:{click:function(t){return e.toggleSelected(n)}}})}))],2)],1)}),[],!1,null,null,null).exports,ni=i("USFb"),ai=i.n(ni),ri=i("APtt"),si=i.n(ri),li=i("lKw0"),oi=i.n(li),di=i("LkRf");const ci=Object(st.c)(di.y,"null"),ui=si()(o.h,(function(e,t){return t.toUpperCase()}));var mi={components:{GlDropdown:le.a,GlDropdownItem:oe.a,GlDropdownDivider:Ce.a,GlTruncate:te.a,FilterItem:Ie.a,QuerystringSync:we,DropdownButtonText:Pe},inject:["scanners"],data:function(){return{selected:[]}},computed:{vendors(){const e=oi()(this.scanners,(function(e){let{vendor:t}=e;return t.trim()||"GitLab"}));return{GitLab:{},...ai()(e,(function(e){const t=oi()(e,"report_type");return ai()(t,(function(e){return e.map((function(e){let{id:t}=e;return Object(st.c)(di.y,t)}))}))}))}},hasCustomVendor(){return Object.keys(this.vendors).length>1},selectedItemTexts(){var e=this;return this.selected.length?this.selected.map((function(t){return e.getReportName(t)})):[this.$options.i18n.allItemsText]}},watch:{selected(){var e=this;const t=this.selected.flatMap((function(t){return k()(e.vendors,t)})).filter(Boolean),i=this.selected.length&&!t.length;this.$emit("filter-changed",{scannerId:i?[ci]:t})}},methods:{getReportTypeIds(e){const t="GitLab"===e?ui:this.vendors[e];return Object.keys(t).map((function(t){return`${e}.${t}`}))},getReportName:e=>ui[e.split(".")[1]],deselectAll(){this.selected=[]},toggleAllIds(e){var t=this;const i=this.getReportTypeIds(e);this.selected=i.every((function(e){return t.selected.includes(e)}))?De()(this.selected,...i):Ot()(this.selected,i)},toggleSelected(e){this.selected=gt()(this.selected,[e])}},i18n:{label:Object(c.g)("SecurityReports|Tool"),allItemsText:Object(c.g)("ciReport|All tools")},ALL_ID:"ALL"},vi=Object(f.a)(mi,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("querystring-sync",{attrs:{"querystring-key":"scanner"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),e._v(" "),i("label",{staticClass:"gl-mb-2"},[e._v(e._s(e.$options.i18n.label))]),e._v(" "),i("gl-dropdown",{attrs:{"header-text":e.$options.i18n.label,block:"","toggle-class":"gl-mb-0"},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("dropdown-button-text",{attrs:{items:e.selectedItemTexts,name:e.$options.i18n.label}})]},proxy:!0}])},[e._v(" "),i("filter-item",{attrs:{"is-checked":!e.selected.length,text:e.$options.i18n.allItemsText,"data-testid":e.$options.ALL_ID},on:{click:e.deselectAll}}),e._v(" "),e._l(Object.keys(e.vendors),(function(t){return[e.hasCustomVendor?i("gl-dropdown-divider",{key:t+":divider",attrs:{"data-testid":t+":divider"}}):e._e(),e._v(" "),e.hasCustomVendor?i("gl-dropdown-item",{key:t+":header",attrs:{"data-testid":t+":header"},nativeOn:{"!click":function(i){return i.stopPropagation(),e.toggleAllIds(t)}}},[i("gl-truncate",{staticClass:"gl-font-weight-bold",attrs:{text:t}})],1):e._e(),e._v(" "),e._l(e.getReportTypeIds(t),(function(t){return i("filter-item",{key:t,attrs:{"is-checked":e.selected.includes(t),text:e.getReportName(t),"data-testid":t},on:{click:function(i){return e.toggleSelected(t)}}})}))]}))],2)],1)}),[],!1,null,null,null).exports;const pi=Object.entries(o.i).map((function(e){let[t,i]=e;return{id:t.toUpperCase(),text:i}})),fi=pi.map((function(e){let{id:t}=e;return t}));var gi={components:{GlDropdown:le.a,DropdownButtonText:Pe,QuerystringSync:we,FilterItem:Ie.a},data:function(){return{selected:[]}},computed:{selectedItemTexts(){var e=this;const t=pi.filter((function(t){let{id:i}=t;return e.selected.includes(i)}));return t.length?t.map((function(e){let{text:t}=e;return t})):[this.$options.i18n.allItemsText]}},watch:{selected(){this.$emit("filter-changed",{severity:this.selected})}},methods:{deselectAll(){this.selected=[]},toggleSelected(e){this.selected=gt()(this.selected,[e])},setSelected(e){this.selected=e.filter((function(e){return fi.includes(e)}))}},i18n:{label:Object(c.g)("SecurityReports|Severity"),allItemsText:Object(c.g)("SecurityReports|All severities")},DROPDOWN_OPTIONS:pi,ALL_ID:"ALL"},hi=Object(f.a)(gi,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("querystring-sync",{attrs:{"querystring-key":"severity",value:e.selected},on:{input:e.setSelected}}),e._v(" "),i("label",{staticClass:"gl-mb-2"},[e._v(e._s(e.$options.i18n.label))]),e._v(" "),i("gl-dropdown",{attrs:{"header-text":e.$options.i18n.label,block:"","toggle-class":"gl-mb-0"},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("dropdown-button-text",{attrs:{items:e.selectedItemTexts,name:e.$options.i18n.label}})]},proxy:!0}])},[e._v(" "),i("filter-item",{attrs:{"is-checked":!e.selected.length,text:e.$options.i18n.allItemsText,"data-testid":e.$options.ALL_ID},on:{click:e.deselectAll}}),e._v(" "),e._l(e.$options.DROPDOWN_OPTIONS,(function(t){var n=t.id,a=t.text;return i("filter-item",{key:n,attrs:{"data-testid":n,"is-checked":e.selected.includes(n),text:a},on:{click:function(t){return e.toggleSelected(n)}}})}))],2)],1)}),[],!1,null,null,null).exports;const{detected:bi,confirmed:yi,dismissed:ki,resolved:Si}=B.j,_i=[{id:bi.state.toUpperCase(),text:bi.buttonText},{id:yi.state.toUpperCase(),text:yi.buttonText},{id:ki.state.toUpperCase(),text:ki.buttonText},{id:Si.state.toUpperCase(),text:Si.buttonText}],Ni=["ALL",..._i.map((function(e){let{id:t}=e;return t}))],Ei=[bi.state.toUpperCase(),yi.state.toUpperCase()];var Di={components:{GlDropdown:le.a,DropdownButtonText:Pe,QuerystringSync:we,FilterItem:Ie.a},data:function(){return{selected:Ei}},computed:{selectedIds(){return this.selected.length?this.selected:["ALL"]},selectedItemTexts(){var e=this;const t=_i.filter((function(t){let{id:i}=t;return e.selected.includes(i)}));return t.length?t.map((function(e){let{text:t}=e;return t})):[this.$options.i18n.allItemsText]}},watch:{selected:{immediate:!0,handler(){this.$emit("filter-changed",{state:this.selected})}}},methods:{deselectAll(){this.selected=[]},toggleSelected(e){this.selected=gt()(this.selected,[e])},setSelected(e){e.includes("ALL")?this.selected=[]:e.length?this.selected=e:this.selected=Ei}},i18n:{label:Object(c.g)("SecurityReports|Status"),allItemsText:Object(c.g)("SecurityReports|All statuses")},DROPDOWN_OPTIONS:_i,VALID_IDS:Ni,ALL_ID:"ALL"},Ci=Object(f.a)(Di,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("querystring-sync",{attrs:{"querystring-key":"state",value:e.selectedIds,"valid-values":e.$options.VALID_IDS},on:{input:e.setSelected}}),e._v(" "),i("label",{staticClass:"gl-mb-2"},[e._v(e._s(e.$options.i18n.label))]),e._v(" "),i("gl-dropdown",{attrs:{"header-text":e.$options.i18n.label,block:"","toggle-class":"gl-mb-0"},scopedSlots:e._u([{key:"button-text",fn:function(){return[i("dropdown-button-text",{attrs:{items:e.selectedItemTexts,name:e.$options.i18n.label}})]},proxy:!0}])},[e._v(" "),i("filter-item",{attrs:{"is-checked":!e.selected.length,text:e.$options.i18n.allItemsText,"data-testid":e.$options.ALL_ID},on:{click:e.deselectAll}}),e._v(" "),e._l(e.$options.DROPDOWN_OPTIONS,(function(t){var n=t.id,a=t.text;return i("filter-item",{key:n,attrs:{"data-testid":n,"is-checked":e.selected.includes(n),text:a},on:{click:function(t){return e.toggleSelected(n)}}})}))],2)],1)}),[],!1,null,null,null).exports;const{ACTIVITY:Oi,TOOL_VENDOR:Ii,TOOL_SIMPLE:Ti,PROJECT:ji,CLUSTER:Vi,IMAGE:Li,SEVERITY:Ri,STATUS:wi}=pe.c;var xi={mixins:[Object(_.a)()],props:{filters:{type:Array,required:!0}},data:()=>({filterQuery:{},emitFilterChange:Ne()((function(){this.$emit("filters-changed",this.filterQuery)}))}),methods:{getComponentType(e){const{refactorVulnerabilityFilters:t,refactorVulnerabilityToolFilter:i}=this.glFeatures;switch(e){case Ri:return t?hi:He.a;case wi:return t?Ci:He.a;case Ii:return t?vi:jt;case Ti:return i?Zt:t?ii:He.a;case Oi:return t?Ge:Je;case ji:return t?St:pt;case Vi:return t?wt:Pt;case Li:return t?Ut:Mt;default:return He.a}},updateFilterQuery(e){const t=Se()(this.filterQuery);this.filterQuery={...this.filterQuery,...e},b()(t,this.filterQuery)||this.emitFilterChange()}}},Pi={components:{VulnerabilityCounts:g,VulnerabilityListGraphql:ye,VulnerabilityFilters:Object(f.a)(xi,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vulnerability-report-filters gl-p-5 gl-bg-gray-10 gl-border-b-1 gl-border-b-solid gl-border-b-gray-100"},e._l(e.filters,(function(t){return i(e.getComponentType(t),{key:t.id,tag:"component",attrs:{filter:t,"data-testid":t.id},on:{"filter-changed":e.updateFilterQuery}})})),1)}),[],!1,null,null,null).exports,PortalTarget:n.PortalTarget},props:{filterDropdowns:{type:Array,required:!0},fields:{type:Array,required:!0},filterFn:{type:Function,required:!1,default:function(e){return e}},isVisible:{type:Boolean,required:!1,default:!0},showCounts:{type:Boolean,required:!1,default:!1}},data:()=>({graphqlFilters:void 0}),computed:{shouldShowProjectNamespace(){return this.filterDropdowns.includes(pe.c.PROJECT)}},methods:{updateGraphqlFilters(e){this.graphqlFilters=this.filterFn(e)},emitCountsChanged(e){this.$emit("counts-changed",e)},scrollToTopOfList(){const{vulnerabilityListTop:e}=this.$refs;e.getBoundingClientRect().top<Object(a.g)()&&Object(a.N)(e)}},portalName:"vulnerability-report-sticky"},Ai=Object(f.a)(Pi,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.showCounts?i("vulnerability-counts",{staticClass:"gl-mb-7",attrs:{filters:e.graphqlFilters},on:{"counts-changed":e.emitCountsChanged}}):e._e(),e._v(" "),i("div",{ref:"vulnerabilityListTop",attrs:{"data-testid":"vulnerability-list-top"}}),e._v(" "),i("div",{staticClass:"security-dashboard-filters"},[i("vulnerability-filters",{attrs:{filters:e.filterDropdowns},on:{"filters-changed":e.updateGraphqlFilters}}),e._v(" "),e.isVisible?i("portal-target",{attrs:{name:e.$options.portalName}}):e._e()],1),e._v(" "),e.isVisible?i("vulnerability-list-graphql",{attrs:{fields:e.fields,filters:e.graphqlFilters,"show-project-namespace":e.shouldShowProjectNamespace,"portal-name":e.$options.portalName},on:{"vulnerability-clicked":function(t){return e.$emit("vulnerability-clicked",t)},"query-variables-changed":e.scrollToTopOfList}}):e._e()],1)}),[],!1,null,null,null);t.a=Ai.exports},NfBT:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"instanceSpecificScanners"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"instanceSecurityDashboard"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilityScanners"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilityScanner"},directives:[]}]}}]}}]}}]}}],loc:{start:0,end:247}};n.loc.source={body:'#import "ee/security_dashboard/graphql/fragments/vulnerability_scanner.fragment.graphql"\n\nquery instanceSpecificScanners {\n  instanceSecurityDashboard {\n    vulnerabilityScanners {\n      nodes {\n        ...VulnerabilityScanner\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};n.definitions=n.definitions.concat(i("SJpF").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)})));var r={};function s(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),r[e.name.value]=t}})),e.exports=n,e.exports.instanceSpecificScanners=function(e,t){var i={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=r[t]||new Set,a=new Set,l=new Set;for(n.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(r[e]||new Set).forEach((function(e){l.add(e)})))}))}return a.forEach((function(t){var n=s(e,t);n&&i.definitions.push(n)})),i}(n,"instanceSpecificScanners")},OwU9:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"dismissFinding"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uuid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"comment"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"securityFindingDismiss"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"uuid"},value:{kind:"Variable",name:{kind:"Name",value:"uuid"}}},{kind:"ObjectField",name:{kind:"Name",value:"comment"},value:{kind:"Variable",name:{kind:"Name",value:"comment"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:147}};i.loc.source={body:"mutation dismissFinding($uuid: String!, $comment: String) {\n  securityFindingDismiss(input: { uuid: $uuid, comment: $comment }) {\n    errors\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.dismissFinding=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"dismissFinding")},Pf0K:function(e,t,i){"use strict";var n=i("B0bW"),a=i("t9l/"),r=i("Wrl+"),s={components:{GlEmptyState:n.a},props:{svgPath:{type:String,required:!0}},i18n:{title:Object(a.g)("SecurityReports|Oops, something doesn't seem right."),description:Object(a.g)("SecurityReports|Either you don't have permission to view this dashboard or the dashboard has not been setup. Please check your permission settings with your administrator or check your dashboard configurations to proceed."),primaryButtonText:Object(a.g)("SecurityReports|Learn more about setting up your dashboard")},DOC_PATH_SECURITY_CONFIGURATION:r.d},l=i("bPvS"),o=Object(l.a)(s,(function(){var e=this.$createElement;return(this._self._c||e)("gl-empty-state",{attrs:{"svg-path":this.svgPath,title:this.$options.i18n.title,description:this.$options.i18n.description,"primary-button-link":this.$options.DOC_PATH_SECURITY_CONFIGURATION,"primary-button-text":this.$options.i18n.primaryButtonText}})}),[],!1,null,null,null);t.a=o.exports},Pl9t:function(e,t,i){var n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ProjectVulnerabilitySeveritiesCount"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Project"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitySeveritiesCount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"ListValue",values:[{kind:"EnumValue",value:"DETECTED"},{kind:"EnumValue",value:"CONFIRMED"}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilitySeveritiesCount"},directives:[]}]}}]}}],loc:{start:0,end:261}};n.loc.source={body:'#import "ee/security_dashboard/graphql/fragments/vulnerability_severities_count.fragment.graphql"\nfragment ProjectVulnerabilitySeveritiesCount on Project {\n  vulnerabilitySeveritiesCount(state: [DETECTED, CONFIRMED]) {\n    ...VulnerabilitySeveritiesCount\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};n.definitions=n.definitions.concat(i("DQim").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)})));var r={};function s(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),r[e.name.value]=t}})),e.exports=n,e.exports.ProjectVulnerabilitySeveritiesCount=function(e,t){var i={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=r[t]||new Set,a=new Set,l=new Set;for(n.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(r[e]||new Set).forEach((function(e){l.add(e)})))}))}return a.forEach((function(t){var n=s(e,t);n&&i.definitions.push(n)})),i}(n,"ProjectVulnerabilitySeveritiesCount")},Q1r2:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"projectSpecificScanners"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilityScanners"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilityScanner"},directives:[]}]}}]}}]}}]}}],loc:{start:0,end:272}};n.loc.source={body:'#import "ee/security_dashboard/graphql/fragments/vulnerability_scanner.fragment.graphql"\n\nquery projectSpecificScanners($fullPath: ID!) {\n  project(fullPath: $fullPath) {\n    id\n    vulnerabilityScanners {\n      nodes {\n        ...VulnerabilityScanner\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};n.definitions=n.definitions.concat(i("SJpF").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)})));var r={};function s(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),r[e.name.value]=t}})),e.exports=n,e.exports.projectSpecificScanners=function(e,t){var i={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=r[t]||new Set,a=new Set,l=new Set;for(n.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(r[e]||new Set).forEach((function(e){l.add(e)})))}))}return a.forEach((function(t){var n=s(e,t);n&&i.definitions.push(n)})),i}(n,"projectSpecificScanners")},QGxF:function(e,t,i){"use strict";var n={};i.r(n),i.d(n,"setFilter",(function(){return P})),i.d(n,"setHideDismissed",(function(){return A}));var a={};i.r(a),i.d(a,"setPipelineId",(function(){return W})),i.d(a,"setSourceBranch",(function(){return J})),i.d(a,"setVulnerabilitiesEndpoint",(function(){return Y})),i.d(a,"setVulnerabilitiesPage",(function(){return X})),i.d(a,"fetchVulnerabilities",(function(){return K})),i.d(a,"requestVulnerabilities",(function(){return Z})),i.d(a,"receiveVulnerabilitiesSuccess",(function(){return ee})),i.d(a,"receiveVulnerabilitiesError",(function(){return te})),i.d(a,"setModalData",(function(){return ie})),i.d(a,"createIssue",(function(){return ne})),i.d(a,"requestCreateIssue",(function(){return ae})),i.d(a,"receiveCreateIssueSuccess",(function(){return re})),i.d(a,"receiveCreateIssueError",(function(){return se})),i.d(a,"selectAllVulnerabilities",(function(){return le})),i.d(a,"deselectAllVulnerabilities",(function(){return oe})),i.d(a,"selectVulnerability",(function(){return de})),i.d(a,"deselectVulnerability",(function(){return ce})),i.d(a,"dismissSelectedVulnerabilities",(function(){return ue})),i.d(a,"requestDismissSelectedVulnerabilities",(function(){return me})),i.d(a,"receiveDismissSelectedVulnerabilitiesSuccess",(function(){return ve})),i.d(a,"receiveDismissSelectedVulnerabilitiesError",(function(){return pe})),i.d(a,"dismissVulnerability",(function(){return fe})),i.d(a,"requestDismissVulnerability",(function(){return ge})),i.d(a,"receiveDismissVulnerabilitySuccess",(function(){return he})),i.d(a,"receiveDismissVulnerabilityError",(function(){return be})),i.d(a,"addDismissalComment",(function(){return ye})),i.d(a,"deleteDismissalComment",(function(){return ke})),i.d(a,"requestAddDismissalComment",(function(){return Se})),i.d(a,"receiveAddDismissalCommentSuccess",(function(){return _e})),i.d(a,"receiveAddDismissalCommentError",(function(){return Ne})),i.d(a,"requestDeleteDismissalComment",(function(){return Ee})),i.d(a,"receiveDeleteDismissalCommentSuccess",(function(){return De})),i.d(a,"receiveDeleteDismissalCommentError",(function(){return Ce})),i.d(a,"showDismissalDeleteButtons",(function(){return Oe})),i.d(a,"hideDismissalDeleteButtons",(function(){return Ie})),i.d(a,"revertDismissVulnerability",(function(){return Te})),i.d(a,"requestUndoDismiss",(function(){return je})),i.d(a,"receiveUndoDismissSuccess",(function(){return Ve})),i.d(a,"receiveUndoDismissError",(function(){return Le})),i.d(a,"downloadPatch",(function(){return Re})),i.d(a,"createMergeRequest",(function(){return we})),i.d(a,"requestCreateMergeRequest",(function(){return xe})),i.d(a,"receiveCreateMergeRequestSuccess",(function(){return Pe})),i.d(a,"receiveCreateMergeRequestError",(function(){return Ae})),i.d(a,"openDismissalCommentBox",(function(){return Fe})),i.d(a,"closeDismissalCommentBox",(function(){return $e}));var r={};i.r(r),i.d(r,"dashboardError",(function(){return Be})),i.d(r,"dashboardListError",(function(){return Me})),i.d(r,"dashboardCountError",(function(){return Ge})),i.d(r,"loadingVulnerabilitiesFailedWithRecognizedErrorCode",(function(){return Ue})),i.d(r,"selectedVulnerabilitiesCount",(function(){return He})),i.d(r,"isSelectingVulnerabilities",(function(){return ze})),i.d(r,"hasSelectedAllVulnerabilities",(function(){return Qe}));i("TMxP"),i("3R5X"),i("iQ9A"),i("ujLG"),i("HaUQ");var s=i("B0bW"),l=i("cuRJ"),o=i("nkAn"),d=i.n(o),c=i("qzef"),u=i("voi4"),m=i("t9l/"),v=i("Zxcm"),p=i("mcoW"),f=i("Wrl+"),g=(i("h8Et"),i("uHfJ"),i("R0RX"),i("TR9G")),h=i("+vrP"),b=i("Q04j"),y=i("nPFI");const k="errors",S="warnings";var _={components:{GlAccordion:g.a,GlAccordionItem:h.a,GlAlert:b.a,GlButton:l.a,GlSprintf:y.a},props:{scans:{type:Array,required:!0},type:{type:String,required:!0,validator:function(e){return[k,S].includes(e)}},title:{type:String,required:!0},description:{type:String,required:!0}},computed:{alertVariant(){return{[k]:"danger",[S]:"warning"}[this.type]},scansWithTitles(){var e=this;return this.scans.map((function(t){return{...t,issues:t[e.type],accordionTitle:`${t.name} (${t[e.type].length})`}}))}},DOC_PATH_SECURITY_SCANNER_INTEGRATION_REPORT:f.e},N=i("bPvS"),E=Object(N.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-alert",{attrs:{variant:e.alertVariant,dismissible:!1}},[i("strong",{attrs:{role:"heading"}},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),i("p",{staticClass:"gl-mt-3"},[i("gl-sprintf",{attrs:{message:e.description,"data-testid":"description"},scopedSlots:e._u([{key:"helpPageLink",fn:function(t){var n=t.content;return[i("gl-button",{attrs:{variant:"link",icon:"external-link",href:e.$options.DOC_PATH_SECURITY_SCANNER_INTEGRATION_REPORT,target:"_blank"}},[e._v("\n          "+e._s(n)+"\n        ")])]}}])})],1),e._v(" "),i("gl-accordion",{attrs:{"header-level":3}},e._l(e.scansWithTitles,(function(t){var n=t.name,a=t.issues,r=t.accordionTitle;return i("gl-accordion-item",{key:n,attrs:{title:r}},[i("ul",{staticClass:"gl-pl-4"},e._l(a,(function(t){return i("li",{key:t},[e._v(e._s(t))])})),0)])})),1)],1)}),[],!1,null,null,null).exports;var D={components:{GlAlert:b.a,GlSprintf:y.a,GlButton:l.a},i18n:{reportStatusTitle:Object(m.g)("SecurityReports|Report has expired"),reportExpiredMessage:Object(m.g)("SecurityReports|The security report for this pipeline has %{helpPageLinkStart}expired%{helpPageLinkEnd}. Re-run the pipeline to generate a new security report.")},DOC_PATH_SECURITY_SCANNER_INTEGRATION_RETENTION_PERIOD:f.f},C=Object(N.a)(D,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-alert",{attrs:{variant:"info",dismissible:!1}},[i("strong",{attrs:{role:"heading"}},[e._v(e._s(e.$options.i18n.reportStatusTitle))]),e._v(" "),i("p",{staticClass:"gl-mt-3"},[i("gl-sprintf",{attrs:{message:e.$options.i18n.reportExpiredMessage,"data-testid":"description"},scopedSlots:e._u([{key:"helpPageLink",fn:function(t){var n=t.content;return[i("gl-button",{attrs:{variant:"link",icon:"external-link",href:e.$options.DOC_PATH_SECURITY_SCANNER_INTEGRATION_RETENTION_PERIOD,target:"_blank"}},[e._v("\n          "+e._s(n)+"\n        ")])]}}])})],1)])}),[],!1,null,null,null).exports,O=i("CkNe"),I=i("F9Mj"),T=i("YG98"),j=(i("JHu5"),i("XUYm"),i("USFb")),V=i.n(j),L=i("oj/M"),R=i("mWeI");const w="dismissed",x="all",P=function(e,t){let{commit:i}=e;i("SET_FILTER",V()(Object(L.k)(t),(function(e){return e.map((function(e){return e.toLowerCase()}))})));const[n,a]=Object.values(t);R.a.event(document.body.dataset.page,"set_filter",{label:n,value:a})},A=function(e,t){let{commit:i}=e;const n=t?w:x;i("SET_HIDE_DISMISSED",n),R.a.event(document.body.dataset.page,"set_toggle",{label:"scope",value:n})};var F={namespaced:!0,actions:n,mutations:{SET_FILTER(e,t){e.filters={...e.filters,...t}},SET_HIDE_DISMISSED(e,t){e.filters={...e.filters,scope:t}}},state:function(){return{filters:{scope:"dismissed"}}}},$=i("1AlE"),q=i("RlQ7"),B=i.n(q),M=i("teVv"),G=i("mphk"),U=i("acEF"),H=i("LuMo"),z=i("aSYY");let Q;const W=function(e,t){let{commit:i}=e;return i("SET_PIPELINE_ID",t)},J=function(e,t){let{commit:i}=e;return i("SET_SOURCE_BRANCH",t)},Y=function(e,t){let{commit:i}=e;i("SET_VULNERABILITIES_ENDPOINT",t)},X=function(e,t){let{commit:i}=e;i("SET_VULNERABILITIES_PAGE",t)},K=function(e){let{state:t,dispatch:i}=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.vulnerabilitiesEndpoint&&(i("requestVulnerabilities"),Q&&Q.cancel(),Q=G.a.CancelToken.source(),Object(G.a)({method:"GET",url:t.vulnerabilitiesEndpoint,cancelToken:Q.token,params:n}).then((function(e){const{headers:t,data:n}=e;i("receiveVulnerabilitiesSuccess",{headers:t,data:n})})).catch((function(e){var t;G.a.isCancel(e)||i("receiveVulnerabilitiesError",null==e||null===(t=e.response)||void 0===t?void 0:t.status)})))},Z=function(e){let{commit:t}=e;t("REQUEST_VULNERABILITIES")},ee=function(e,t){let{commit:i}=e,{headers:n,data:a}=t;const r=Object(L.F)(n);i("RECEIVE_VULNERABILITIES_SUCCESS",{pageInfo:Object(L.H)(r),vulnerabilities:a.map((function(e){return{...e,id:e.id||B()("client_"),...e.details&&{details:Object(L.j)(e.details,{deep:!0})}}}))})},te=function(e,t){let{commit:i}=e;i("RECEIVE_VULNERABILITIES_ERROR",t)},ie=function(e){let{commit:t}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t("SET_MODAL_DATA",i)},ne=function(e,t){let{dispatch:i}=e,{vulnerability:n,flashError:a}=t;i("requestCreateIssue"),G.a.post(n.create_vulnerability_feedback_issue_path,{vulnerability_feedback:{feedback_type:z.b,category:n.report_type,project_fingerprint:n.project_fingerprint,finding_uuid:n.uuid,vulnerability_data:{...n,category:n.report_type}}}).then((function(e){let{data:t}=e;i("receiveCreateIssueSuccess",t)})).catch((function(){i("receiveCreateIssueError",{flashError:a})}))},ae=function(e){let{commit:t}=e;t("REQUEST_CREATE_ISSUE")},re=function(e,t){let{commit:i}=e;i("RECEIVE_CREATE_ISSUE_SUCCESS",t)},se=function(e,t){let{commit:i}=e,{flashError:n}=t;i("RECEIVE_CREATE_ISSUE_ERROR"),n&&Object(M.createAlert)({message:Object(m.g)("SecurityReports|There was an error creating the issue."),parent:document.querySelector(".ci-table")})},le=function(e){let{commit:t}=e;t("SELECT_ALL_VULNERABILITIES")},oe=function(e){let{commit:t}=e;t("DESELECT_ALL_VULNERABILITIES")},de=function(e,t){let{commit:i}=e,{id:n}=t;i("SELECT_VULNERABILITY",n)},ce=function(e,t){let{commit:i}=e,{id:n}=t;i("DESELECT_VULNERABILITY",n)},ue=function(e){let{dispatch:t,state:i,rootState:n}=e,{comment:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{filters:r}=n.filters,{vulnerabilities:s,selectedVulnerabilities:l,pageInfo:o}=i,d=s.filter((function(e){let{id:t}=e;return l[t]})),c=(null==o?void 0:o.page)||1,u=s.length-d.length,m=(null==r?void 0:r.scope)===w,v=m&&u<1;t("requestDismissSelectedVulnerabilities");const p=d.map((function(e){return G.a.post(e.create_vulnerability_feedback_dismissal_path,{vulnerability_feedback:{category:e.report_type,comment:a,feedback_type:z.a,project_fingerprint:e.project_fingerprint,finding_uuid:e.uuid,vulnerability_data:{id:e.id}}})}));return Promise.all(p).then((function(){t("receiveDismissSelectedVulnerabilitiesSuccess"),t("fetchVulnerabilities",{...r,page:v?c-1:c})})).catch((function(){t("receiveDismissSelectedVulnerabilitiesError",{flashError:!0})}))},me=function(e){let{commit:t}=e;t("REQUEST_DISMISS_SELECTED_VULNERABILITIES")},ve=function(e){let{commit:t,getters:i}=e;Object(H.a)(Object(m.f)("%d vulnerability dismissed","%d vulnerabilities dismissed",i.selectedVulnerabilitiesCount)),t("RECEIVE_DISMISS_SELECTED_VULNERABILITIES_SUCCESS")},pe=function(e,t){let{commit:i}=e,{flashError:n}=t;i("RECEIVE_DISMISS_SELECTED_VULNERABILITIES_ERROR"),n&&Object(M.createAlert)({message:Object(m.g)("SecurityReports|There was an error dismissing the vulnerabilities."),parent:document.querySelector(".ci-table")})},fe=function(e,t){var i,n;let{dispatch:a,state:r,rootState:s}=e,{vulnerability:l,flashError:o,comment:d}=t;const c=r.pageInfo&&r.pageInfo.page?r.pageInfo.page:1,u=(null===(i=s.filters)||void 0===i||null===(n=i.filters)||void 0===n?void 0:n.scope)===w;a("requestDismissVulnerability");const v=Object(m.h)(u?Object(m.g)("SecurityReports|Dismissed '%{vulnerabilityName}'. Turn off the hide dismissed toggle to view."):Object(m.g)("SecurityReports|Dismissed '%{vulnerabilityName}'"),{vulnerabilityName:l.name}),p=u?{action:{text:Object(m.g)("SecurityReports|Undo dismiss"),onClick:function(e,t){l.dismissal_feedback&&(a("revertDismissVulnerability",{vulnerability:l}).then((function(){return a("fetchVulnerabilities",{page:c})})).catch((function(){})),t.hide())}}}:{};return G.a.post(l.create_vulnerability_feedback_dismissal_path,{vulnerability_feedback:{category:l.report_type,comment:d,feedback_type:z.a,pipeline_id:r.pipelineId,project_fingerprint:l.project_fingerprint,finding_uuid:l.uuid,vulnerability_data:{...l,category:l.report_type}}}).then((function(e){let{data:t}=e;a("closeDismissalCommentBox"),a("receiveDismissVulnerabilitySuccess",{vulnerability:l,data:t}),u&&a("fetchVulnerabilities",{page:1===r.vulnerabilities.length&&c>1?c-1:c}),Object(H.a)(v,p)})).catch((function(){a("receiveDismissVulnerabilityError",{flashError:o})}))},ge=function(e){let{commit:t}=e;t("REQUEST_DISMISS_VULNERABILITY")},he=function(e,t){let{commit:i}=e;i("RECEIVE_DISMISS_VULNERABILITY_SUCCESS",t)},be=function(e,t){let{commit:i}=e,{flashError:n}=t;i("RECEIVE_DISMISS_VULNERABILITY_ERROR"),n&&Object(M.createAlert)({message:Object(m.g)("SecurityReports|There was an error dismissing the vulnerability."),parent:document.querySelector(".ci-table")})},ye=function(e,t){let{dispatch:i}=e,{vulnerability:n,comment:a}=t;i("requestAddDismissalComment");const{dismissal_feedback:r}=n,s=`${n.create_vulnerability_feedback_dismissal_path}/${r.id}`,l=r.comment_details&&r.comment_details.comment?Object(m.h)(Object(m.g)("SecurityReports|Comment edited on '%{vulnerabilityName}'"),{vulnerabilityName:n.name}):Object(m.h)(Object(m.g)("SecurityReports|Comment added to '%{vulnerabilityName}'"),{vulnerabilityName:n.name});return G.a.patch(s,{project_id:r.project_id,id:r.id,comment:a}).then((function(e){let{data:t}=e;i("closeDismissalCommentBox"),i("receiveAddDismissalCommentSuccess",{vulnerability:n,data:t}),Object(H.a)(l)})).catch((function(){i("receiveAddDismissalCommentError")}))},ke=function(e,t){let{dispatch:i}=e,{vulnerability:n}=t;i("requestDeleteDismissalComment");const{dismissal_feedback:a}=n,r=`${n.create_vulnerability_feedback_dismissal_path}/${a.id}`,s=Object(m.h)(Object(m.g)("SecurityReports|Comment deleted on '%{vulnerabilityName}'"),{vulnerabilityName:n.name});return G.a.patch(r,{project_id:a.project_id,comment:""}).then((function(e){let{data:t}=e;const{id:a}=n;i("closeDismissalCommentBox"),i("receiveDeleteDismissalCommentSuccess",{id:a,data:t}),Object(H.a)(s)})).catch((function(){i("receiveDeleteDismissalCommentError")}))},Se=function(e){let{commit:t}=e;t("REQUEST_ADD_DISMISSAL_COMMENT")},_e=function(e,t){let{commit:i}=e;i("RECEIVE_ADD_DISMISSAL_COMMENT_SUCCESS",t)},Ne=function(e){let{commit:t}=e;t("RECEIVE_ADD_DISMISSAL_COMMENT_ERROR")},Ee=function(e){let{commit:t}=e;t("REQUEST_DELETE_DISMISSAL_COMMENT")},De=function(e,t){let{commit:i}=e;i("REQUEST_DELETE_DISMISSAL_COMMENT_SUCCESS",t)},Ce=function(e){let{commit:t}=e;t("RECEIVE_DELETE_DISMISSAL_COMMENT_ERROR")},Oe=function(e){let{commit:t}=e;t("SHOW_DISMISSAL_DELETE_BUTTONS")},Ie=function(e){let{commit:t}=e;t("HIDE_DISMISSAL_DELETE_BUTTONS")},Te=function(e,t){let{dispatch:i}=e,{vulnerability:n,flashError:a}=t;const{destroy_vulnerability_feedback_dismissal_path:r}=n.dismissal_feedback;return i("requestUndoDismiss"),G.a.delete(r).then((function(){i("receiveUndoDismissSuccess",{vulnerability:n})})).catch((function(){i("receiveUndoDismissError",{flashError:a})}))},je=function(e){let{commit:t}=e;t("REQUEST_REVERT_DISMISSAL")},Ve=function(e,t){let{commit:i}=e;i("RECEIVE_REVERT_DISMISSAL_SUCCESS",t)},Le=function(e,t){let{commit:i}=e,{flashError:n}=t;i("RECEIVE_REVERT_DISMISSAL_ERROR"),n&&Object(M.createAlert)({message:Object(m.g)("SecurityReports|There was an error reverting this dismissal."),parent:document.querySelector(".ci-table")})},Re=function(e){let{state:t}=e;const{vulnerability:i}=t.modal;Object(U.a)({fileData:i.remediations[0].diff,fileName:"remediation.patch"})},we=function(e,t){let{state:i,dispatch:n}=e,{vulnerability:a,flashError:r}=t;const{report_type:s,project_fingerprint:l,create_vulnerability_feedback_merge_request_path:o}=a,d=i.sourceBranch;n("requestCreateMergeRequest"),G.a.post(o,{vulnerability_feedback:{feedback_type:z.c,category:s,project_fingerprint:l,finding_uuid:a.uuid,vulnerability_data:{...a,target_branch:d,category:s}}}).then((function(e){let{data:t}=e;n("receiveCreateMergeRequestSuccess",t)})).catch((function(){n("receiveCreateMergeRequestError",{flashError:r})}))},xe=function(e){let{commit:t}=e;t("REQUEST_CREATE_MERGE_REQUEST")},Pe=function(e,t){let{commit:i}=e;i("RECEIVE_CREATE_MERGE_REQUEST_SUCCESS",t)},Ae=function(e,t){let{commit:i}=e,{flashError:n}=t;i("RECEIVE_CREATE_MERGE_REQUEST_ERROR"),n&&Object(M.createAlert)({message:Object(m.g)("SecurityReports|There was an error creating the merge request."),parent:document.querySelector(".ci-table")})},Fe=function(e){let{commit:t}=e;t("OPEN_DISMISSAL_COMMENT_BOX ")},$e=function(e){let{commit:t}=e;t("CLOSE_DISMISSAL_COMMENT_BOX")};var qe=i("zDXb");const Be=function(e){return e.errorLoadingVulnerabilities&&e.errorLoadingVulnerabilitiesCount},Me=function(e){return e.errorLoadingVulnerabilities&&!e.errorLoadingVulnerabilitiesCount},Ge=function(e){return!e.errorLoadingVulnerabilities&&e.errorLoadingVulnerabilitiesCount},Ue=function(e){return e.errorLoadingVulnerabilities&&Object.values(qe.a).includes(e.loadingVulnerabilitiesErrorCode)},He=function(e){return Object.keys(e.selectedVulnerabilities).length},ze=function(e,t){return t.selectedVulnerabilitiesCount>0},Qe=function(e,t){return t.isSelectingVulnerabilities&&t.selectedVulnerabilitiesCount===e.vulnerabilities.length};i("WmlO"),i("W9Nl"),i("0no1"),i("gdbl");var We=i("q+nE"),Je=i("yYHy"),Ye=i("pY+i"),Xe=i.n(Ye);const Ke=function(e){return Boolean(e&&e.location&&e.identifiers&&e.identifiers[0])},Ze=function(e,t){if(!Ke(e)||!Ke(t))return!1;let i=!1;return i=e.location_fingerprint&&t.location_fingerprint?e.location_fingerprint===t.location_fingerprint:Xe()(e.location,t.location),i&&Xe()(e.identifiers[0],t.identifiers[0])};var et={namespaced:!0,state:function(){return{isLoadingVulnerabilities:!0,errorLoadingVulnerabilities:!1,loadingVulnerabilitiesErrorCode:null,vulnerabilities:[],errorLoadingVulnerabilitiesCount:!1,vulnerabilitiesCount:{},pageInfo:{},pipelineId:null,vulnerabilitiesEndpoint:null,activeVulnerability:null,sourceBranch:null,modal:{vulnerability:{},project:{},isCommentingOnDismissal:!1,isShowingDeleteButtons:!1},isDismissingVulnerability:!1,isDismissingVulnerabilities:!1,selectedVulnerabilities:{},isCreatingIssue:!1,isCreatingMergeRequest:!1}},mutations:{SET_PIPELINE_ID(e,t){e.pipelineId=t},SET_SOURCE_BRANCH(e,t){e.sourceBranch=t},SET_VULNERABILITIES_ENDPOINT(e,t){e.vulnerabilitiesEndpoint=t},REQUEST_VULNERABILITIES(e){e.isLoadingVulnerabilities=!0,e.errorLoadingVulnerabilities=!1,e.loadingVulnerabilitiesErrorCode=null},RECEIVE_VULNERABILITIES_SUCCESS(e,t){e.isLoadingVulnerabilities=!1,e.pageInfo=t.pageInfo,e.vulnerabilities=t.vulnerabilities,e.selectedVulnerabilities={}},RECEIVE_VULNERABILITIES_ERROR(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.isLoadingVulnerabilities=!1,e.errorLoadingVulnerabilities=!0,e.loadingVulnerabilitiesErrorCode=t},SET_VULNERABILITIES_PAGE(e,t){e.pageInfo={...e.pageInfo,page:t}},SET_MODAL_DATA(e,t){var i,n;const{vulnerability:a}=t;We.default.set(e.modal,"title",a.name),We.default.set(e.modal.project,"value",null===(i=a.project)||void 0===i?void 0:i.full_name),We.default.set(e.modal.project,"url",null===(n=a.project)||void 0===n?void 0:n.full_path),We.default.set(e.modal,"vulnerability",a),We.default.set(e.modal.vulnerability,"hasIssue",Boolean(a.issue_feedback&&a.issue_feedback.issue_iid)),We.default.set(e.modal.vulnerability,"hasMergeRequest",Boolean(a.merge_request_feedback&&a.merge_request_feedback.merge_request_iid)),We.default.set(e.modal.vulnerability,"isDismissed",Boolean(a.dismissal_feedback)),We.default.set(e.modal,"error",null),We.default.set(e.modal,"isCommentingOnDismissal",!1)},REQUEST_CREATE_ISSUE(e){e.isCreatingIssue=!0,We.default.set(e.modal,"error",null)},RECEIVE_CREATE_ISSUE_SUCCESS(e,t){Object(Je.Q)(t.issue_url)},RECEIVE_CREATE_ISSUE_ERROR(e){e.isCreatingIssue=!1,We.default.set(e.modal,"error",Object(m.a)("There was an error creating the issue"))},REQUEST_DISMISS_VULNERABILITY(e){e.isDismissingVulnerability=!0,We.default.set(e.modal,"error",null)},RECEIVE_DISMISS_VULNERABILITY_SUCCESS(e,t){e.vulnerabilities.find((function(e){return Ze(e,t.vulnerability)})).dismissal_feedback=t.data,e.isDismissingVulnerability=!1,We.default.set(e.modal.vulnerability,"isDismissed",!0)},RECEIVE_DISMISS_VULNERABILITY_ERROR(e){e.isDismissingVulnerability=!1,We.default.set(e.modal,"error",Object(m.g)("SecurityReports|There was an error dismissing the vulnerability."))},REQUEST_DISMISS_SELECTED_VULNERABILITIES(e){e.isDismissingVulnerabilities=!0},RECEIVE_DISMISS_SELECTED_VULNERABILITIES_SUCCESS(e){e.isDismissingVulnerabilities=!1,e.selectedVulnerabilities={}},RECEIVE_DISMISS_SELECTED_VULNERABILITIES_ERROR(e){e.isDismissingVulnerabilities=!1},SELECT_VULNERABILITY(e,t){e.selectedVulnerabilities[t]||We.default.set(e.selectedVulnerabilities,t,!0)},DESELECT_VULNERABILITY(e,t){We.default.delete(e.selectedVulnerabilities,t)},SELECT_ALL_VULNERABILITIES(e){e.selectedVulnerabilities=e.vulnerabilities.reduce((function(e,t){let{id:i}=t;return Object.assign(e,{[i]:!0})}),{})},DESELECT_ALL_VULNERABILITIES(e){e.selectedVulnerabilities={}},REQUEST_ADD_DISMISSAL_COMMENT(e){e.isDismissingVulnerability=!0,We.default.set(e.modal,"error",null)},RECEIVE_ADD_DISMISSAL_COMMENT_SUCCESS(e,t){const i=e.vulnerabilities.find((function(e){return Ze(e,t.vulnerability)}));i&&(i.dismissal_feedback=t.data,e.isDismissingVulnerability=!1,We.default.set(e.modal.vulnerability,"isDismissed",!0))},RECEIVE_ADD_DISMISSAL_COMMENT_ERROR(e){e.isDismissingVulnerability=!1,We.default.set(e.modal,"error",Object(m.g)("SecurityReports|There was an error adding the comment."))},REQUEST_DELETE_DISMISSAL_COMMENT(e){e.isDismissingVulnerability=!0,We.default.set(e.modal,"error",null)},REQUEST_DELETE_DISMISSAL_COMMENT_SUCCESS(e,t){const i=e.vulnerabilities.find((function(e){return e.id===t.id}));i&&(i.dismissal_feedback=t.data,e.isDismissingVulnerability=!1,We.default.set(e.modal.vulnerability,"isDismissed",!0))},RECEIVE_DELETE_DISMISSAL_COMMENT_ERROR(e){e.isDismissingVulnerability=!1,We.default.set(e.modal,"error",Object(m.g)("SecurityReports|There was an error deleting the comment."))},REQUEST_REVERT_DISMISSAL(e){e.isDismissingVulnerability=!0,We.default.set(e.modal,"error",null)},RECEIVE_REVERT_DISMISSAL_SUCCESS(e,t){e.vulnerabilities.find((function(e){return Ze(e,t.vulnerability)})).dismissal_feedback=null,e.isDismissingVulnerability=!1,We.default.set(e.modal.vulnerability,"isDismissed",!1)},RECEIVE_REVERT_DISMISSAL_ERROR(e){e.isDismissingVulnerability=!1,We.default.set(e.modal,"error",Object(m.g)("SecurityReports|There was an error reverting the dismissal."))},SHOW_DISMISSAL_DELETE_BUTTONS(e){We.default.set(e.modal,"isShowingDeleteButtons",!0)},HIDE_DISMISSAL_DELETE_BUTTONS(e){We.default.set(e.modal,"isShowingDeleteButtons",!1)},REQUEST_CREATE_MERGE_REQUEST(e){e.isCreatingMergeRequest=!0,We.default.set(e.modal,"error",null)},RECEIVE_CREATE_MERGE_REQUEST_SUCCESS(e,t){Object(Je.Q)(t.merge_request_path)},RECEIVE_CREATE_MERGE_REQUEST_ERROR(e){e.isCreatingIssue=!1,e.isCreatingMergeRequest=!1,We.default.set(e.modal,"error",Object(m.g)("security Reports|There was an error creating the merge request"))},"OPEN_DISMISSAL_COMMENT_BOX "(e){We.default.set(e.modal,"isCommentingOnDismissal",!0)},CLOSE_DISMISSAL_COMMENT_BOX(e){We.default.set(e.modal,"isShowingDeleteButtons",!1),We.default.set(e.modal,"isCommentingOnDismissal",!1),We.default.set(e.modal,"isShowingDeleteButtons",!1)}},getters:r,actions:a};const tt=["filters/SET_FILTER","filters/SET_HIDE_DISMISSED"];const it=function(e){!function(e){e.subscribe((function(t){let{type:i}=t;tt.includes(i)&&e.dispatch("vulnerabilities/fetchVulnerabilities",e.state.filters.filters)}))}(e),Object.entries({filters:F,vulnerabilities:et,pipelineJobs:$.a}).forEach((function(t){let[i,n]=t;e.registerModule(i,n)}))};var nt=i("3saJ"),at=i("uSzn"),rt=i("RwX1"),st={operationalTabParameter:"operational",i18n:{developmentTab:Object(m.g)("SecurityReports|Development vulnerabilities"),operationalTab:Object(m.g)("SecurityReports|Operational vulnerabilities")},components:{GlTabs:nt.a,GlTab:at.a},mixins:[Object(v.a)()],inject:["dashboardType"],computed:{hasHeaderSlot(){return Boolean(this.$slots.header)},hasStickySlot(){return Boolean(this.$slots.sticky)},hasSummarySlot(){return Boolean(this.$slots.summary)},isProject(){return this.dashboardType===rt.a.PROJECT},shouldShowTabs(){return this.dashboardType!==rt.a.PIPELINE}}},lt=Object(N.a)(st,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[e.hasHeaderSlot?i("header",[e._t("header")],2):e._e(),e._v(" "),e.shouldShowTabs?i("gl-tabs",{attrs:{"sync-active-tab-with-query-params":"","content-class":{"gl-pt-0":e.isProject,"gl-pt-7":!e.isProject},"nav-class":"gl-mt-3"}},[i("gl-tab",{attrs:{title:e.$options.i18n.developmentTab}},[e.hasSummarySlot?i("section",{attrs:{"data-testid":"summary-section"}},[e._t("summary")],2):e._e(),e._v(" "),e.hasStickySlot?i("section",{staticClass:"position-sticky gl-z-index-3 security-dashboard-filters",attrs:{"data-testid":"sticky-section"}},[e._t("sticky")],2):e._e(),e._v(" "),i("div",{staticClass:"row mt-4"},[i("article",{staticClass:"col"},[e._t("default")],2)])]),e._v(" "),i("gl-tab",{attrs:{title:e.$options.i18n.operationalTab,"query-param-value":e.$options.operationalTabParameter}},[e._t("operational-empty-state")],2)],1):[e.hasSummarySlot?i("section",{staticClass:"gl-pt-7",attrs:{"data-testid":"summary-section"}},[e._t("summary")],2):e._e(),e._v(" "),e.hasStickySlot?i("section",{staticClass:"position-sticky gl-z-index-3 security-dashboard-filters",attrs:{"data-testid":"sticky-section"}},[e._t("sticky")],2):e._e(),e._v(" "),i("div",{staticClass:"row mt-4"},[i("article",{staticClass:"col"},[e._t("default")],2)])]],2)}),[],!1,null,null,null).exports,ot=i("meSH"),dt=i("HDPV"),ct=i("rEpW"),ut={i18n:{toggleLabel:Object(m.g)("SecurityReports|Hide dismissed")},components:{SimpleFilter:ct.a,GlToggle:ot.a},data:()=>({filterConfigs:[dt.i,dt.k]}),computed:{...Object(O.f)("filters",["filters"]),hideDismissed:{set(e){this.setHideDismissed(e)},get(){return this.filters.scope===w}}},methods:{...Object(O.c)("filters",["setFilter","setHideDismissed"])}},mt=Object(N.a)(ut,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dashboard-filters border-bottom bg-gray-light"},[i("div",{staticClass:"row mx-0 p-2"},[e._l(e.filterConfigs,(function(t){return i("simple-filter",{key:t.id,staticClass:"col-sm-6 col-md-4 col-lg-2 p-2 js-filter",attrs:{filter:t,"data-testid":t.id},on:{"filter-changed":e.setFilter}})})),e._v(" "),i("div",{staticClass:"gl-display-flex ml-lg-auto p-2"},[e._t("buttons"),e._v(" "),i("div",{staticClass:"pl-md-6 gl-pt-1"},[i("gl-toggle",{attrs:{"data-qa-selector":"findings_hide_dismissed_toggle",label:e.$options.i18n.toggleLabel},model:{value:e.hideDismissed,callback:function(t){e.hideDismissed=t},expression:"hideDismissed"}})],1)],2)],2)])}),[],!1,null,null,null).exports;const vt=Object(m.g)("SecurityReports|Security reports can only be accessed by authorized users.");var pt={emptyStatePropsMap:{[qe.a.UNAUTHORIZED]:{title:Object(m.g)("SecurityReports|You must sign in as an authorized user to see this report"),description:vt,primaryButtonText:Object(m.a)("Sign in"),primaryButtonLink:"/users/sign_in"},[qe.a.FORBIDDEN]:{title:Object(m.g)("SecurityReports|You do not have sufficient permissions to access this report"),description:vt}},components:{GlEmptyState:s.a},props:{errorCode:{type:Number,required:!0,validator:function(e){return Object.values(qe.a).includes(e)}},illustrations:{type:Object,required:!1,default:function(){return{}}}}},ft=Object(N.a)(pt,(function(){var e=this.$createElement;return(this._self._c||e)("gl-empty-state",this._b({},"gl-empty-state",Object.assign({},this.$options.emptyStatePropsMap[this.errorCode],{svgPath:this.illustrations[this.errorCode]}),!1))}),[],!1,null,null,null).exports,gt=i("Cbzh"),ht=i("OkA1"),bt=i("+Gy1"),yt=i("Fj12"),kt=i("H8gz"),St=i("0sqQ"),_t=i("hY08"),Nt=i("aPPG"),Et=i("BC1l"),Dt=i("/LsX"),Ct=i("ly/8");var Ot={i18n:{moreInfo:Object(m.g)("SecurityReports|More info"),createIssue:Object(m.g)("SecurityReports|Create issue"),createJiraIssue:Object(m.g)("SecurityReports|Create Jira issue"),revertDismissVulnerability:Object(m.g)("SecurityReports|Undo dismiss"),dismissVulnerability:Object(m.g)("SecurityReports|Dismiss vulnerability")},name:"SecurityDashboardActionButtons",components:{GlButton:l.a},directives:{GlTooltip:Ct.a},props:{vulnerability:{type:Object,required:!0},canCreateIssue:{type:Boolean,required:!1,default:!1},canDismissVulnerability:{type:Boolean,required:!1,default:!1},isDismissed:{type:Boolean,required:!1,default:!1}},computed:{...Object(O.f)("vulnerabilities",["isCreatingIssue","isDismissingVulnerability"]),isJiraVulnerabilityIssuesEnabled(){var e;return Boolean(null==this||null===(e=this.vulnerability)||void 0===e?void 0:e.create_jira_issue_url)},createIssueButtonLabel(){const{$options:e}=this;return this.isJiraVulnerabilityIssuesEnabled?e.i18n.createJiraIssue:e.i18n.createIssue}},methods:{...Object(O.c)("vulnerabilities",["setModalData","createIssue","dismissVulnerability","revertDismissVulnerability"]),handleCreateIssue(){const{vulnerability:e}=this;this.isJiraVulnerabilityIssuesEnabled?this.createNewJiraIssue(e):this.createIssue({vulnerability:e,flashError:!0})},createNewJiraIssue(e){let{create_jira_issue_url:t}=e;Object(Je.Q)(t,!0)},handleDismissVulnerability(){const{vulnerability:e}=this;this.dismissVulnerability({vulnerability:e,flashError:!0})},handleUndoDismiss(){const{vulnerability:e}=this;this.revertDismissVulnerability({vulnerability:e,flashError:!0})},openModal(e){this.setModalData(e),this.$root.$emit(Dt.e,St.d)}}},It=Object(N.a)(Ot,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],key:"more-info",staticClass:"js-more-info",attrs:{"aria-label":e.$options.i18n.moreInfo,title:e.$options.i18n.moreInfo,variant:"default",category:"tertiary",icon:"information-o","data-testid":"more-info","data-qa-selector":"finding_more_info_button","data-qa-finding-name":e.vulnerability.name},on:{click:function(t){return e.openModal({vulnerability:e.vulnerability})}}}),e._v(" "),e.canCreateIssue?i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],key:"create-issue",staticClass:"js-create-issue gl-ml-3",attrs:{"aria-label":e.createIssueButtonLabel,loading:e.isCreatingIssue,title:e.createIssueButtonLabel,variant:"default",category:"tertiary",icon:"issue-new","data-testid":"create-issue","data-qa-selector":"finding_create_issue_button","data-qa-finding-name":e.vulnerability.name},on:{click:e.handleCreateIssue}}):e._e(),e._v(" "),e.canDismissVulnerability?[e.isDismissed?i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],key:"undo-dismiss",staticClass:"js-undo-dismiss gl-ml-3",attrs:{"aria-label":e.$options.i18n.revertDismissVulnerability,loading:e.isDismissingVulnerability,title:e.$options.i18n.revertDismissVulnerability,variant:"default",category:"tertiary",icon:"redo","data-testid":"undo-dismiss","data-qa-selector":"finding_undo_dismiss_button","data-qa-finding-name":e.vulnerability.name},on:{click:e.handleUndoDismiss}}):i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],key:"dismiss-vulnerability",staticClass:"js-dismiss-vulnerability gl-ml-3",attrs:{"aria-label":e.$options.i18n.dismissVulnerability,loading:e.isDismissingVulnerability,title:e.$options.i18n.dismissVulnerability,variant:"default",category:"tertiary",icon:"cancel","data-qa-selector":"finding_dismiss_symbol_button","data-qa-finding-name":e.vulnerability.name,"data-testid":"dismiss-vulnerability"},on:{click:e.handleDismissVulnerability}})]:e._e()],2)}),[],!1,null,null,null).exports,Tt={name:"VulnerabilityIssueLink",components:{GlIcon:kt.a},directives:{GlTooltip:Ct.a},props:{issue:{type:Object,required:!0},projectName:{type:String,required:!0}},computed:{linkText(){return`${this.projectName}#${this.issue.issue_iid}`}}},jt=Object(N.a)(Tt,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"d-inline"},[t("gl-icon",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"text-success vertical-align-middle",attrs:{name:"issues",title:this.s__("SecurityReports|Issue Created")}}),this._v(" "),t("a",{staticClass:"vertical-align-middle",attrs:{href:this.issue.issue_url}},[this._v(this._s(this.linkText))])],1)}),[],!1,null,null,null).exports,Vt={name:"SecurityDashboardTableRow",components:{GlButton:l.a,GlFormCheckbox:ht.a,GlSkeletonLoader:yt.a,GlSprintf:y.a,GlIcon:kt.a,SeverityBadge:_t.a,VulnerabilityActionButtons:It,VulnerabilityIssueLink:jt},props:{vulnerability:{type:Object,required:!1,default:function(){return{}}},isLoading:{type:Boolean,required:!1,default:!1}},computed:{...Object(O.f)("vulnerabilities",["selectedVulnerabilities"]),vulnerabilityIdentifier(){return Object(Et.a)(this.vulnerability.identifiers,"external_type")},vulnerabilityNamespace(){const{location:e}=this.vulnerability;return e&&(e.image||e.file||e.path)},isDismissed(){return Boolean(this.vulnerability.dismissal_feedback)},hasIssue(){return Boolean(this.vulnerability.issue_feedback&&this.vulnerability.issue_feedback.issue_iid)},canDismissVulnerability(){const e=this.vulnerability.create_vulnerability_feedback_dismissal_path;return Boolean(e)},canCreateIssue(){const{create_vulnerability_feedback_issue_path:e,create_jira_issue_url:t}=this.vulnerability;return Boolean(e||t)&&!this.hasIssue},extraIdentifierCount(){const{identifiers:e}=this.vulnerability;return e?e.length-1:0},isSelected(){return Boolean(this.selectedVulnerabilities[this.vulnerability.id])},shouldShowExtraIdentifierCount(){return this.extraIdentifierCount>0},useConvertReportType(){return Object(Nt.a)(this.vulnerability.report_type)},vulnerabilityVendor(){var e;return null===(e=this.vulnerability.scanner)||void 0===e?void 0:e.vendor}},methods:{...Object(O.c)("vulnerabilities",["setModalData","selectVulnerability","deselectVulnerability"]),toggleVulnerability(){return this.isSelected?this.deselectVulnerability(this.vulnerability):this.selectVulnerability(this.vulnerability)},openModal(e){this.setModalData(e),this.$root.$emit(Dt.e,St.d)}}},Lt=Object(N.a)(Vt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"gl-responsive-table-row p-2",class:{dismissed:e.isDismissed,"gl-bg-blue-50":e.isSelected}},[i("div",{staticClass:"table-section section-5"},[i("gl-form-checkbox",{staticClass:"my-0 ml-1 mr-3",attrs:{checked:e.isSelected,inline:!0,"data-qa-selector":"security_finding_checkbox","data-qa-finding-name":e.vulnerability.name},on:{change:e.toggleVulnerability}})],1),e._v(" "),i("div",{staticClass:"table-section section-15"},[i("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("Reports|Severity")))]),e._v(" "),i("div",{staticClass:"table-mobile-content"},[e.vulnerability.severity?i("severity-badge",{staticClass:"text-right text-md-left",attrs:{severity:e.vulnerability.severity}}):e._e()],1)]),e._v(" "),i("div",{staticClass:"table-section flex-grow-1"},[i("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("Reports|Vulnerability")))]),e._v(" "),i("div",{staticClass:"table-mobile-content gl-white-space-normal",attrs:{"data-qa-selector":"vulnerability_info_content"}},[e.isLoading?i("gl-skeleton-loader",{attrs:{lines:2}}):[i("gl-button",{ref:"vulnerability-title",staticClass:"text-body gl-display-grid",attrs:{"button-text-classes":"gl-text-left gl-white-space-normal! gl-pr-4!",variant:"link","data-qa-selector":"security_finding_name_button","data-qa-status-description":e.vulnerability.name},on:{click:function(t){return e.openModal({vulnerability:e.vulnerability})}}},[e._v(e._s(e.vulnerability.name))]),e._v(" "),e.isDismissed?[i("gl-icon",{directives:[{name:"show",rawName:"v-show",value:e.vulnerability.dismissal_feedback.comment_details,expression:"vulnerability.dismissal_feedback.comment_details"}],staticClass:"text-warning vertical-align-middle",attrs:{name:"comment"}}),e._v(" "),i("span",{staticClass:"vertical-align-middle text-uppercase"},[e._v(e._s(e.s__("vulnerability|dismissed")))])]:e._e(),e._v(" "),e.hasIssue?i("vulnerability-issue-link",{staticClass:"text-nowrap",attrs:{issue:e.vulnerability.issue_feedback,"project-name":e.vulnerability.project.name}}):e._e(),e._v(" "),e.vulnerabilityNamespace?i("small",{staticClass:"gl-text-gray-500 gl-word-break-all"},[e._v("\n          "+e._s(e.vulnerabilityNamespace)+"\n        ")]):e._e()]],2)]),e._v(" "),i("div",{staticClass:"table-section gl-white-space-normal section-15"},[i("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("Reports|Identifier")))]),e._v(" "),i("div",{staticClass:"table-mobile-content"},[i("div",{staticClass:"gl-text-overflow-ellipsis gl-overflow-hidden",attrs:{title:e.vulnerabilityIdentifier}},[e._v("\n        "+e._s(e.vulnerabilityIdentifier)+"\n      ")]),e._v(" "),e.shouldShowExtraIdentifierCount?i("div",{staticClass:"gl-text-gray-300"},[i("gl-sprintf",{attrs:{message:e.__("+ %{count} more")},scopedSlots:e._u([{key:"count",fn:function(){return[e._v("\n            "+e._s(e.extraIdentifierCount)+"\n          ")]},proxy:!0}],null,!1,1010436777)})],1):e._e()])]),e._v(" "),i("div",{staticClass:"table-section section-15"},[i("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("Reports|Scanner")))]),e._v(" "),i("div",{staticClass:"table-mobile-content"},[i("div",{staticClass:"text-capitalize"},[e._v("\n        "+e._s(e.useConvertReportType)+"\n      ")]),e._v(" "),e.vulnerabilityVendor?i("div",{staticClass:"gl-text-gray-300",attrs:{"data-testid":"vulnerability-vendor"}},[e._v("\n        "+e._s(e.vulnerabilityVendor)+"\n      ")]):e._e()])]),e._v(" "),i("div",{staticClass:"table-section section-20"},[i("div",{staticClass:"table-mobile-header",attrs:{role:"rowheader"}},[e._v(e._s(e.s__("Reports|Actions")))]),e._v(" "),i("div",{staticClass:"table-mobile-content action-buttons d-flex justify-content-end"},[e.isLoading?e._e():i("vulnerability-action-buttons",{attrs:{vulnerability:e.vulnerability,"can-create-issue":e.canCreateIssue,"can-dismiss-vulnerability":e.canDismissVulnerability,"is-dismissed":e.isDismissed}})],1)])])}),[],!1,null,null,null).exports,Rt=i("xFu9");const wt=Object(m.a)("[No reason]"),xt=Object(m.a)("Won't fix / Accept risk"),Pt=Object(m.a)("False positive");var At={name:"SelectionSummary",components:{GlButton:l.a,GlFormSelect:Rt.a},data:()=>({dismissalReason:null}),computed:{...Object(O.d)("vulnerabilities",["selectedVulnerabilitiesCount"]),canDismissVulnerability(){return this.dismissalReason&&this.selectedVulnerabilitiesCount>0},message(){return Object(m.f)("Dismiss %d selected vulnerability as","Dismiss %d selected vulnerabilities as",this.selectedVulnerabilitiesCount)}},methods:{...Object(O.c)("vulnerabilities",["dismissSelectedVulnerabilities"]),handleDismiss(){this.canDismissVulnerability&&(this.dismissalReason===wt?this.dismissSelectedVulnerabilities():this.dismissSelectedVulnerabilities({comment:this.dismissalReason}))}},dismissalReasons:[{value:null,text:Object(m.a)("Select a reason")},Pt,xt,wt]},Ft=Object(N.a)(At,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"card"},[i("form",{staticClass:"card-body d-flex align-items-center",on:{submit:function(t){return t.preventDefault(),e.handleDismiss.apply(null,arguments)}}},[i("span",{attrs:{"data-testid":"dismiss-message"}},[e._v(e._s(e.message))]),e._v(" "),i("gl-form-select",{staticClass:"mx-3 w-auto",attrs:{"data-qa-selector":"finding_dismissal_reason",options:e.$options.dismissalReasons},model:{value:e.dismissalReason,callback:function(t){e.dismissalReason=t},expression:"dismissalReason"}}),e._v(" "),i("gl-button",{attrs:{type:"submit","data-qa-selector":"finding_dismiss_button",disabled:!e.canDismissVulnerability}},[e._v("\n      "+e._s(e.__("Dismiss selected"))+"\n    ")])],1)])}),[],!1,null,null,null).exports,$t={name:"SecurityDashboardTable",components:{GlAlert:b.a,GlCollapse:gt.a,GlEmptyState:s.a,GlFormCheckbox:ht.a,Pagination:bt.a,SecurityDashboardTableRow:Lt,SelectionSummary:Ft},computed:{...Object(O.f)("vulnerabilities",["errorLoadingVulnerabilities","errorLoadingVulnerabilitiesCount","isLoadingVulnerabilities","isDismissingVulnerabilities","pageInfo","vulnerabilities"]),...Object(O.f)("filters",["filters"]),...Object(O.d)("vulnerabilities",["dashboardListError","hasSelectedAllVulnerabilities","isSelectingVulnerabilities"]),showEmptyState(){return this.vulnerabilities&&!this.vulnerabilities.length&&!this.errorLoadingVulnerabilities&&!this.errorLoadingVulnerabilitiesCount},showPagination(){return this.pageInfo&&this.pageInfo.total}},methods:{...Object(O.c)("vulnerabilities",["deselectAllVulnerabilities","fetchVulnerabilities","selectAllVulnerabilities"]),fetchPage(e){this.fetchVulnerabilities({...this.filters,page:e})},handleSelectAll(){return this.hasSelectedAllVulnerabilities?this.deselectAllVulnerabilities():this.selectAllVulnerabilities()}}},qt=Object(N.a)($t,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ci-table js-security-dashboard-table",attrs:{"data-qa-selector":"security_report_content"}},[i("gl-collapse",{attrs:{visible:e.isSelectingVulnerabilities,"data-testid":"selection-summary-collapse"}},[i("selection-summary")],1),e._v(" "),i("div",{staticClass:"gl-responsive-table-row table-row-header gl-bg-gray-50 text-2 px-2",attrs:{role:"row"}},[i("div",{staticClass:"table-section section-5"},[i("gl-form-checkbox",{staticClass:"my-0 ml-1 mr-3",attrs:{checked:e.hasSelectedAllVulnerabilities},on:{change:e.handleSelectAll}})],1),e._v(" "),i("div",{staticClass:"table-section section-15",attrs:{role:"rowheader"}},[e._v("\n      "+e._s(e.s__("Reports|Severity"))+"\n    ")]),e._v(" "),i("div",{staticClass:"table-section flex-grow-1",attrs:{role:"rowheader"}},[e._v("\n      "+e._s(e.s__("Reports|Vulnerability"))+"\n    ")]),e._v(" "),i("div",{staticClass:"table-section section-15",attrs:{role:"rowheader"}},[e._v("\n      "+e._s(e.s__("Reports|Identifier"))+"\n    ")]),e._v(" "),i("div",{staticClass:"table-section section-15",attrs:{role:"rowheader"}},[e._v("\n      "+e._s(e.s__("Reports|Tool"))+"\n    ")]),e._v(" "),i("div",{staticClass:"table-section section-20",attrs:{role:"rowheader"}})]),e._v(" "),e.dashboardListError?i("gl-alert",{staticClass:"gl-mt-3",attrs:{variant:"danger",dismissible:!1}},[e._v("\n    "+e._s(e.s__("SecurityReports|Error fetching the vulnerability list. Please check your network connection and try again."))+"\n  ")]):e._e(),e._v(" "),e.isLoadingVulnerabilities||e.isDismissingVulnerabilities?e._l(10,(function(e){return i("security-dashboard-table-row",{key:e,attrs:{"is-loading":!0}})})):[e._l(e.vulnerabilities,(function(e){return i("security-dashboard-table-row",{key:e.id,attrs:{vulnerability:e}})})),e._v(" "),e.showEmptyState?e._t("empty-state",(function(){return[i("gl-empty-state",{attrs:{title:e.__("We've found no vulnerabilities"),description:e.__("While it's rare to have no vulnerabilities, it can happen. In any event, we ask that you please double check your settings to make sure you've set up your dashboard correctly.")}})]})):e._e(),e._v(" "),e.showPagination?i("pagination",{staticClass:"justify-content-center gl-mt-3",attrs:{change:e.fetchPage,"page-info":e.pageInfo}}):e._e()]],2)}),[],!1,null,null,null).exports,Bt={components:{Filters:mt,IssueModal:I.a,VulnerabilityReportLayout:lt,SecurityDashboardTable:qt,LoadingError:ft},mixins:[Object(T.a)("vulnerabilities")],inject:["pipeline","projectId"],props:{vulnerabilitiesEndpoint:{type:String,required:!0},pipelineId:{type:Number,required:!1,default:null},securityReportSummary:{type:Object,required:!1,default:function(){return{}}},loadingErrorIllustrations:{type:Object,required:!1,default:function(){return{}}}},computed:{...Object(O.f)("vulnerabilities",["modal","pageInfo","loadingVulnerabilitiesErrorCode","isCreatingIssue","isDismissingVulnerability","isCreatingMergeRequest"]),...Object(O.f)("pipelineJobs",["projectId"]),...Object(O.f)("filters",["filters"]),...Object(O.d)("vulnerabilities",["loadingVulnerabilitiesFailedWithRecognizedErrorCode"]),canCreateIssue(){const e=this.vulnerability.create_vulnerability_feedback_issue_path,t=this.vulnerability.create_jira_issue_url;return Boolean(e||t)},canDismissVulnerability(){const e=this.vulnerability.create_vulnerability_feedback_dismissal_path;return Boolean(e)},vulnerability(){return this.modal.vulnerability}},created(){it(this.$store),this.setSourceBranch(this.pipeline.sourceBranch),this.setPipelineJobsPath(this.pipeline.jobsPath),this.setProjectId(this.projectId),this.setPipelineId(this.pipelineId),this.setVulnerabilitiesEndpoint(this.vulnerabilitiesEndpoint),this.fetchPipelineJobs()},methods:{...Object(O.c)("vulnerabilities",["setSourceBranch","closeDismissalCommentBox","createIssue","createMergeRequest","openDismissalCommentBox","setPipelineId","setVulnerabilitiesEndpoint","showDismissalDeleteButtons","hideDismissalDeleteButtons","downloadPatch"]),...Object(O.c)("pipelineJobs",["setPipelineJobsPath","setProjectId","fetchPipelineJobs"]),...Object(O.c)("filters",["lockFilter","setHideDismissedToggleInitialState"])}},Mt=Object(N.a)(Bt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[e.loadingVulnerabilitiesFailedWithRecognizedErrorCode?i("loading-error",{attrs:{"error-code":e.loadingVulnerabilitiesErrorCode,illustrations:e.loadingErrorIllustrations}}):[i("vulnerability-report-layout",{scopedSlots:e._u([{key:"header",fn:function(){return[i("filters")]},proxy:!0}])},[e._v(" "),i("security-dashboard-table",{scopedSlots:e._u([{key:"empty-state",fn:function(){return[e._t("empty-state")]},proxy:!0}],null,!0)})],1),e._v(" "),i("issue-modal",{attrs:{modal:e.modal,"can-create-issue":e.canCreateIssue,"can-dismiss-vulnerability":e.canDismissVulnerability,"is-creating-issue":e.isCreatingIssue,"is-dismissing-vulnerability":e.isDismissingVulnerability,"is-creating-merge-request":e.isCreatingMergeRequest},on:{addDismissalComment:function(t){return e.handleAddDismissalComment({vulnerability:e.vulnerability,comment:t})},editVulnerabilityDismissalComment:e.openDismissalCommentBox,showDismissalDeleteButtons:e.showDismissalDeleteButtons,hideDismissalDeleteButtons:e.hideDismissalDeleteButtons,deleteDismissalComment:function(t){return e.handleDeleteDismissalComment({vulnerability:e.vulnerability})},closeDismissalCommentBox:e.closeDismissalCommentBox,createMergeRequest:function(t){return e.createMergeRequest({vulnerability:e.vulnerability})},createNewIssue:function(t){return e.createIssue({vulnerability:e.vulnerability})},dismissVulnerability:function(t){return e.handleDismissVulnerability({vulnerability:e.vulnerability,comment:t})},openDismissalCommentBox:e.openDismissalCommentBox,revertDismissVulnerability:function(t){return e.handleRevertDismissVulnerability({vulnerability:e.vulnerability})},downloadPatch:function(t){return e.downloadPatch({vulnerability:e.vulnerability})}}})]],2)}),[],!1,null,null,null).exports,Gt=i("Etn4"),Ut=i("D2CV"),Ht=i("qINL"),zt=i("7fsO"),Qt=i("xqp2"),Wt=i("vRHk"),Jt=i("/L57"),Yt=i("G+28"),Xt={name:"SecurityReportsSummary",components:{GlButton:l.a,GlCard:Gt.a,GlCollapse:gt.a,GlSprintf:y.a,Modal:zt.a,SecurityReportDownloadDropdown:Jt.a},directives:{collapseToggle:Ut.e,GlModal:Ht.a},props:{summary:{type:Object,required:!0},jobs:{type:Array,required:!1,default:function(){return[]}}},i18n:{scannedResources:Object(m.g)("SecurityReports|scanned resources"),scanDetails:Object(m.g)("SecurityReports|Scan details"),downloadUrls:Object(m.g)("SecurityReports|Download scanned URLs"),downloadResults:Object(m.g)("SecurityReports|Download results"),hideDetails:Object(m.a)("Hide details"),showDetails:Object(m.a)("Show details"),vulnerabilities:function(e){return Object(m.f)("%d vulnerability","%d vulnerabilities",e)},scannedUrls:function(e){return Object(m.f)("%d URL scanned","%d URLs scanned",e)}},data:()=>({isVisible:!0}),computed:{collapseButtonLabel(){return this.isVisible?this.$options.i18n.hideDetails:this.$options.i18n.showDetails},formattedSummary(){return Object(dt.f)(this.summary)}},watch:{isVisible(e){this.localStorageUsable&&(e?localStorage.removeItem(f.a):localStorage.setItem(f.a,"1"))}},created(){if(this.localStorageUsable=Qt.a.canUseLocalStorage(),this.localStorageUsable){const e=Boolean(localStorage.getItem(f.a));this.isVisible=!e}},methods:{hasScannedResources(e){var t,i;return(null===(t=e.scannedResources)||void 0===t||null===(i=t.nodes)||void 0===i?void 0:i.length)>0},hasDastArtifacts(){return this.findArtifacts(c.c).length>0},hasDastArtifactDownload(e,t){return e===c.c&&(Boolean(this.downloadLink(t))||this.hasDastArtifacts)},downloadLink:e=>e.scannedResourcesCsvPath||"",normalizeScanType:e=>Object(Wt.i)(e.toLowerCase()),findArtifacts(e){return Object(Yt.a)([this.normalizeScanType(e)],this.jobs)},buildDastArtifacts(e){const t={name:this.$options.i18n.scannedResources,path:this.downloadLink(e),reportType:c.b};return[...this.findArtifacts(c.c),t]}}},Kt=Object(N.a)(Xt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-card",{attrs:{"body-class":"gl-py-0","header-class":"gl-border-b-0"},scopedSlots:e._u([{key:"header",fn:function(){return[i("div",{staticClass:"row"},[i("div",{staticClass:"col-7"},[i("strong",[e._v(e._s(e.$options.i18n.scanDetails))])]),e._v(" "),e.localStorageUsable?i("div",{staticClass:"col-5 gl-text-right"},[i("gl-button",{directives:[{name:"collapse-toggle",rawName:"v-collapse-toggle.security-reports-summary-details",modifiers:{"security-reports-summary-details":!0}}],attrs:{"data-testid":"collapse-button"}},[e._v("\n          "+e._s(e.collapseButtonLabel)+"\n        ")])],1):e._e()])]},proxy:!0}])},[e._v(" "),i("gl-collapse",{staticClass:"gl-pb-3",attrs:{id:"security-reports-summary-details","data-testid":"security-reports-summary-details"},model:{value:e.isVisible,callback:function(t){e.isVisible=t},expression:"isVisible"}},e._l(e.formattedSummary,(function(t){var n=t[0],a=t[1];return i("div",{key:n,staticClass:"row gl-my-3"},[i("div",{staticClass:"col-4"},[e._v("\n        "+e._s(n)+"\n      ")]),e._v(" "),i("div",{staticClass:"col-4"},[i("gl-sprintf",{attrs:{message:e.$options.i18n.vulnerabilities(a.vulnerabilitiesCount)}})],1),e._v(" "),i("div",{staticClass:"col-4",attrs:{"data-testid":"artifact-download-"+e.normalizeScanType(n)}},[void 0!==a.scannedResourcesCount?[e.hasScannedResources(a)?i("gl-button",{directives:[{name:"gl-modal",rawName:"v-gl-modal.dastUrl",modifiers:{dastUrl:!0}}],attrs:{icon:"download",size:"small","data-testid":"modal-button"}},[e._v("\n            "+e._s(e.$options.i18n.downloadUrls)+"\n          ")]):[e._v("\n            ("),i("gl-sprintf",{attrs:{message:e.$options.i18n.scannedUrls(a.scannedResourcesCount)}}),e._v(")\n          ")],e._v(" "),e.hasScannedResources(a)?i("modal",{attrs:{"scanned-urls":a.scannedResources.nodes,"scanned-resources-count":a.scannedResourcesCount,"download-link":e.downloadLink(a)}}):e._e()]:e.hasDastArtifactDownload(n,a)?[i("security-report-download-dropdown",{attrs:{text:e.$options.i18n.downloadResults,artifacts:e.buildDastArtifacts(a),"data-testid":"download-link"}})]:i("security-report-download-dropdown",{attrs:{text:e.$options.i18n.downloadResults,artifacts:e.findArtifacts(n)}})],2)])})),0)],1)}),[],!1,null,null,null).exports,Zt=i("MNkS"),ei=i("e2Sm"),ti=(i("g+EE"),i("ZplN")),ii=i("oSqs"),ni=i("lT7T"),ai={components:{GlIcon:kt.a,GlCard:Gt.a},props:{solution:{type:String,default:"",required:!1},remediation:{type:Object,default:null,required:!1},mergeRequest:{type:Object,default:null,required:!1}},computed:{solutionText(){var e;return this.solution||(null===(e=this.remediation)||void 0===e?void 0:e.summary)},showCreateMergeRequestMessage(){var e,t;return!this.hasMr&&(null===(e=this.remediation)||void 0===e||null===(t=e.diff)||void 0===t?void 0:t.length)>0},hasMr(){var e;return Boolean(null===(e=this.mergeRequest)||void 0===e?void 0:e.id)}}},ri=Object(N.a)(ai,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.solutionText?i("gl-card",{staticClass:"gl-my-6",scopedSlots:e._u([e.solutionText?{key:"default",fn:function(){return[i("div",{staticClass:"gl-display-flex gl-align-items-center"},[i("div",{staticClass:"gl-pr-5 gl-display-flex gl-align-items-center gl-justify-content-end gl-pl-0"},[i("gl-icon",{staticClass:"gl-mr-5",attrs:{name:"bulb"}}),e._v(" "),i("strong",{attrs:{"data-testid":"solution-title"}},[e._v(e._s(e.s__("ciReport|Solution"))+":")])],1),e._v(" "),i("span",{staticClass:"flex-shrink-1 gl-pl-0",attrs:{"data-testid":"solution-text"}},[e._v(e._s(e.solutionText))])])]},proxy:!0}:null,e.showCreateMergeRequestMessage?{key:"footer",fn:function(){return[i("em",{staticClass:"gl-text-gray-500",attrs:{"data-testid":"merge-request-solution"}},[e._v("\n      "+e._s(e.s__("ciReport|Create a merge request to implement this solution, or download and apply the patch manually."))+"\n    ")])]},proxy:!0}:null],null,!0)}):e._e()}),[],!1,null,null,null).exports,si=i("u1ru"),li=i("XW4O"),oi={components:{EventItem:li.a,GlSprintf:y.a,GlLink:si.a},props:{issueLinks:{type:Array,required:!0},project:{type:Object,required:!1,default:void 0}},computed:{createdIssue(){var e;return null===(e=this.issueLinks.find((function(e){let{linkType:t}=e;return"CREATED"===t})))||void 0===e?void 0:e.issue},eventText(){return this.project?Object(m.a)("Created issue %{issueLink} at %{projectLink}"):Object(m.a)("Created issue %{issueLink}")}}},di=Object(N.a)(oi,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.createdIssue?i("div",{staticClass:"card gl-my-6"},[i("event-item",{staticClass:"card-body",attrs:{author:e.createdIssue.author,"created-at":e.createdIssue.createdAt,"icon-name":"issues"}},[i("gl-sprintf",{attrs:{message:e.eventText},scopedSlots:e._u([{key:"issueLink",fn:function(){return[i("gl-link",{attrs:{href:e.createdIssue.webUrl,"data-testid":"issue-link"}},[e._v("\n          #"+e._s(e.createdIssue.iid)+"\n        ")])]},proxy:!0},e.project?{key:"projectLink",fn:function(){return[i("gl-link",{attrs:{href:e.project.webUrl,"data-testid":"project-link"}},[e._v("\n          "+e._s(e.project.nameWithNamespace)+"\n        ")])]},proxy:!0}:null],null,!0)})],1)],1):e._e()}),[],!1,null,null,null).exports,ci=i("F+K/"),ui=i("t8no"),mi=i("BNz6"),vi=i("JmT7");const pi={SAST:Object(m.g)("ciReport|SAST"),DEPENDENCY_SCANNING:Object(m.g)("ciReport|Dependency Scanning"),CONTAINER_SCANNING:Object(m.g)("ciReport|Container Scanning"),DAST:Object(m.g)("ciReport|DAST"),SECRET_DETECTION:Object(m.g)("ciReport|Secret Detection"),COVERAGE_FUZZING:Object(m.g)("ciReport|Coverage Fuzzing"),API_FUZZING:Object(m.g)("ciReport|API Fuzzing"),CLUSTER_IMAGE_SCANNING:Object(m.g)("ciReport|Cluster Image Scanning"),GENERIC:Object(m.g)("ciReport|Generic Report")};var fi={props:{heading:{type:String,required:!1,default:""}}},gi=Object(N.a)(fi,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[e.heading?i("h2",{staticClass:"gl-font-lg gl-mt-0"},[e._v(e._s(e.heading))]):e._e(),e._v(" "),e._t("default"),e._v(" "),e.$scopedSlots.list?i("ul",{staticClass:"gl-list-style-none gl-gap-y-3 gl-p-0"},[e._t("list")],2):e._e()],2)}),[],!1,null,null,null).exports,hi={props:{label:{type:String,required:!0}}},bi=Object(N.a)(hi,(function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("strong",{staticClass:"gl-font-weight-bold"},[this._v(this._s(this.label))]),this._v(" "),this._t("default")],2)}),[],!1,null,null,null).exports,yi={directives:{SafeHtml:vi.a},i18n:{descriptionSectionHeading:Object(m.g)("Vulnerability|Description"),severityLabel:Object(m.g)("Vulnerability|Severity:"),stateLabel:Object(m.g)("Vulnerability|Status:"),projectLabel:Object(m.g)("Vulnerability|Project:"),toolLabel:Object(m.g)("Vulnerability|Tool:"),scannerLabel:Object(m.g)("Vulnerability|Scanner:"),locationHeading:Object(m.g)("Vulnerability|Location"),locationFileLabel:Object(m.g)("Vulnerability|File:"),linksSectionHeading:Object(m.g)("Vulnerability|Links"),identifiersSectionHeading:Object(m.g)("Vulnerability|Identifiers"),assetsSectionHeading:Object(m.g)("Vulnerability|Reproduction Assets")},components:{GlBadge:ci.a,GlLink:si.a,GlSprintf:y.a,SeverityBadge:_t.a,DetailsSection:gi,DetailsSectionListItem:bi,FalsePositiveAlert:ui.a,GenericReportSection:mi.a},props:{description:{type:String,required:!0},descriptionHtml:{type:String,required:!1,default:""},state:{type:String,required:!1,default:""},severity:{type:String,required:!0,validator:function(e){return rt.j.includes(e)}},project:{type:Object,required:!0},location:{type:Object,required:!1,default:null},reportType:{type:String,required:!1,default:""},links:{type:Array,required:!1,default:function(){return[]}},identifiers:{type:Array,required:!1,default:function(){return[]}},scanner:{type:Object,required:!1,default:null},assets:{type:Array,required:!1,default:function(){return[]}},falsePositive:{type:Boolean,required:!0},details:{type:Array,required:!1,default:function(){return[]}}},computed:{humanReadableReportType(){return pi[this.reportType]},file(){const{startLine:e,endLine:t,blobPath:i,file:n}=this.location,a=t>e?`${e}-${t}`:e;return{url:`${i}#L${a}`,name:`${n}:${a}`}}}},ki=Object(N.a)(yi,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("article",[e.falsePositive?i("false-positive-alert",{staticClass:"gl-mb-4"}):e._e(),e._v(" "),i("details-section",{attrs:{heading:e.$options.i18n.descriptionSectionHeading,"data-testid":"description-section"}},[e.descriptionHtml?i("div",{directives:[{name:"safe-html",rawName:"v-safe-html",value:e.descriptionHtml,expression:"descriptionHtml"}]}):i("p",[e._v(e._s(e.description))])]),e._v(" "),i("details-section",{attrs:{"data-testid":"main-section"},scopedSlots:e._u([{key:"list",fn:function(){return[e.state?i("details-section-list-item",{attrs:{label:e.$options.i18n.stateLabel,"data-testid":"state-list-item"}},[i("gl-badge",{staticClass:"text-capitalize",attrs:{variant:"warning"}},[e._v(e._s(e.state))])],1):e._e(),e._v(" "),i("details-section-list-item",{attrs:{label:e.$options.i18n.severityLabel,"data-testid":"severity-list-item"}},[i("severity-badge",{staticClass:"gl-display-inline-block gl-ml-2",attrs:{severity:e.severity}})],1),e._v(" "),i("details-section-list-item",{attrs:{label:e.$options.i18n.projectLabel,"data-testid":"project-list-item"}},[i("gl-link",{attrs:{href:e.project.webUrl}},[e._v(e._s(e.project.name))])],1),e._v(" "),e.humanReadableReportType?i("details-section-list-item",{attrs:{label:e.$options.i18n.toolLabel,"data-testid":"report-type-list-item"}},[e._v("\n        "+e._s(e.humanReadableReportType)+"\n      ")]):e._e(),e._v(" "),e.scanner?i("details-section-list-item",{attrs:{label:e.$options.i18n.scannerLabel,"data-testid":"scanner-list-item"}},[e.scanner.version?i("gl-sprintf",{attrs:{message:e.s__("Vulnerability|%{scannerName} (version %{scannerVersion})")},scopedSlots:e._u([{key:"scannerName",fn:function(){return[e._v(e._s(e.scanner.name))]},proxy:!0},{key:"scannerVersion",fn:function(){return[e._v(e._s(e.scanner.version))]},proxy:!0}],null,!1,1679275529)}):[e._v(e._s(e.scanner.name))]],2):e._e()]},proxy:!0}])}),e._v(" "),e.location?i("details-section",{attrs:{heading:e.$options.i18n.locationHeading,"data-testid":"location-section"},scopedSlots:e._u([{key:"list",fn:function(){return[e.location.file?i("details-section-list-item",{attrs:{label:e.$options.i18n.locationFileLabel,"data-testid":"location-file-list-item"}},[i("gl-link",{attrs:{href:e.file.url}},[e._v(e._s(e.file.name))])],1):e._e()]},proxy:!0}],null,!1,1003508311)}):e._e(),e._v(" "),e.links.length?i("details-section",{attrs:{heading:e.$options.i18n.linksSectionHeading,"data-testid":"links-section"}},[i("ul",{staticClass:"gl-p-0"},e._l(e.links,(function(t){return i("li",{key:t.url,staticClass:"gl-list-style-position-inside"},[i("gl-link",{attrs:{href:t.url}},[e._v("\n          "+e._s(t.name||t.url)+"\n        ")])],1)})),0)]):e._e(),e._v(" "),e.identifiers.length?i("details-section",{attrs:{heading:e.$options.i18n.identifiersSectionHeading,"data-testid":"identifiers-section"}},[i("ul",{staticClass:"gl-p-0"},e._l(e.identifiers,(function(t){return i("li",{key:t.name,staticClass:"gl-list-style-position-inside"},[t.url?i("gl-link",{attrs:{href:t.url}},[e._v("\n          "+e._s(t.name)+"\n        ")]):[e._v(e._s(t.name))]],2)})),0)]):e._e(),e._v(" "),e.assets.length?i("details-section",{attrs:{heading:e.$options.i18n.assetsSectionHeading,"data-testid":"assets-section"}},[i("ul",{staticClass:"gl-p-0"},e._l(e.assets,(function(t){return i("li",{key:t.name,staticClass:"gl-list-style-position-inside"},[t.url?i("gl-link",{attrs:{href:t.url}},[e._v("\n          "+e._s(t.name)+"\n        ")]):[e._v(e._s(t.name))]],2)})),0)]):e._e(),e._v(" "),i("generic-report-section",{attrs:{"report-items":e.details}})],1)}),[],!1,null,null,null).exports,Si=i("KE9z"),_i=i.n(Si),Ni=i("OwU9"),Ei=i.n(Ni),Di=i("s6oH"),Ci=i.n(Di),Oi=i("ENs1");var Ii={components:{EventItem:li.a,GlAlert:b.a,GlCard:Gt.a,GlButton:l.a,GlButtonGroup:ti.a,GlFormTextarea:ii.a,GlModal:ni.a,GlSkeletonLoader:yt.a,IssueNote:di,SolutionCard:ri,VulnerabilityDetailsGraphql:ki},directives:{GlTooltip:Ct.a},props:{findingUuid:{type:String,required:!0},pipelineIid:{type:Number,required:!0},projectFullPath:{type:String,required:!0}},data:()=>({hasFindingFetchError:!1,errorMessage:"",isUpdatingFindingState:!1,isShowingDismissalCommentSection:!1,dismissalComment:""}),apollo:{finding:{query:_i.a,variables(){return this.queryVariables},update(e){var t,i;return null===(t=e.project)||void 0===t||null===(i=t.pipeline)||void 0===i?void 0:i.securityReportFinding},error(){this.finding=null,this.errorMessage=this.$options.i18n.fetchErrorMessage}}},computed:{queryVariables(){const{projectFullPath:e,pipelineIid:t,findingUuid:i}=this;return{projectFullPath:e,pipelineIid:t,findingUuid:i}},remediation(){var e;return null===(e=this.finding.remediations)||void 0===e?void 0:e[0]},issueLinks(){var e;return(null===(e=this.finding.issueLinks)||void 0===e?void 0:e.nodes)||[]},canDownloadPatchForThisVulnerability(){var e,t;return!this.finding.hasMergeRequest&&(null===(e=this.remediation)||void 0===e||null===(t=e.diff)||void 0===t?void 0:t.length)>0},showErrorMessage(){return!this.isLoading&&(Boolean(this.errorMessage)||!this.finding)},isLoading(){return this.$apollo.queries.finding.loading},isFindingDismissed(){var e;return"DISMISSED"===(null===(e=this.finding)||void 0===e?void 0:e.state)},toggledFindingStateMutationConfig(){const{i18n:e}=this.$options,t=this.isFindingDismissed?"DETECTED":"DISMISSED";return{...{DISMISSED:{mutationName:"securityFindingDismiss",mutation:Ei.a,errorMessage:e.dismissErrorMessage},DETECTED:{mutationName:"securityFindingRevertToDetected",mutation:Ci.a,errorMessage:e.revertDismissErrorMessage}}[t],toggledState:t}},currentUser(){const{current_user_id:e,current_username:t,current_user_fullname:i}=window.gon;return{author:{id:e,name:i,username:t,state:"active"}}},dismissButtonText(){const{isFindingDismissed:e,isShowingDismissalCommentSection:t,$options:{i18n:i}}=this;return e?i.revertDismissFinding:t?i.addCommentAndDismiss:i.dismissFinding}},methods:{handleCancel(){this.isShowingDismissalCommentSection?this.isShowingDismissalCommentSection=!1:this.closeModal()},closeModal(){this.$refs.modal.hide()},async toggleFindingState(){var e=this;this.isUpdatingFindingState=!0;const{mutation:t,errorMessage:i,mutationName:n,toggledState:a}=this.toggledFindingStateMutationConfig;try{await this.$apollo.mutate({mutation:t,variables:{uuid:this.findingUuid,...this.dismissalComment&&{comment:this.dismissalComment}},update:function(t,i){const{errors:r}=i.data[n];if(r.length>0)throw new Error(r[0]);!function(e){let{state:t,store:i,query:n,variables:a}=e;const r=i.readQuery({query:n,variables:a}),s=Object(Oi.a)(r,(function(e){e.project.pipeline.securityReportFinding.state=t}));i.writeQuery({query:n,variables:a,data:s})}({state:a,store:t,query:_i.a,variables:e.queryVariables}),e.$emit("state-update",a),e.closeModal()}})}catch{this.errorMessage=i}finally{this.isUpdatingFindingState=!1}}},i18n:{fetchErrorTitle:Object(m.a)("Error"),fetchErrorMessage:Object(m.g)("SecurityReports|There was an error fetching the finding. Please try again."),dismissErrorMessage:Object(m.g)("SecurityReports|There was an error dismissing the finding. Please try again."),revertDismissErrorMessage:Object(m.g)("SecurityReports|There was an error reverting the dismissal."),cancel:Object(m.a)("Cancel"),dismissFinding:Object(m.g)("SecurityReports|Dismiss vulnerability"),revertDismissFinding:Object(m.g)("SecurityReports|Undo dismiss"),addCommentAndDismiss:Object(m.g)("SecurityReports|Add comment and dismiss")}},Ti=Object(N.a)(Ii,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-modal",{ref:"modal",attrs:{visible:!0,"modal-id":"security-finding-details"},on:{hidden:function(t){return e.$emit("hide")}},scopedSlots:e._u([{key:"modal-header",fn:function(){return[e.isLoading?i("gl-skeleton-loader",{attrs:{"data-testid":"title-loading-indicator",width:400,lines:1}}):i("h2",{staticClass:"gl-m-0 gl-font-lg"},[e._v("\n      "+e._s(e.finding?e.finding.title:e.$options.i18n.fetchErrorTitle)+"\n    ")])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("div",{attrs:{"data-testid":"footer"}},[i("gl-button",{attrs:{"data-testid":"cancel-button"},on:{click:e.handleCancel}},[e._v("\n        "+e._s(e.$options.i18n.cancel)+"\n      ")]),e._v(" "),i("gl-button-group",[i("gl-button",{attrs:{"data-testid":"dismiss-button",loading:e.isUpdatingFindingState},on:{click:e.toggleFindingState}},[e._v("\n          "+e._s(e.dismissButtonText)+"\n        ")]),e._v(" "),e.isFindingDismissed||e.isShowingDismissalCommentSection?e._e():i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],attrs:{"data-testid":"dismiss-with-comment-button",icon:"comment",title:e.$options.i18n.addCommentAndDismiss},on:{click:function(t){e.isShowingDismissalCommentSection=!0}}})],1)],1)]},proxy:!0}])},[e._v(" "),e.isLoading?i("div",{attrs:{"data-testid":"content-loading-indicator"}},[i("gl-skeleton-loader",{attrs:{width:80,lines:1}}),e._v(" "),i("gl-skeleton-loader",{attrs:{width:200,lines:1}})],1):e.finding?[i("vulnerability-details-graphql",e._b({},"vulnerability-details-graphql",e.finding,!1)),e._v(" "),i("solution-card",{attrs:{solution:e.finding.solution,remediation:e.remediation,"merge-request":e.finding.mergeRequest}}),e._v(" "),i("issue-note",{attrs:{"issue-links":e.issueLinks,project:e.finding.project}}),e._v(" "),e.isShowingDismissalCommentSection?i("gl-card",{attrs:{"data-testid":"dismissal-comment-section"}},[i("event-item",{attrs:{author:e.currentUser.author,"icon-name":"cancel","icon-class":"ci-status-icon-pending"}}),e._v(" "),i("div",{staticClass:"gl-mt-5 gl-pt-5 gl-border-t"},[i("gl-form-textarea",{attrs:{autofocus:""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.metaKey?e.toggleFindingState.apply(null,arguments):null}},model:{value:e.dismissalComment,callback:function(t){e.dismissalComment=t},expression:"dismissalComment"}})],1)],1):e._e()]:e._e(),e._v(" "),e.showErrorMessage?i("gl-alert",{attrs:{variant:"danger",dismissible:!1}},[e._v("\n    "+e._s(e.errorMessage||e.$options.i18n.fetchErrorMessage)+"\n  ")]):e._e()],2)}),[],!1,null,null,null).exports,ji={components:{VulnerabilityReport:Zt.a,VulnerabilityFindingModal:Ti},inject:["pipeline","projectFullPath"],data:()=>({graphqlFilters:void 0,selectedFinding:void 0}),methods:{normalizeForGraphQLQuery:e=>null!=e&&e.length?e.map((function(e){return e.toLowerCase()})):void 0,transformFilters(e){return{...e,reportType:this.normalizeForGraphQLQuery(e.reportType),severity:this.normalizeForGraphQLQuery(e.severity)}},showModal(e){this.selectedFinding=e},hideModal(){this.selectedFinding=void 0}},filtersToShow:[ei.c.STATUS,ei.c.SEVERITY,ei.c.TOOL_PIPELINE],fieldsToShow:[ei.a.CHECKBOX,ei.a.STATUS,ei.a.SEVERITY,ei.a.DESCRIPTION,ei.a.IDENTIFIER,ei.a.TOOL]},Vi=Object(N.a)(ji,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("vulnerability-report",{attrs:{fields:e.$options.fieldsToShow,"filter-dropdowns":e.$options.filtersToShow,"filter-fn":e.transformFilters},on:{"vulnerability-clicked":e.showModal}}),e._v(" "),e.selectedFinding?i("vulnerability-finding-modal",{attrs:{"finding-uuid":e.selectedFinding.id,"pipeline-iid":e.pipeline.iid,"project-full-path":e.projectFullPath},on:{hide:e.hideModal}}):e._e()],1)}),[],!1,null,null,null).exports,Li={name:"PipelineSecurityDashboard",errorsAlertType:k,warningsAlertType:S,scanPurgedStatus:"PURGED",components:{GlEmptyState:s.a,ReportStatusAlert:C,ScanAlerts:E,SecurityReportsSummary:Kt,SecurityDashboard:Mt,PipelineVulnerabilityReport:Vi,GlButton:l.a},mixins:[Object(v.a)()],inject:["emptyStateSvgPath","loadingErrorIllustrations","pipeline","projectFullPath","projectId","vulnerabilitiesEndpoint"],data:()=>({securityReportSummary:{}}),apollo:{securityReportSummary:{query:d.a,fetchPolicy:u.b.NETWORK_ONLY,variables(){return{fullPath:this.projectFullPath,pipelineIid:this.pipeline.iid,reportTypes:Object.values(c.i)}},update(e){var t,i,n,a,r;const s={reports:null==e||null===(t=e.project)||void 0===t||null===(i=t.pipeline)||void 0===i?void 0:i.securityReportSummary,jobs:null==e||null===(n=e.project)||void 0===n||null===(a=n.pipeline)||void 0===a||null===(r=a.jobs)||void 0===r?void 0:r.nodes};return null!=s&&s.reports&&Object.keys(s.reports).length?s:null}}},computed:{reportSummary(){var e;return null===(e=this.securityReportSummary)||void 0===e?void 0:e.reports},jobs(){var e;return null===(e=this.securityReportSummary)||void 0===e?void 0:e.jobs},shouldShowGraphqlVulnerabilityReport(){return this.glFeatures.pipelineSecurityDashboardGraphql},emptyStateProps(){return{svgPath:this.emptyStateSvgPath,title:Object(m.g)("SecurityReports|No vulnerabilities found for this pipeline"),description:Object(m.g)("SecurityReports|While it's rare to have no vulnerabilities for your pipeline, it can happen. In any event, we ask that you double check your settings to make sure all security scanning jobs have passed successfully."),primaryButtonLink:f.d,primaryButtonText:Object(m.g)("SecurityReports|Learn more about setting up your dashboard")}},scans(){return this.reportSummary?Object.values(this.reportSummary).flatMap((function(e){var t;return(null==e||null===(t=e.scans)||void 0===t?void 0:t.nodes)||[]})):[]},purgedScans(){var e=this;return this.scans.filter((function(t){return t.status===e.$options.scanPurgedStatus}))},hasPurgedScans(){return this.purgedScans.length>0},scansWithErrors(){return this.scans.filter((function(e){var t;return Boolean(null===(t=e.errors)||void 0===t?void 0:t.length)}))},showScanErrors(){return this.scansWithErrors.length>0&&!this.hasPurgedScans},scansWithWarnings(){return this.scans.filter((function(e){var t;return Boolean(null===(t=e.warnings)||void 0===t?void 0:t.length)}))},showScanWarnings(){return this.scansWithWarnings.length>0&&!this.hasPurgedScans}},i18n:{parsingErrorAlertTitle:Object(m.g)("SecurityReports|Error parsing security reports"),parsingErrorAlertDescription:Object(m.g)("SecurityReports|The following security reports contain one or more vulnerability findings that could not be parsed and were not recorded. To investigate a report, download the artifacts in the job output. Ensure the security report conforms to the relevant %{helpPageLinkStart}JSON schema%{helpPageLinkEnd}."),parsingWarningAlertTitle:Object(m.g)("SecurityReports|Warning parsing security reports"),parsingWarningAlertDescription:Object(m.g)("SecurityReports|Check the messages generated while parsing the following security reports, as they may prevent the results from being ingested by GitLab. Ensure the security report conforms to a supported %{helpPageLinkStart}JSON schema%{helpPageLinkEnd}."),pageDescription:Object(m.g)("SecurityReports|Results show vulnerabilities introduced by the merge request, in addition to existing vulnerabilities from the latest successful pipeline in your project's default branch."),pageDescriptionHelpLink:Object(p.a)("user/application_security/vulnerability_report/pipeline.html")}},Ri=Object(N.a)(Li,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"gl-mt-5"},[i("p",[e._v("\n    "+e._s(e.$options.i18n.pageDescription)+"\n    "),i("gl-button",{staticClass:"gl-ml-2 vertical-align-text-top",attrs:{icon:"question-o",variant:"link",target:"_blank",href:e.$options.i18n.pageDescriptionHelpLink}})],1),e._v(" "),e.reportSummary?i("div",{staticClass:"gl-mb-5"},[e.showScanErrors?i("scan-alerts",{staticClass:"gl-mb-5",attrs:{type:e.$options.errorsAlertType,scans:e.scansWithErrors,title:e.$options.i18n.parsingErrorAlertTitle,description:e.$options.i18n.parsingErrorAlertDescription}}):e._e(),e._v(" "),e.showScanWarnings?i("scan-alerts",{staticClass:"gl-mb-5",attrs:{type:e.$options.warningsAlertType,scans:e.scansWithWarnings,title:e.$options.i18n.parsingWarningAlertTitle,description:e.$options.i18n.parsingWarningAlertDescription}}):e._e(),e._v(" "),e.hasPurgedScans?i("report-status-alert",{staticClass:"gl-mb-5"}):e._e(),e._v(" "),i("security-reports-summary",{attrs:{summary:e.reportSummary,jobs:e.jobs}})],1):e._e(),e._v(" "),e.shouldShowGraphqlVulnerabilityReport?i("pipeline-vulnerability-report"):i("security-dashboard",{attrs:{"vulnerabilities-endpoint":e.vulnerabilitiesEndpoint,"lock-to-project":{id:e.projectId},"pipeline-id":e.pipeline.id,"loading-error-illustrations":e.loadingErrorIllustrations,"security-report-summary":e.reportSummary},scopedSlots:e._u([{key:"empty-state",fn:function(){return[i("gl-empty-state",e._b({},"gl-empty-state",e.emptyStateProps,!1))]},proxy:!0}],null,!1,3601025068)})],1)}),[],!1,null,null,null);t.a=Ri.exports},RwX1:function(e,t,i){"use strict";i.d(t,"c",(function(){return a})),i.d(t,"i",(function(){return r})),i.d(t,"j",(function(){return s})),i.d(t,"f",(function(){return l})),i.d(t,"g",(function(){return o})),i.d(t,"h",(function(){return d})),i.d(t,"e",(function(){return c})),i.d(t,"a",(function(){return u})),i.d(t,"d",(function(){return m})),i.d(t,"b",(function(){return v}));i("uHfJ"),i("R0RX");var n=i("t9l/");const a=[Object(n.g)("Vulnerability|GitLab Security Report"),Object(n.g)("Vulnerability|External Security Report"),Object(n.g)("Vulnerability|Bug Bounty"),Object(n.g)("Vulnerability|Code Review"),Object(n.g)("Vulnerability|Security Audit")],r={critical:Object(n.g)("severity|Critical"),high:Object(n.g)("severity|High"),medium:Object(n.g)("severity|Medium"),low:Object(n.g)("severity|Low"),unknown:Object(n.g)("severity|Unknown"),info:Object(n.g)("severity|Info")},s=Object.keys(r).map((function(e){return e.toUpperCase()})),l={api_fuzzing:Object(n.g)("ciReport|API Fuzzing"),container_scanning:Object(n.g)("ciReport|Container Scanning"),coverage_fuzzing:Object(n.g)("ciReport|Coverage Fuzzing"),dast:Object(n.g)("ciReport|DAST"),dependency_scanning:Object(n.g)("ciReport|Dependency Scanning"),sast:Object(n.g)("ciReport|SAST"),secret_detection:Object(n.g)("ciReport|Secret Detection")},o={...l,cluster_image_scanning:Object(n.g)("ciReport|Cluster Image Scanning")},d={...l,generic:Object(n.g)("ciReport|Manually added")},c={...l,...o,...d},u={PROJECT:"project",PIPELINE:"pipeline",GROUP:"group",INSTANCE:"instance"},m="cve",v={thirty:30,sixty:60,ninety:90}},SJpF:function(e,t){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"VulnerabilityScanner"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityScanner"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"externalId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reportType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendor"},arguments:[],directives:[]}]}}],loc:{start:0,end:105}};i.loc.source={body:"fragment VulnerabilityScanner on VulnerabilityScanner {\n  id\n  externalId\n  name\n  reportType\n  vendor\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.VulnerabilityScanner=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"VulnerabilityScanner")},TBKw:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("0sqQ");const a=function(e){return""===e?"":e||n.a}},UFYt:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"groupProjects"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"search"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"group"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeSubgroups"},value:{kind:"BooleanValue",value:!0}},{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"Argument",name:{kind:"Name",value:"search"},value:{kind:"Variable",name:{kind:"Name",value:"search"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"pageSize"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endCursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasNextPage"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:388}};i.loc.source={body:"query groupProjects($fullPath: ID!, $ids: [ID!], $search: String, $pageSize: Int, $after: String) {\n  group(fullPath: $fullPath) {\n    id\n    projects(includeSubgroups: true, ids: $ids, search: $search, first: $pageSize, after: $after) {\n      edges {\n        node {\n          id\n          name\n        }\n      }\n      pageInfo {\n        endCursor\n        hasNextPage\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.groupProjects=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"groupProjects")},UMdU:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("oj/M"),a=i("RwX1"),r=i("hzXV"),s=i.n(r),l=i("zDXb");const o=function(e){const{commitPathTemplate:t,projectFullPath:i,emptyStateSvgPath:r,vulnerabilitiesEndpoint:o,projectId:d,canAdminVulnerability:c,pipelineId:u,pipelineIid:m,pipelineJobsPath:v,sourceBranch:p,emptyStateUnauthorizedSvgPath:f,emptyStateForbiddenSvgPath:g,canViewFalsePositive:h}=e,b={[l.a.UNAUTHORIZED]:f,[l.a.FORBIDDEN]:g};return{commitPathTemplate:t,projectFullPath:i,emptyStateSvgPath:r,vulnerabilitiesEndpoint:o,dashboardType:a.a.PIPELINE,projectId:Number(d),fullPath:i,canAdminVulnerability:Object(n.G)(c),pipeline:{id:Number(u),iid:Number(m),jobsPath:v,sourceBranch:p},loadingErrorIllustrations:b,canViewFalsePositive:Object(n.G)(h),vulnerabilitiesQuery:s.a}}},UPUA:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={critical:"gl-text-red-800",high:"gl-text-red-600",medium:"gl-text-orange-400",low:"gl-text-orange-200",info:"gl-text-blue-400",unknown:"gl-text-gray-400"}},V9gj:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"autoFixMrsCount"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mergeRequests"},arguments:[{kind:"Argument",name:{kind:"Name",value:"labels"},value:{kind:"StringValue",value:"GitLab-auto-fix",block:!1}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"EnumValue",value:"opened"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:166}};i.loc.source={body:'query autoFixMrsCount($fullPath: ID!) {\n  project(fullPath: $fullPath) {\n    id\n    mergeRequests(labels: "GitLab-auto-fix", state: opened) {\n      count\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.autoFixMrsCount=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"autoFixMrsCount")},"VB+Q":function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"securityScanners"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"securityScanners"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"available"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pipelineRun"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:164}};i.loc.source={body:"query securityScanners($fullPath: ID!) {\n  project(fullPath: $fullPath) {\n    id\n    securityScanners {\n      available\n      enabled\n      pipelineRun\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.securityScanners=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"securityScanners")},"Wrl+":function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return s})),i.d(t,"i",(function(){return l})),i.d(t,"c",(function(){return o})),i.d(t,"g",(function(){return d})),i.d(t,"h",(function(){return c})),i.d(t,"d",(function(){return u})),i.d(t,"e",(function(){return m})),i.d(t,"f",(function(){return v})),i.d(t,"m",(function(){return p})),i.d(t,"n",(function(){return f})),i.d(t,"k",(function(){return g})),i.d(t,"l",(function(){return h})),i.d(t,"j",(function(){return b}));var n=i("t9l/"),a=i("mcoW");const r="hide_pipelines_security_reports_summary_details",s="GitLab",l="gid://gitlab/Vulnerabilities::Scanner/",o=Object(a.a)("user/application_security/index"),d=Object(a.a)("user/application_security/vulnerabilities/index"),c=Object(a.a)("user/application_security/vulnerability_report/index"),u=(Object(a.a)("user/application_security/security_dashboard/index"),Object(a.a)("user/application_security/configuration/index")),m=(Object(a.a)("user/application_security/policies/index"),Object(a.a)("development/integrations/secure",{anchor:"report"})),v=Object(a.a)("development/integrations/secure",{anchor:"retention-period-for-vulnerabilities"}),p={CRITICAL:"critical",HIGH:"high",UNKNOWN:"unknown",MEDIUM:"medium",LOW:"low",NONE:"none"},f={[p.CRITICAL]:Object(n.g)("severity|Critical"),[p.HIGH]:Object(n.g)("severity|High"),[p.UNKNOWN]:Object(n.g)("severity|Unknown"),[p.MEDIUM]:Object(n.g)("severity|Medium"),[p.LOW]:Object(n.g)("severity|Low"),[p.NONE]:Object(n.g)("severity|None")},g=[p.CRITICAL,p.HIGH,p.UNKNOWN,p.MEDIUM,p.LOW,p.NONE],h={F:"F",D:"D",C:"C",B:"B",A:"A"},b=[{type:h.F,description:Object(n.a)("Projects with critical vulnerabilities"),warning:Object(n.a)("Critical vulnerabilities present"),severityLevels:[p.CRITICAL]},{type:h.D,description:Object(n.a)("Projects with high or unknown vulnerabilities"),warning:Object(n.a)("High or unknown vulnerabilities present"),severityLevels:[p.HIGH,p.UNKNOWN]},{type:h.C,description:Object(n.a)("Projects with medium vulnerabilities"),warning:Object(n.a)("Medium vulnerabilities present"),severityLevels:[p.MEDIUM]},{type:h.B,description:Object(n.a)("Projects with low vulnerabilities"),warning:Object(n.a)("Low vulnerabilities present"),severityLevels:[p.LOW]},{type:h.A,description:Object(n.a)("Projects with no vulnerabilities and security scanning enabled"),warning:Object(n.a)("No vulnerabilities present"),severityLevels:[p.NONE]}]},XEE8:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"instanceVulnerabilityGrades"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"instanceSecurityDashboard"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilityGrades"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"grade"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Project"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ProjectVulnerabilitySeveritiesCount"},directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:431}};n.loc.source={body:'#import "ee/security_dashboard/graphql/fragments/project.fragment.graphql"\n#import "ee/security_dashboard/graphql/fragments/project_vulnerability_severities_count.fragment.graphql"\n\nquery instanceVulnerabilityGrades {\n  instanceSecurityDashboard {\n    vulnerabilityGrades {\n      grade\n      count\n      projects {\n        nodes {\n          ...Project\n          ...ProjectVulnerabilitySeveritiesCount\n        }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)}))}n.definitions=n.definitions.concat(r(i("e7pO").definitions)),n.definitions=n.definitions.concat(r(i("Pl9t").definitions));var s={};function l(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),s[e.name.value]=t}})),e.exports=n,e.exports.instanceVulnerabilityGrades=function(e,t){var i={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=s[t]||new Set,a=new Set,r=new Set;for(n.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(t){var n=l(e,t);n&&i.definitions.push(n)})),i}(n,"instanceVulnerabilityGrades")},XW4O:function(e,t,i){"use strict";var n=i("H8gz"),a=i("cuRJ"),r=i("ly/8"),s=i("dkhw"),l={name:"EventItem",components:{GlIcon:n.a,NoteHeader:s.a,GlButton:a.a},directives:{GlTooltip:r.a},props:{id:{type:[String,Number],required:!1,default:void 0},author:{type:Object,required:!0},createdAt:{type:String,required:!1,default:""},iconName:{type:String,required:!1,default:"plus"},iconClass:{type:String,required:!1,default:"ci-status-icon-success"},actionButtons:{type:Array,required:!1,default:function(){return[]}},showRightSlot:{type:Boolean,required:!1,default:!1},showActionButtons:{type:Boolean,required:!1,default:!0}},computed:{noteId(){return this.id?"note_"+this.id:void 0}}},o=i("bPvS"),d=Object(o.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"gl-display-flex gl-align-items-center",attrs:{id:e.noteId}},[i("div",{staticClass:"circle-icon-container gl-flex-shrink-0 gl-align-self-start",class:e.iconClass},[i("gl-icon",{attrs:{size:16,name:e.iconName}})],1),e._v(" "),i("div",{staticClass:"gl-ml-5 gl-flex-grow-1",attrs:{"data-qa-selector":"event_item_content"}},[i("note-header",{staticClass:"gl-pb-0 gl-pl-0",attrs:{"note-id":e.id,author:e.author,"created-at":e.createdAt,"show-spinner":!1}},[e._t("header-message",(function(){return[e._v("·")]}))],2),e._v(" "),e._t("default")],2),e._v(" "),e.showRightSlot?e._t("right-content"):e.showActionButtons?i("div",{staticClass:"gl-flex-shrink-0 gl-align-self-start",attrs:{"data-testid":"action-buttons"}},e._l(e.actionButtons,(function(e){return i("gl-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],key:e.title,attrs:{category:"tertiary",icon:e.iconName,title:e.title,"aria-label":e.title},on:{click:e.onClick}})})),1):e._e()],2)}),[],!1,null,null,null);t.a=d.exports},YG98:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("CkNe"),a=i("/LsX"),r=i("0sqQ");const s=function(e){const t=["dismissVulnerability","addDismissalComment","deleteDismissalComment","revertDismissVulnerability"],i=e?[e,t]:[t];return{methods:{...Object(n.c)(...i),handleDismissVulnerability(e){return this.dismissVulnerability(e).then(this.hideModal)},handleAddDismissalComment(e){return this.addDismissalComment(e).then(this.hideModal)},handleDeleteDismissalComment(e){return this.deleteDismissalComment(e).then(this.hideModal)},handleRevertDismissVulnerability(e){return this.revertDismissVulnerability(e).then(this.hideModal)},hideModal(){this.modal.error||this.$root.$emit(a.c,r.d)}}}}},aPPG:function(e,t,i){"use strict";var n=i("RwX1"),a=i("vRHk");t.a=function(e){if(!e)return"";const t=e.toLowerCase();return n.e[t]||Object(a.q)(t)}},aSYY:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return l})),i.d(t,"n",(function(){return o})),i.d(t,"o",(function(){return d})),i.d(t,"j",(function(){return c})),i.d(t,"k",(function(){return u})),i.d(t,"p",(function(){return m})),i.d(t,"l",(function(){return v})),i.d(t,"g",(function(){return p})),i.d(t,"f",(function(){return f})),i.d(t,"i",(function(){return g})),i.d(t,"h",(function(){return h})),i.d(t,"m",(function(){return b})),i.d(t,"e",(function(){return y})),i.d(t,"q",(function(){return k}));var n=i("qDmM");const a="dismissal",r="issue",s="merge_request",l={ARCHIVE:"ARCHIVE",TRACE:"TRACE",METADATA:"METADATA"},o="sast",d="sast_iac",c="dast",u="dast_profiles",m="secret_detection",v="dependency_scanning",p="container_scanning",f="cluster_image_scanning",g="coverage_fuzzing",h="corpus_management",b="license_scanning",y="api_fuzzing",k={[o]:"SAST",[m]:"SECRET_DETECTION"};i.n(n)()(k)},bTFz:function(e,t,i){"use strict";var n=i("H8gz"),a=i("sEKB"),r={name:"LicenseStatusIcon",components:{GlIcon:n.a},props:{status:{type:String,required:!0},statusIconSize:{type:Number,required:!1,default:12}},computed:{iconName(){return this.isStatusFailed?"status-failed":this.isStatusSuccess?"status-success":"status-alert"},isStatusFailed(){return this.status===a.g},isStatusSuccess(){return this.status===a.i},isStatusNeutral(){return this.status===a.h}}},s=i("bPvS"),l=Object(s.a)(r,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"report-block-list-icon",class:{failed:this.isStatusFailed,success:this.isStatusSuccess,neutral:this.isStatusNeutral}},[t("gl-icon",{staticClass:"gl-mb-1",attrs:{name:this.iconName,size:this.statusIconSize,"data-qa-selector":"status_"+this.status+"_icon"}})],1)}),[],!1,null,null,null);t.a=l.exports},"c/7B":function(e,t,i){"use strict";var n=i("0X+3"),a=i("ly/8"),r={components:{GlDropdownItem:n.a},directives:{GlTooltip:a.a},props:{isChecked:{type:Boolean,required:!0},text:{type:String,required:!1,default:""},disabled:{type:Boolean,required:!1,default:!1},tooltip:{type:String,required:!1,default:""}},computed:{qaSelector(){return`filter_${this.text.toLowerCase().replaceAll(" ","_")}_dropdown_item`}},methods:{emitClick(){this.disabled||this.$emit("click")}}},s=i("bPvS"),l=Object(s.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-dropdown-item",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.left.viewport.d0",value:e.tooltip,expression:"tooltip",modifiers:{left:!0,viewport:!0,d0:!0}}],attrs:{"is-check-item":"","is-checked":e.isChecked,"data-qa-selector":e.qaSelector,disabled:e.disabled},nativeOn:{"!click":function(t){return t.stopPropagation(),e.emitClick.apply(null,arguments)}}},[e._t("default",(function(){return[i("span",{class:{"gl-text-gray-600":e.disabled}},[e._v(e._s(e.text))])]}))],2)}),[],!1,null,null,null);t.a=l.exports},cCpR:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"instanceVulnerabilityHistory"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"startDate"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ISO8601Date"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"endDate"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ISO8601Date"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCountByDay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"startDate"},value:{kind:"Variable",name:{kind:"Name",value:"startDate"}}},{kind:"Argument",name:{kind:"Name",value:"endDate"},value:{kind:"Variable",name:{kind:"Name",value:"endDate"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"critical"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"high"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"medium"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"low"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:243}};i.loc.source={body:"query instanceVulnerabilityHistory($startDate: ISO8601Date!, $endDate: ISO8601Date!) {\n  vulnerabilitiesCountByDay(startDate: $startDate, endDate: $endDate) {\n    nodes {\n      date\n      critical\n      high\n      medium\n      low\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.instanceVulnerabilityHistory=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"instanceVulnerabilityHistory")},dkvl:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"clusterAgents"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"clusterAgents"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:162}};i.loc.source={body:"query clusterAgents($projectPath: ID!) {\n  project(fullPath: $projectPath) {\n    id\n    clusterAgents {\n      nodes {\n        id\n        name\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.clusterAgents=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"clusterAgents")},e2Sm:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return c})),i.d(t,"d",(function(){return m})),i.d(t,"e",(function(){return v}));i("uHfJ"),i("R0RX");var n=i("t9l/"),a=i("HDPV"),r=i("RwX1"),s=i("aSYY");const l={CHECKBOX:{key:"checkbox",class:"checkbox"},DETECTED:{key:"detected",label:Object(n.g)("Vulnerability|Detected"),class:"detected",sortable:!0},STATUS:{key:"state",label:Object(n.g)("Vulnerability|Status"),class:"status"},SEVERITY:{key:"severity",label:Object(n.g)("Vulnerability|Severity"),class:"severity",sortable:!0},DESCRIPTION:{key:"title",label:Object(n.a)("Description"),class:"description gl-word-break-all"},IDENTIFIER:{key:"identifier",label:Object(n.g)("Vulnerability|Identifier"),class:"identifier gl-word-break-all"},TOOL:{key:"reportType",label:Object(n.g)("Reports|Tool"),class:"scanner"},CLUSTER:{key:"cluster",label:Object(n.g)("Vulnerability|Cluster"),thClass:"gl-w-15p",class:"cluster gl-word-break-all"},ACTIVITY:{key:"activity",label:Object(n.g)("Vulnerability|Activity"),thClass:"gl-text-right",class:"activity"}},o={STATUS:a.l,SEVERITY:a.i,ACTIVITY:a.b,IMAGE:a.g,TOOL_SIMPLE:a.j,TOOL_VENDOR:a.m,TOOL_PIPELINE:a.k,PROJECT:a.h,CLUSTER:a.c},d={START:[l.DETECTED,l.STATUS,l.SEVERITY,l.DESCRIPTION],END:[l.ACTIVITY]},c={DEVELOPMENT:[...d.START,l.IDENTIFIER,l.TOOL,...d.END],OPERATIONAL:[...d.START,l.CLUSTER,...d.END],AGENT:[...d.START,...d.END]},u={START:[o.STATUS,o.SEVERITY],END:[o.ACTIVITY]},m={DEVELOPMENT_PROJECT:[...u.START,o.TOOL_VENDOR,...u.END],DEVELOPMENT:[...u.START,o.TOOL_SIMPLE,o.PROJECT,...u.END],OPERATIONAL_PROJECT:[...u.START,o.CLUSTER,o.IMAGE,...u.END],OPERATIONAL:[...u.START,o.PROJECT,...u.END],AGENT:[...u.START,o.IMAGE,...u.END]},v={DEVELOPMENT:Object.keys(r.h).map((function(e){return e.toUpperCase()})),OPERATIONAL:[s.f.toUpperCase()]}},e7pO:function(e,t){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"Project"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Project"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nameWithNamespace"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"securityDashboardPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"path"},arguments:[],directives:[]}]}}],loc:{start:0,end:118}};i.loc.source={body:"fragment Project on Project {\n  id\n  name\n  nameWithNamespace\n  securityDashboardPath\n  fullPath\n  avatarUrl\n  path\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.Project=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"Project")},eLLD:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"groupVulnerabilityHistory"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"startDate"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ISO8601Date"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"endDate"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ISO8601Date"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"group"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCountByDay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"startDate"},value:{kind:"Variable",name:{kind:"Name",value:"startDate"}}},{kind:"Argument",name:{kind:"Name",value:"endDate"},value:{kind:"Variable",name:{kind:"Name",value:"endDate"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"critical"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"high"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"medium"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"low"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:316}};i.loc.source={body:"query groupVulnerabilityHistory($fullPath: ID!, $startDate: ISO8601Date!, $endDate: ISO8601Date!) {\n  group(fullPath: $fullPath) {\n    id\n    vulnerabilitiesCountByDay(startDate: $startDate, endDate: $endDate) {\n      nodes {\n        date\n        critical\n        high\n        medium\n        low\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.groupVulnerabilityHistory=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"groupVulnerabilityHistory")},fxsL:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"vulnerabilityDismiss"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"comment"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilityDismiss"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"comment"},value:{kind:"Variable",name:{kind:"Name",value:"comment"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerability"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"dismissedAt"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:220}};i.loc.source={body:"mutation vulnerabilityDismiss($id: VulnerabilityID!, $comment: String!) {\n  vulnerabilityDismiss(input: { id: $id, comment: $comment }) {\n    errors\n    vulnerability {\n      id\n      state\n      dismissedAt\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.vulnerabilityDismiss=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"vulnerabilityDismiss")},gjqA:function(e,t,i){"use strict";var n=i("OkMp"),a=i("0X+3"),r=i("yYHy"),s={components:{GlDropdown:n.a,GlDropdownItem:a.a},props:{buttons:{type:Array,required:!0},disabled:{type:Boolean,required:!1,default:!1}},data:()=>({selectedButtonIndex:0}),computed:{selectedButton(){return this.buttons[this.selectedButtonIndex]}},methods:{setButton(e){this.selectedButtonIndex=e},handleClick(){this.selectedButton.href?Object(r.Q)(this.selectedButton.href,!0):this.$emit(this.selectedButton.action)}}},l=i("bPvS"),o=Object(l.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.selectedButton?i("gl-dropdown",{attrs:{disabled:e.disabled,variant:"success",text:e.selectedButton.name,href:e.selectedButton.href,loading:e.selectedButton.loading,split:""},on:{click:e.handleClick}},e._l(e.buttons,(function(t,n){return i("gl-dropdown-item",{key:t.action,attrs:{"is-checked":e.selectedButton===t,"is-check-item":""},on:{click:function(t){return e.setButton(n)}}},[i("strong",[e._v(e._s(t.name))]),e._v(" "),i("br"),e._v(" "),i("span",[e._v(e._s(t.tagline))])])})),1):e._e()}),[],!1,null,null,null);t.a=o.exports},h7Xa:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"vulnerabilityRevertToDetected"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilityRevertToDetected"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerability"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"detectedAt"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:199}};i.loc.source={body:"mutation vulnerabilityRevertToDetected($id: VulnerabilityID!) {\n  vulnerabilityRevertToDetected(input: { id: $id }) {\n    errors\n    vulnerability {\n      id\n      state\n      detectedAt\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.vulnerabilityRevertToDetected=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"vulnerabilityRevertToDetected")},hY08:function(e,t,i){"use strict";i("h8Et");var n=i("H8gz"),a=i("ly/8"),r=i("RwX1"),s=i("0sqQ"),l={name:"SeverityBadge",components:{GlIcon:n.a},directives:{tooltip:a.a},props:{severity:{type:String,required:!0}},computed:{hasSeverityBadge(){return Object.keys(s.b).includes(this.severityKey)},severityKey(){var e;return null===(e=this.severity)||void 0===e?void 0:e.toLowerCase()},className(){return s.b[this.severityKey]},iconName(){return"severity-"+this.severityKey},severityTitle(){return r.i[this.severityKey]||this.severity},tooltipTitle(){return s.c[this.severityKey]}}},o=i("bPvS"),d=Object(o.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.hasSeverityBadge?i("div",{staticClass:"severity-badge text-sm-left text-nowrap gl-text-gray-900"},[i("span",{class:e.className},[i("gl-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.tooltipTitle,expression:"tooltipTitle"}],staticClass:"gl-mr-3",attrs:{name:e.iconName,size:12}})],1),e._v("\n  "+e._s(e.severityTitle)+"\n")]):e._e()}),[],!1,null,null,null);t.a=d.exports},hzXV:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"pipelineFindings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pipelineId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"severity"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportType"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scanner"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"state"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityState"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"vetEnabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pipeline"},arguments:[{kind:"Argument",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"pipelineId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"securityReportFindings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"severity"},value:{kind:"Variable",name:{kind:"Name",value:"severity"}}},{kind:"Argument",name:{kind:"Name",value:"reportType"},value:{kind:"Variable",name:{kind:"Name",value:"reportType"}}},{kind:"Argument",name:{kind:"Name",value:"scanner"},value:{kind:"Variable",name:{kind:"Name",value:"scanner"}}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"Variable",name:{kind:"Name",value:"state"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"id"},name:{kind:"Name",value:"uuid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"falsePositive"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"vetEnabled"}}}]}]},{kind:"Field",name:{kind:"Name",value:"confidence"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifiers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"reportType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"scanner"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vendor"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"severity"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"solution"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilityLocation"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PageInfo"},directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:1354}};n.loc.source={body:'#import "~/graphql_shared/fragments/page_info.fragment.graphql"\n#import "../fragments/vulnerability_location.fragment.graphql"\n\nquery pipelineFindings(\n  $fullPath: ID!\n  $pipelineId: ID!\n  $first: Int\n  $last: Int\n  $before: String\n  $after: String\n  $severity: [String!]\n  $reportType: [String!]\n  $scanner: [String!]\n  $state: [VulnerabilityState!]\n  $vetEnabled: Boolean = false\n) {\n  project(fullPath: $fullPath) {\n    id\n    pipeline(iid: $pipelineId) {\n      id\n      securityReportFindings(\n        before: $before\n        after: $after\n        first: $first\n        last: $last\n        severity: $severity\n        reportType: $reportType\n        scanner: $scanner\n        state: $state\n      ) {\n        nodes {\n          # This query is used by vulnerability_list_graphql.vue, which expects an id property for\n          # the bulk select feature.\n          id: uuid\n          name\n          description\n          falsePositive @include(if: $vetEnabled)\n          confidence\n          identifiers {\n            externalType\n            name\n          }\n          reportType\n          scanner {\n            id\n            vendor\n          }\n          state\n          severity\n          solution\n          location {\n            ...VulnerabilityLocation\n          }\n        }\n        pageInfo {\n          ...PageInfo\n        }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)}))}n.definitions=n.definitions.concat(r(i("IVfO").definitions)),n.definitions=n.definitions.concat(r(i("9X95").definitions));var s={};function l(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),s[e.name.value]=t}})),e.exports=n,e.exports.pipelineFindings=function(e,t){var i={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=s[t]||new Set,a=new Set,r=new Set;for(n.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(t){var n=l(e,t);n&&i.definitions.push(n)})),i}(n,"pipelineFindings")},ifd7:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n="licenseManagement"},k0ue:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"groupSpecificScanners"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"group"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilityScanners"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilityScanner"},directives:[]}]}}]}}]}}]}}],loc:{start:0,end:268}};n.loc.source={body:'#import "ee/security_dashboard/graphql/fragments/vulnerability_scanner.fragment.graphql"\n\nquery groupSpecificScanners($fullPath: ID!) {\n  group(fullPath: $fullPath) {\n    id\n    vulnerabilityScanners {\n      nodes {\n        ...VulnerabilityScanner\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};n.definitions=n.definitions.concat(i("SJpF").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)})));var r={};function s(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),r[e.name.value]=t}})),e.exports=n,e.exports.groupSpecificScanners=function(e,t){var i={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=r[t]||new Set,a=new Set,l=new Set;for(n.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(r[e]||new Set).forEach((function(e){l.add(e)})))}))}return a.forEach((function(t){var n=s(e,t);n&&i.definitions.push(n)})),i}(n,"groupSpecificScanners")},kACY:function(e,t){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"SecurityReportSummaryScans"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SecurityReportSummarySection"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"scans"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"warnings"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:156}};i.loc.source={body:"fragment SecurityReportSummaryScans on SecurityReportSummarySection {\n  scans {\n    nodes {\n      name\n      status\n      errors\n      warnings\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.SecurityReportSummaryScans=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"SecurityReportSummaryScans")},"kM/M":function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"groupVulnerabilities"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"20"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"severity"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitySeverity"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportType"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityReportType"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scanner"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scannerId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitiesScannerID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"state"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityState"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sort"}},type:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilitySort"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"vetEnabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clusterAgentId"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClustersAgentID"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"group"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilities"},arguments:[{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"severity"},value:{kind:"Variable",name:{kind:"Name",value:"severity"}}},{kind:"Argument",name:{kind:"Name",value:"reportType"},value:{kind:"Variable",name:{kind:"Name",value:"reportType"}}},{kind:"Argument",name:{kind:"Name",value:"scanner"},value:{kind:"Variable",name:{kind:"Name",value:"scanner"}}},{kind:"Argument",name:{kind:"Name",value:"scannerId"},value:{kind:"Variable",name:{kind:"Name",value:"scannerId"}}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"Variable",name:{kind:"Name",value:"state"}}},{kind:"Argument",name:{kind:"Name",value:"projectId"},value:{kind:"Variable",name:{kind:"Name",value:"projectId"}}},{kind:"Argument",name:{kind:"Name",value:"sort"},value:{kind:"Variable",name:{kind:"Name",value:"sort"}}},{kind:"Argument",name:{kind:"Name",value:"hasIssues"},value:{kind:"Variable",name:{kind:"Name",value:"hasIssues"}}},{kind:"Argument",name:{kind:"Name",value:"hasResolution"},value:{kind:"Variable",name:{kind:"Name",value:"hasResolution"}}},{kind:"Argument",name:{kind:"Name",value:"clusterAgentId"},value:{kind:"Variable",name:{kind:"Name",value:"clusterAgentId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VulnerabilityFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PageInfo"},directives:[]}]}}]}}]}}]}}],loc:{start:0,end:1110}};n.loc.source={body:'#import "../fragments/vulnerability.fragment.graphql"\n#import "~/graphql_shared/fragments/page_info.fragment.graphql"\n\nquery groupVulnerabilities(\n  $fullPath: ID!\n  $before: String\n  $after: String\n  $first: Int = 20\n  $last: Int\n  $projectId: [ID!]\n  $severity: [VulnerabilitySeverity!]\n  $reportType: [VulnerabilityReportType!]\n  $scanner: [String!]\n  $scannerId: [VulnerabilitiesScannerID!]\n  $state: [VulnerabilityState!]\n  $sort: VulnerabilitySort\n  $hasIssues: Boolean\n  $hasResolution: Boolean\n  $vetEnabled: Boolean = false\n  $clusterAgentId: [ClustersAgentID!]\n) {\n  group(fullPath: $fullPath) {\n    id\n    vulnerabilities(\n      before: $before\n      after: $after\n      first: $first\n      last: $last\n      severity: $severity\n      reportType: $reportType\n      scanner: $scanner\n      scannerId: $scannerId\n      state: $state\n      projectId: $projectId\n      sort: $sort\n      hasIssues: $hasIssues\n      hasResolution: $hasResolution\n      clusterAgentId: $clusterAgentId\n    ) {\n      nodes {\n        ...VulnerabilityFragment\n      }\n      pageInfo {\n        ...PageInfo\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)}))}n.definitions=n.definitions.concat(r(i("B9Cy").definitions)),n.definitions=n.definitions.concat(r(i("IVfO").definitions));var s={};function l(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),s[e.name.value]=t}})),e.exports=n,e.exports.groupVulnerabilities=function(e,t){var i={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=s[t]||new Set,a=new Set,r=new Set;for(n.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(t){var n=l(e,t);n&&i.definitions.push(n)})),i}(n,"groupVulnerabilities")},nkAn:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"pipelineSecuritySummary"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pipelineIid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportTypes"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SecurityReportTypeEnum"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pipeline"},arguments:[{kind:"Argument",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"pipelineIid"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"JobArtifacts"},directives:[]},{kind:"Field",name:{kind:"Name",value:"securityReportSummary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dast"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"scannedResourcesCsvPath"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SecurityReportSummaryScans"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sast"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SecurityReportSummaryScans"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"containerScanning"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SecurityReportSummaryScans"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"dependencyScanning"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SecurityReportSummaryScans"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"apiFuzzing"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SecurityReportSummaryScans"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"coverageFuzzing"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SecurityReportSummaryScans"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"clusterImageScanning"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SecurityReportSummaryScans"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"secretDetection"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"vulnerabilitiesCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"SecurityReportSummaryScans"},directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:1651}};n.loc.source={body:'#import "../fragments/security_report_scans.fragment.graphql"\n#import "~/vue_shared/security_reports/graphql/fragments/job_artifacts.fragment.graphql"\n\nquery pipelineSecuritySummary(\n  $fullPath: ID!\n  $pipelineIid: ID!\n  $reportTypes: [SecurityReportTypeEnum!]\n) {\n  project(fullPath: $fullPath) {\n    id\n    pipeline(iid: $pipelineIid) {\n      id\n      # eslint-disable-next-line @graphql-eslint/require-id-when-available\n      ...JobArtifacts\n      securityReportSummary {\n        dast {\n          vulnerabilitiesCount\n          scannedResourcesCsvPath\n          ...SecurityReportSummaryScans\n          # The following fields will be added in\n          # https://gitlab.com/gitlab-org/gitlab/-/issues/321586\n          # scannedResourcesCount\n          # scannedResources {\n          #   nodes {\n          #     requestMethod\n          #     url\n          #   }\n          # }\n        }\n        sast {\n          vulnerabilitiesCount\n          ...SecurityReportSummaryScans\n        }\n        containerScanning {\n          vulnerabilitiesCount\n          ...SecurityReportSummaryScans\n        }\n        dependencyScanning {\n          vulnerabilitiesCount\n          ...SecurityReportSummaryScans\n        }\n        apiFuzzing {\n          vulnerabilitiesCount\n          ...SecurityReportSummaryScans\n        }\n        coverageFuzzing {\n          vulnerabilitiesCount\n          ...SecurityReportSummaryScans\n        }\n        clusterImageScanning {\n          vulnerabilitiesCount\n          ...SecurityReportSummaryScans\n        }\n        secretDetection {\n          vulnerabilitiesCount\n          ...SecurityReportSummaryScans\n        }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)}))}n.definitions=n.definitions.concat(r(i("kACY").definitions)),n.definitions=n.definitions.concat(r(i("53mf").definitions));var s={};function l(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),s[e.name.value]=t}})),e.exports=n,e.exports.pipelineSecuritySummary=function(e,t){var i={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=s[t]||new Set,a=new Set,r=new Set;for(n.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(t){var n=l(e,t);n&&i.definitions.push(n)})),i}(n,"pipelineSecuritySummary")},pksH:function(e,t,i){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"groupVulnerabilityGrades"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"group"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilityGrades"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeSubgroups"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"grade"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"projects"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Project"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ProjectVulnerabilitySeveritiesCount"},directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:476}};n.loc.source={body:'#import "ee/security_dashboard/graphql/fragments/project.fragment.graphql"\n#import "ee/security_dashboard/graphql/fragments/project_vulnerability_severities_count.fragment.graphql"\n\nquery groupVulnerabilityGrades($fullPath: ID!) {\n  group(fullPath: $fullPath) {\n    id\n    vulnerabilityGrades(includeSubgroups: true) {\n      grade\n      count\n      projects {\n        nodes {\n          ...Project\n          ...ProjectVulnerabilitySeveritiesCount\n        }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!a[t]&&(a[t]=!0,!0)}))}n.definitions=n.definitions.concat(r(i("e7pO").definitions)),n.definitions=n.definitions.concat(r(i("Pl9t").definitions));var s={};function l(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}n.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),s[e.name.value]=t}})),e.exports=n,e.exports.groupVulnerabilityGrades=function(e,t){var i={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var n=s[t]||new Set,a=new Set,r=new Set;for(n.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){a.has(e)||(a.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(t){var n=l(e,t);n&&i.definitions.push(n)})),i}(n,"groupVulnerabilityGrades")},qKmR:function(e,t){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"Url"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailUrl"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"href"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"Diff"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailDiff"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"before"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"after"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"Code"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailCode"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"FileLocation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailFileLocation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fileName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lineStart"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lineEnd"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"ModuleLocation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailModuleLocation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"moduleName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"offset"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"Commit"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailCommit"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"Text"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailText"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"Markdown"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailMarkdown"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"Boolean"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailBoolean"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"Int"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailInt"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"NonNestedReportTypes"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetail"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FileLocation"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Url"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Diff"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Code"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Commit"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Markdown"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"Text"},directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"ListFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailList"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"type"},name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"List"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailList"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ListFields"},directives:[]},{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"NonNestedReportTypes"},directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VulnerabilityDetailList"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ListFields"},directives:[]},{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"NonNestedReportTypes"},directives:[]}]}}]}}]}}]}}],loc:{start:0,end:1336}};i.loc.source={body:"fragment Url on VulnerabilityDetailUrl {\n  type: __typename\n  name\n  href\n}\n\nfragment Diff on VulnerabilityDetailDiff {\n  type: __typename\n  name\n  before\n  after\n}\n\nfragment Code on VulnerabilityDetailCode {\n  type: __typename\n  name\n  value\n}\n\nfragment FileLocation on VulnerabilityDetailFileLocation {\n  type: __typename\n  name\n  fileName\n  lineStart\n  lineEnd\n}\n\nfragment ModuleLocation on VulnerabilityDetailModuleLocation {\n  type: __typename\n  name\n  moduleName\n  offset\n}\n\nfragment Commit on VulnerabilityDetailCommit {\n  type: __typename\n  name\n  value\n}\n\nfragment Text on VulnerabilityDetailText {\n  type: __typename\n  name\n  value\n}\n\nfragment Markdown on VulnerabilityDetailMarkdown {\n  type: __typename\n  name\n  value\n}\n\nfragment Boolean on VulnerabilityDetailBoolean {\n  type: __typename\n  name\n  value\n}\n\nfragment Int on VulnerabilityDetailInt {\n  type: __typename\n  name\n  value\n}\n\nfragment NonNestedReportTypes on VulnerabilityDetail {\n  ...FileLocation\n  ...Url\n  ...Diff\n  ...Code\n  ...Commit\n  ...Markdown\n  ...Text\n}\n\nfragment ListFields on VulnerabilityDetailList {\n  type: __typename\n  name\n}\n\nfragment List on VulnerabilityDetailList {\n  ...ListFields\n  items {\n    ...NonNestedReportTypes\n    ... on VulnerabilityDetailList {\n      ...ListFields\n      items {\n        ...NonNestedReportTypes\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}function r(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.Url=r(i,"Url"),e.exports.Diff=r(i,"Diff"),e.exports.Code=r(i,"Code"),e.exports.FileLocation=r(i,"FileLocation"),e.exports.ModuleLocation=r(i,"ModuleLocation"),e.exports.Commit=r(i,"Commit"),e.exports.Text=r(i,"Text"),e.exports.Markdown=r(i,"Markdown"),e.exports.Boolean=r(i,"Boolean"),e.exports.Int=r(i,"Int"),e.exports.NonNestedReportTypes=r(i,"NonNestedReportTypes"),e.exports.ListFields=r(i,"ListFields"),e.exports.List=r(i,"List")},qzef:function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"i",(function(){return o})),i.d(t,"l",(function(){return d})),i.d(t,"j",(function(){return c})),i.d(t,"e",(function(){return u})),i.d(t,"g",(function(){return m})),i.d(t,"h",(function(){return v})),i.d(t,"k",(function(){return p})),i.d(t,"f",(function(){return f})),i.d(t,"d",(function(){return g}));var n=i("qDmM"),a=i.n(n),r=i("t9l/"),s=i("aSYY");i.d(t,"a",(function(){return s.d})),i.d(t,"b",(function(){return s.j}));const l="DAST",o={...s.q,[s.e]:"API_FUZZING",[s.i]:"COVERAGE_FUZZING",[s.j]:l,[s.l]:"DEPENDENCY_SCANNING",[s.g]:"CONTAINER_SCANNING",[s.f]:"CLUSTER_IMAGE_SCANNING"},d=a()(o),c={title:Object(r.g)("ciReport|Static Application Security Testing (SAST) detects known vulnerabilities in your source code."),copy:Object(r.g)("ciReport|%{linkStartTag}Learn more about SAST %{linkEndTag}")},u={title:Object(r.g)("ciReport|Container scanning detects known vulnerabilities in your docker images."),copy:Object(r.g)("ciReport|%{linkStartTag}Learn more about Container Scanning %{linkEndTag}")},m={title:Object(r.g)("ciReport|Dynamic Application Security Testing (DAST) detects known vulnerabilities in your web application."),copy:Object(r.g)("ciReport|%{linkStartTag}Learn more about DAST %{linkEndTag}")},v={title:Object(r.g)("ciReport|Dependency Scanning detects known vulnerabilities in your source code's dependencies."),copy:Object(r.g)("ciReport|%{linkStartTag}Learn more about Dependency Scanning %{linkEndTag}")},p={title:Object(r.g)("ciReport|Secret Detection detects secrets and credentials vulnerabilities in your source code."),copy:Object(r.g)("ciReport|%{linkStartTag}Learn more about Secret Detection %{linkEndTag}")},f={title:Object(r.g)("ciReport|Coverage Fuzzing"),copy:Object(r.g)("ciReport|%{linkStartTag}Learn more about Coverage Fuzzing %{linkEndTag}")},g={title:Object(r.g)("ciReport|API Fuzzing"),copy:Object(r.g)("ciReport|%{linkStartTag}Learn more about API Fuzzing%{linkEndTag}")}},rEpW:function(e,t,i){"use strict";var n=i("FKix"),a=i.n(n),r=i("pY+i"),s=i.n(r),l=(i("ujLG"),i("3R5X"),i("HaUQ"),i("SXnf"),i("f5Le"),i("TTAZ"),i("W2Di"),i("9gLG"),i("pO+W"),i("DGqX"),i("DuA4"),i("8AuF"),i("bDpz"),i("JbNT"),i("CYm8"),i("s4MS"),i("fDBp"),i("Z+bI"),i("n0qn"),i("uHfJ"),i("R0RX"),i("h8Et"),i("EghD")),o=i("c/7B"),d={components:{FilterBody:l.a,FilterItem:o.a},props:{filter:{type:Object,required:!0}},data:()=>({selectedOptions:void 0}),computed:{options(){return this.filter.options},selectedSet(){return new Set(this.selectedOptions)},isNoOptionsSelected(){var e;return(null===(e=this.selectedOptions)||void 0===e?void 0:e.length)<=0},selectedOptionsOrAll(){var e;return null!==(e=this.selectedOptions)&&void 0!==e&&e.length?this.selectedOptions:[this.filter.allOption]},filterObject(){return{[this.filter.id]:this.selectedOptions.map((function(e){return e.id}))}},querystringIds(){var e;const t=(null===(e=this.$route)||void 0===e?void 0:e.query[this.filter.id])||[];return(Array.isArray(t)?t:[t]).sort()},querystringOptions(){var e=this;if(this.querystringIds.includes(this.filter.allOption.id))return[];const t=this.options.filter((function(t){return e.querystringIds.includes(t.id)}));return t.length?t:this.filter.defaultOptions}},watch:{selectedOptions(){this.emitFilterChanged(this.filterObject)}},created(){this.processQuerystringIds(),window.addEventListener("popstate",this.processQuerystringIds)},methods:{toggleOption(e){this.selectedOptions=a()(this.selectedOptions,[e]),this.updateQuerystring()},deselectAllOptions(){this.selectedOptions=[],this.updateQuerystring()},updateQuerystring(){const e=this.selectedOptionsOrAll.map((function(e){return e.id}));if(!this.$router||s()(this.querystringIds,e))return;const t={...this.$route.query,[this.filter.id]:e};this.$router.push({query:t})},isSelected(e){return this.selectedSet.has(e)},processQuerystringIds(){this.selectedOptions=this.querystringOptions},emitFilterChanged(e){this.$emit("filter-changed",e)}}},c=i("bPvS"),u=Object(c.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("filter-body",{attrs:{name:e.filter.name,"selected-options":e.selectedOptionsOrAll}},[e.filter.allOption?i("filter-item",{attrs:{"is-checked":e.isNoOptionsSelected,text:e.filter.allOption.name,"data-testid":"allOption"},on:{click:e.deselectAllOptions}}):e._e(),e._v(" "),e._l(e.options,(function(t){return i("filter-item",{key:t.id,attrs:{"is-checked":e.isSelected(t),text:t.name,"data-testid":e.filter.id+":"+t.id},on:{click:function(i){return e.toggleOption(t)}}})}))],2)}),[],!1,null,null,null);t.a=u.exports},s6oH:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"revertFindingToDetected"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uuid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"securityFindingRevertToDetected"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"uuid"},value:{kind:"Variable",name:{kind:"Name",value:"uuid"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:128}};i.loc.source={body:"mutation revertFindingToDetected($uuid: String!) {\n  securityFindingRevertToDetected(input: { uuid: $uuid }) {\n    errors\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.revertFindingToDetected=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"revertFindingToDetected")},swNW:function(e,t,i){"use strict";var n=i("q+nE"),a=i("3lde"),r=i("52Lr"),s=i("7SPT"),l=i("RwX1"),o=i("oj/M"),d=i("pksH"),c=i.n(d),u=i("eLLD"),m=i.n(u),v=i("XEE8"),p=i.n(v),f=i("cCpR"),g=i.n(f),h=i("t9l/"),b=i("ifzy"),y=i.n(b),k=(i("uHfJ"),i("R0RX"),i("0no1"),i("3R5X"),i("gdbl"),i("JHu5"),i("XUYm"),i("PJNv")),S=i("ly/8"),_=i("vdBz"),N=i("hY08"),E=i("2Yuc"),D=i("U1Ws"),C=i("Zi5e"),O=i("teVv"),I=i("zLBL"),T={components:{GlLoadingIcon:I.a},props:{isLoading:{type:Boolean,required:!1,default:!1}}},j=i("bPvS"),V=Object(j.a)(T,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"gl-border-solid gl-rounded-base gl-border-1 gl-border-gray-100 gl-display-flex gl-flex-direction-column"},[i("header",{staticClass:"gl-p-5"},[i("h4",{staticClass:"gl-mt-0 gl-mb-3",attrs:{"data-testid":"title"}},[e._t("title")],2),e._v(" "),i("p",{staticClass:"gl-text-secondary gl-m-0",attrs:{"data-testid":"help-text"}},[e._t("help-text")],2),e._v(" "),e.$scopedSlots.controls?i("div",{staticClass:"gl-mt-5",attrs:{"data-testid":"controls"}},[e._t("controls")],2):e._e()]),e._v(" "),e.isLoading?i("gl-loading-icon",{staticClass:"gl-my-12",attrs:{size:"lg"}}):e._t("default")],2)}),[],!1,null,null,null).exports,L=i("ZplN"),R=i("cuRJ"),w={name:"VulnerabilityChartButtons",components:{GlButtonGroup:L.a,GlButton:R.a},props:{days:{type:Array,required:!0},activeDay:{type:Number,required:!0}},computed:{buttons(){return this.days.map((function(e){return{text:Object(h.f)("1 Day","%d Days",e),day:e}}))}},methods:{inputHandler(e){this.$emit("days-selected",e)}}},x=Object(j.a)(w,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("gl-button-group",{staticClass:"gl-display-flex"},e._l(e.buttons,(function(t){var n=t.text,a=t.day;return i("gl-button",{key:a,attrs:{selected:a===e.activeDay},on:{click:function(t){return e.inputHandler(a)}}},[e._v("\n    "+e._s(n)+"\n  ")])})),1)}),[],!1,null,null,null).exports;const P=[l.i.critical,l.i.high,l.i.medium,l.i.low].map((function(e){return e.toLowerCase()}));var A={components:{SecurityDashboardCard:V,ChartButtons:x,GlSparklineChart:_.a,GlTableLite:k.a,SeverityBadge:N.a},directives:{GlTooltip:S.a},inject:["groupFullPath"],props:{query:{type:Object,required:!0}},data:()=>({vulnerabilitiesHistory:{},selectedDayRange:l.b.thirty}),days:Object.values(l.b),fields:[{key:"severityLevel",label:Object(h.g)("VulnerabilityChart|Severity"),tdClass:"gl-border-none!"},{key:"chartData",label:"",tdClass:"gl-border-none! gl-w-full"},{key:"changeInPercent",label:"%",thClass:"gl-text-right",tdClass:"gl-border-none! gl-text-right"},{key:"currentVulnerabilitiesCount",label:"#",thClass:"gl-text-right",tdClass:"gl-border-none! gl-text-right"}],apollo:{vulnerabilitiesHistory:{query(){return this.query},variables(){return{fullPath:this.groupFullPath,startDate:Object(D.q)(this.startDate,"isoDate"),endDate:this.formattedEndDateCursor}},update(e){return this.processRawData(e)},error(){Object(O.createAlert)({message:Object(h.g)("SecurityReports|Error fetching the vulnerabilities over time. Please check your network connection and try again.")})}}},computed:{startDate(){return Object(D.k)(D.N*this.selectedDayRange)},endDateCursor:()=>Date.now(),formattedEndDateCursor(){return Object(D.q)(new Date(this.endDateCursor),"isoDate")},charts(){var e=this;return P.map((function(t){const i=Object.entries(e.vulnerabilitiesHistory[t]||{}),n=i.length?i:e.emptyDataSet,[a,r]=Object(E.a)(n);return{severityLevel:t,chartData:n,changeInPercent:Object(C.d)(a,r),currentVulnerabilitiesCount:r}}))},dateInfo(){return Object(h.h)(Object(h.g)("VulnerabilityChart|%{formattedStartDate} to today"),{formattedStartDate:Object(D.q)(this.startDate,"mmmm dS")})},emptyDataSet(){return[[Object(D.q)(this.startDate,"isoDate"),0],[Object(D.q)(Date.now(),"isoDate"),0]]},isLoadingHistory(){return this.$apollo.queries.vulnerabilitiesHistory.loading}},methods:{setSelectedDayRange(e){this.selectedDayRange=e},processRawData(e){return(this.groupFullPath?e.group.vulnerabilitiesCountByDay:e.vulnerabilitiesCountByDay).nodes.reduce((function(e,t){return P.forEach((function(i){y()(e,`${i}.${t.date}`,t[i])})),e}),{})}}},F=Object(j.a)(A,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("security-dashboard-card",{attrs:{"is-loading":e.isLoadingHistory},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("\n    "+e._s(e.__("Vulnerabilities over time"))+"\n  ")]},proxy:!0},{key:"help-text",fn:function(){return[e._v("\n    "+e._s(e.dateInfo)+"\n  ")]},proxy:!0},{key:"controls",fn:function(){return[i("chart-buttons",{attrs:{days:e.$options.days,"active-day":e.selectedDayRange},on:{"days-selected":e.setSelectedDayRange}})]},proxy:!0}])},[e._v(" "),e._v(" "),e._v(" "),i("gl-table-lite",{staticClass:"js-vulnerabilities-chart-severity-level-breakdown gl-mb-3",attrs:{fields:e.$options.fields,items:e.charts},scopedSlots:e._u([{key:"head(changeInPercent)",fn:function(t){var n=t.label;return[i("span",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],attrs:{title:e.__("Difference between start date and now")}},[e._v(e._s(n))])]}},{key:"head(currentVulnerabilitiesCount)",fn:function(t){var n=t.label;return[i("span",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],attrs:{title:e.__("Current vulnerabilities count")}},[e._v(e._s(n))])]}},{key:"cell(severityLevel)",fn:function(e){var t=e.value;return[i("severity-badge",{ref:"severityBadge"+t,attrs:{severity:t}})]}},{key:"cell(chartData)",fn:function(t){var n=t.item;return[i("div",{staticClass:"gl-relative gl-p-5"},[i("gl-sparkline-chart",{ref:"sparklineChart"+n.severityLevel,staticClass:"gl-absolute gl-w-full gl-top-0 gl-left-0",attrs:{height:32,data:n.chartData,"tooltip-label":e.__("Vulnerabilities"),"show-last-y-value":!1}})],1)]}},{key:"cell(changeInPercent)",fn:function(t){var n=t.value;return[i("span",{ref:"changeInPercent"},[e._v(e._s(n))])]}},{key:"cell(currentVulnerabilitiesCount)",fn:function(t){var n=t.value;return[i("span",{ref:"currentVulnerabilitiesCount"},[e._v(e._s(n))])]}}])})],1)}),[],!1,null,null,null).exports,$=i("0a2z"),q=i.n($),B=(i("ylB9"),i("XexO"),i("h8Et"),i("u1ru")),M=i("H8gz"),G=i("Wrl+"),U=i("GRM5"),H={css:{severityGroups:{[G.l.F]:"gl-text-red-900",[G.l.D]:"gl-text-red-700",[G.l.C]:"gl-text-orange-600",[G.l.B]:"gl-text-orange-400",[G.l.A]:"gl-text-green-500"},severityLevels:{[G.m.CRITICAL]:"gl-text-red-900",[G.m.HIGH]:"gl-text-red-700",[G.m.UNKNOWN]:"gl-text-gray-300",[G.m.MEDIUM]:"gl-text-orange-600",[G.m.LOW]:"gl-text-orange-500",[G.m.NONE]:"gl-text-green-500"}},accordionItemsContentMaxHeight:"445px",components:{SecurityDashboardCard:V,Accordion:U.a,AccordionItem:U.b,GlLink:B.a,GlIcon:M.a},directives:{"gl-tooltip":S.a},inject:["groupFullPath"],props:{helpPagePath:{type:String,required:!1,default:""},query:{type:Object,required:!0}},data:()=>({vulnerabilityGrades:{},errorLoadingVulnerabilitiesGrades:!1}),apollo:{vulnerabilityGrades:{query(){return this.query},variables(){return{fullPath:this.groupFullPath}},update(e){const{vulnerabilityGrades:t}=this.groupFullPath?e.group:e.instanceSecurityDashboard;return q()(t,"grade")},error(){this.errorLoadingVulnerabilitiesGrades=!0}}},computed:{isLoadingGrades(){return this.$apollo.queries.vulnerabilityGrades.loading},severityGroups(){var e=this;return G.j.map((function(t){var i;return{...t,count:(null===(i=e.vulnerabilityGrades[t.type])||void 0===i?void 0:i.count)||0,projects:e.findProjectsForGroup(t)}}))}},methods:{findProjectsForGroup(e){var t=this;return this.vulnerabilityGrades[e.type]?this.vulnerabilityGrades[e.type].projects.nodes.map((function(i){return{...i,mostSevereVulnerability:t.findMostSevereVulnerabilityForGroup(i,e)}})):[]},findMostSevereVulnerabilityForGroup(e,t){const i={};return G.k.some((function(n){var a;if(!t.severityLevels.includes(n))return!1;const r=(null===(a=e.vulnerabilitySeveritiesCount)||void 0===a?void 0:a[n])>0;return r&&(i.level=n,i.count=e.vulnerabilitySeveritiesCount[n]),r})),i},shouldAccordionItemBeDisabled(e){let{projects:t}=e;return(null==t?void 0:t.length)<1},cssForSeverityGroup(e){let{type:t}=e;return this.$options.css.severityGroups[t]},cssForMostSevereVulnerability(e){let{level:t}=e;return this.$options.css.severityLevels[t]||[]},severityText:e=>G.n[e],getProjectCountString(e){let{count:t,projects:i}=e;return t>i.length?Object(h.h)(Object(h.g)("SecurityReports|%{count}+ projects"),{count:i.length}):Object(h.f)("%d project","%d projects",t)}}},z={components:{VulnerabilitiesOverTimeChart:F,VulnerabilitySeverities:Object(j.a)(H,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("security-dashboard-card",{attrs:{"is-loading":e.isLoadingGrades},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("\n    "+e._s(e.__("Project security status"))+"\n    "),e.helpPagePath?i("gl-link",{attrs:{href:e.helpPagePath,"aria-label":e.__("Project security status help page"),target:"_blank"}},[i("gl-icon",{attrs:{name:"question"}})],1):e._e()]},proxy:!0},e.isLoadingGrades?null:{key:"help-text",fn:function(){return[e._v("\n    "+e._s(e.__("Projects are graded based on the highest severity vulnerability present"))+"\n  ")]},proxy:!0}],null,!0)},[e._v(" "),e._v(" "),i("accordion",{staticClass:"gl-px-5 gl-display-flex gl-flex-grow-1 gl-border-t-1 gl-border-t-solid gl-border-t-gray-100",attrs:{"list-classes":["gl-display-flex","gl-flex-grow-1"]},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.accordionId;return e._l(e.severityGroups,(function(t){return i("accordion-item",{key:t.type,ref:"accordionItem"+t.type,refInFor:!0,staticClass:"gl-display-flex gl-flex-grow-1 gl-flex-direction-column gl-justify-content-center",attrs:{"data-qa-selector":"severity_accordion_item_"+t.type,"accordion-id":n,disabled:e.shouldAccordionItemBeDisabled(t),"max-height":e.$options.accordionItemsContentMaxHeight},scopedSlots:e._u([{key:"title",fn:function(n){var a=n.isExpanded,r=n.isDisabled;return[i("h5",{staticClass:"gl-display-flex gl-align-items-center gl-font-weight-normal gl-p-0 gl-m-0",attrs:{"data-testid":"vulnerability-severity-groups"}},[i("span",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"gl-font-weight-bold gl-mr-5 gl-font-lg",class:e.cssForSeverityGroup(t),attrs:{title:t.description}},[e._v("\n              "+e._s(t.type)+"\n            ")]),e._v(" "),i("span",{class:{"gl-font-weight-bold":a,"gl-text-gray-500":r}},[e._v("\n              "+e._s(e.getProjectCountString(t))+"\n            ")])])]}},{key:"sub-title",fn:function(){return[i("p",{staticClass:"gl-m-0 gl-ml-7 gl-pb-2 gl-text-gray-500"},[e._v(e._s(t.warning))])]},proxy:!0}],null,!0)},[e._v(" "),e._v(" "),i("div",{staticClass:"gl-ml-7 gl-pb-3"},[i("ul",{staticClass:"list-unstyled gl-py-2"},e._l(t.projects,(function(t){return i("li",{key:t.id,staticClass:"gl-py-3"},[i("gl-link",{attrs:{target:"_blank",href:t.securityDashboardPath,"data-qa-selector":"project_name_text"}},[e._v(e._s(t.nameWithNamespace))]),e._v(" "),t.mostSevereVulnerability?i("span",{ref:"mostSevereCount",refInFor:!0,staticClass:"gl-display-block text-lowercase",class:e.cssForMostSevereVulnerability(t.mostSevereVulnerability)},[e._v(e._s(t.mostSevereVulnerability.count)+"\n                "+e._s(e.severityText(t.mostSevereVulnerability.level))+"\n              ")]):e._e()],1)})),0)])])}))}}])})],1)}),[],!1,null,null,null).exports},props:{historyQuery:{type:Object,required:!0},gradesQuery:{type:Object,required:!0}},i18n:{title:Object(h.g)("SecurityReports|Security Dashboard")}},Q=Object(j.a)(z,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h2",{staticClass:"gl-mb-6"},[this._v(this._s(this.$options.i18n.title))]),this._v(" "),t("div",{staticClass:"security-charts gl-display-grid"},[t("vulnerabilities-over-time-chart",{attrs:{query:this.historyQuery}}),this._v(" "),t("vulnerability-severities",{attrs:{query:this.gradesQuery}})],1)])}),[],!1,null,null,null).exports,W=(i("WmlO"),i("W9Nl"),i("luhb")),J=i("EEVk"),Y=i.n(J),X=i("0PCB"),K=i("HDPV"),Z=i("0DmX");const ee=[{key:"critical",name:Object(h.g)("severity|Critical"),color:"#660e00"},{key:"high",name:Object(h.g)("severity|High"),color:"#ae1800"},{key:"medium",name:Object(h.g)("severity|Medium"),color:"#9e5400"},{key:"low",name:Object(h.g)("severity|Low"),color:"#c17d10"},{key:"unknown",name:Object(h.g)("severity|Unknown"),color:"#868686"},{key:"info",name:Object(h.g)("severity|Info"),color:"#428fdc"}];var te={components:{SecurityTrainingPromoBanner:X.a,GlLoadingIcon:I.a,GlLineChart:W.a},props:{projectFullPath:{type:String,required:!1,default:""}},apollo:{trendsByDay:{query:Y.a,variables(){return{fullPath:this.projectFullPath,endDate:this.endDate,startDate:this.startDate}},update(e){let{project:t}=e;return t.vulnerabilitiesCountByDay.nodes},error(){Object(O.createAlert)({message:K.a})}}},data:()=>({chartWidth:0,trendsByDay:[],svgs:{}}),computed:{chartStartDate:()=>Object(D.q)(Object(D.v)(new Date,30),"isoDate"),startDate:()=>Object(D.q)(Object(D.v)(new Date,100),"isoDate"),endDate:()=>Object(D.q)(new Date,"isoDate"),dataSeries(){const e=ee.map((function(e){let{key:t,name:i,color:n}=e;return{key:t,name:i,data:[],itemStyle:{color:n},lineStyle:{color:n}}}));return this.trendsByDay.forEach((function(t){const{date:i,...n}=t;ee.forEach((function(t){let{key:a}=t;e.find((function(e){return e.key===a})).data.push([i,n[a]])}))})),e},isLoadingTrends(){return this.$apollo.queries.trendsByDay.loading},chartOptions(){return{xAxis:{name:Object(h.a)("Time"),key:"time",type:"category"},yAxis:{name:Object(h.a)("Vulnerabilities"),key:"vulnerabilities",type:"value",minInterval:1},dataZoom:[{type:"slider",startValue:this.chartStartDate,handleIcon:this.svgs["scroll-handle"]}],toolbox:{feature:{dataZoom:{icon:{zoom:this.svgs["marquee-selection"],back:this.svgs.redo}},restore:{icon:this.svgs.repeat},saveAsImage:{icon:this.svgs.download}}}}}},created(){["marquee-selection","redo","repeat","download","scroll-handle"].forEach(this.setSvg)},methods:{async setSvg(e){try{this.$set(this.svgs,e,"path://"+await Object(Z.a)(e))}catch(e){console.error("SVG could not be rendered correctly: ",e)}}}},ie=Object(j.a)(te,(function(){var e=this.$createElement,t=this._self._c||e;return this.isLoadingTrends?t("gl-loading-icon",{staticClass:"gl-mt-6",attrs:{size:"lg"}}):t("div",[t("security-training-promo-banner"),this._v(" "),t("gl-line-chart",{staticClass:"gl-mt-6",attrs:{data:this.dataSeries,option:this.chartOptions,responsive:"","include-legend-avg-max":!1}})],1)}),[],!1,null,null,null).exports,ne=i("Pf0K"),ae=i("BKj5");t.a=function(e,t){if(!e)return null;if(e.dataset.isUnavailable)return new n.default({el:e,render:t=>t(ne.a,{props:{svgPath:e.dataset.emptyStateSvgPath}})});const{emptyStateSvgPath:i,groupFullPath:d,projectFullPath:u,securityConfigurationPath:v,securityDashboardEmptySvgPath:f,instanceDashboardSettingsPath:h}=e.dataset,b=Object(o.G)(e.dataset.hasProjects),y=Object(o.G)(e.dataset.hasVulnerabilities),k={emptyStateSvgPath:i,groupFullPath:d,projectFullPath:u,securityConfigurationPath:v,securityDashboardEmptySvgPath:f,instanceDashboardSettingsPath:h};let S,_;return t===l.a.GROUP?(_=b?Q:r.a,S={historyQuery:m.a,gradesQuery:c.a}):t===l.a.INSTANCE?(_=b?Q:s.a,S={historyQuery:g.a,gradesQuery:p.a}):t===l.a.PROJECT&&(_=y?ie:a.a,S={projectFullPath:u}),new n.default({el:e,name:"SecurityDashboardRoot",apolloProvider:ae.a,provide:k,render:e=>e(_,{props:S})})}},uOLK:function(e,t,i){"use strict";var n=i("q+nE"),a=i("CkNe"),r=i("QGxF"),s=i("BKj5"),l=i("8VXI"),o=i("UMdU");n.default.use(a.b),t.a=function(){const e=document.getElementById("js-security-report-app");return e?new n.default({el:e,apolloProvider:s.a,router:Object(l.a)(),store:new a.b.Store,provide:Object(o.a)(e.dataset),render:e=>e(r.a)}):null}},vnep:function(e,t){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"projectImages"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vulnerabilityImages"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:157}};i.loc.source={body:"query projectImages($projectPath: ID!) {\n  project(fullPath: $projectPath) {\n    id\n    vulnerabilityImages {\n      nodes {\n        name\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function a(e,t){for(var i=0;i<e.definitions.length;i++){var n=e.definitions[i];if(n.name&&n.name.value==t)return n}}i.definitions.forEach((function(e){if(e.name){var t=new Set;!function e(t,i){if("FragmentSpread"===t.kind)i.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&i.add(n.name.value)}t.selectionSet&&t.selectionSet.selections.forEach((function(t){e(t,i)})),t.variableDefinitions&&t.variableDefinitions.forEach((function(t){e(t,i)})),t.definitions&&t.definitions.forEach((function(t){e(t,i)}))}(e,t),n[e.name.value]=t}})),e.exports=i,e.exports.projectImages=function(e,t){var i={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var r=n[t]||new Set,s=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(n[e]||new Set).forEach((function(e){l.add(e)})))}))}return s.forEach((function(t){var n=a(e,t);n&&i.definitions.push(n)})),i}(i,"projectImages")},w6kD:function(e,t,i){"use strict";var n=i("29lL"),a=i.n(n),r=i("fxsL"),s=i.n(r),l=i("D/gg"),o=i.n(l),d=i("h7Xa"),c=i.n(d);t.a={revert:c.a,dismiss:s.a,confirm:a.a,resolve:o.a}},wYtT:function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return o})),i.d(t,"e",(function(){return d})),i.d(t,"d",(function(){return c}));var n=i("t9l/"),a=i("sEKB");const r={ALLOWED:"allowed",DENIED:"denied",UNCLASSIFIED:"unclassified"},s=r,l=r,o={ALLOW:"allow",DENY:"deny"},d=[{name:Object(n.g)("LicenseManagement|Denied"),description:Object(n.a)("Out-of-compliance with this project's policies and should be removed"),status:a.g},{name:Object(n.g)("LicenseManagement|Uncategorized"),description:Object(n.a)("No policy matches this license"),status:a.h},{name:Object(n.g)("LicenseManagement|Allowed"),description:Object(n.a)("Acceptable for use in this project"),status:a.i}],c="users_clicking_license_testing_visiting_external_website"},zDXb:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("oiT5");i("cRBX");const a={UNAUTHORIZED:n.o,FORBIDDEN:n.f}}}]);
//# sourceMappingURL=security_reports.c77aa351.chunk.js.map